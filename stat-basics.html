<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>31 R初等统计分析 | R语言教程</title>
  <meta name="description" content="李东风在北京大学数学科学学院开设本科生《统计软件》教材。采用R的bookdown制作，输出格式为bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="31 R初等统计分析 | R语言教程" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="李东风在北京大学数学科学学院开设本科生《统计软件》教材。采用R的bookdown制作，输出格式为bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="31 R初等统计分析 | R语言教程" />
  
  <meta name="twitter:description" content="李东风在北京大学数学科学学院开设本科生《统计软件》教材。采用R的bookdown制作，输出格式为bookdown::gitbook." />
  

<meta name="author" content="李东风" />


<meta name="date" content="2020-12-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ggplotvis.html"/>
<link rel="next" href="stat-reg.html"/>
<script src="static/js/jquery.min.js"></script>
<link href="static/css/style.css" rel="stylesheet" />
<link href="static/css/plugin-table.css" rel="stylesheet" />
<link href="static/css/plugin-bookdown.css" rel="stylesheet" />
<link href="static/css/plugin-highlight.css" rel="stylesheet" />
<link href="static/css/plugin-search.css" rel="stylesheet" />
<link href="static/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="static/css/plugin-clipboard.css" rel="stylesheet" />







<div style="display:none">
    <script src="http://s11.cnzz.com/z_stat.php?id=610720&web_id=610720" language="JavaScript"></script>
</div>




<script src="static/js/empty-anchor.js"></script>
<script src="static/js/htmlwidgets.js"></script>
<link href="static/css/str_view.css" rel="stylesheet" />
<script src="static/js/str_view.js"></script>
<link href="static/css/wordcloud.css" rel="stylesheet" />
<script src="static/js/wordcloud2-all.js"></script>
<script src="static/js/hover.js"></script>
<script src="static/js/wordcloud2.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  jax: ["input/TeX","output/SVG"],
  extensions: ["tex2jax.js","MathMenu.js","MathZoom.js"],
  TeX: {
    extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
  }
});
</script>
<script type="text/javascript"
   src="static/js/mathjax.js">
</script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="http://www.math.pku.edu.cn/teachers/lidf/docs/Rbook/html/_Rbook/index.html">R语言教程</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>前言</a></li>
<li class="part"><span><b>I 介绍</b></span></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> R语言介绍</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#intro-hist-char"><i class="fa fa-check"></i><b>1.1</b> R的历史和特点</a><ul>
<li class="chapter" data-level="1.1.1" data-path="intro.html"><a href="intro.html#intro-hc-hist"><i class="fa fa-check"></i><b>1.1.1</b> R的历史</a></li>
<li class="chapter" data-level="1.1.2" data-path="intro.html"><a href="intro.html#intro-hc-char"><i class="fa fa-check"></i><b>1.1.2</b> R的特点</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#intro-install"><i class="fa fa-check"></i><b>1.2</b> R的下载与安装</a><ul>
<li class="chapter" data-level="1.2.1" data-path="intro.html"><a href="intro.html#intro-ins-down"><i class="fa fa-check"></i><b>1.2.1</b> R的下载</a></li>
<li class="chapter" data-level="1.2.2" data-path="intro.html"><a href="intro.html#intro-ins-install"><i class="fa fa-check"></i><b>1.2.2</b> R软件安装</a></li>
<li class="chapter" data-level="1.2.3" data-path="intro.html"><a href="intro.html#intro-ins-other-soft"><i class="fa fa-check"></i><b>1.2.3</b> 辅助软件</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#intro-ins-packages"><i class="fa fa-check"></i><b>1.3</b> R扩展软件包的安装与管理</a><ul>
<li class="chapter" data-level="1.3.1" data-path="intro.html"><a href="intro.html#intro-ins-pack-ins"><i class="fa fa-check"></i><b>1.3.1</b> 安装</a></li>
<li class="chapter" data-level="1.3.2" data-path="intro.html"><a href="intro.html#intro-ins-pack-gitbioc"><i class="fa fa-check"></i><b>1.3.2</b> Github和BioConductor的扩展包</a></li>
<li class="chapter" data-level="1.3.3" data-path="intro.html"><a href="intro.html#intro-ins-pack-upd"><i class="fa fa-check"></i><b>1.3.3</b> 更新扩展包</a></li>
<li class="chapter" data-level="1.3.4" data-path="intro.html"><a href="intro.html#intro-ins-pack-verup"><i class="fa fa-check"></i><b>1.3.4</b> 迁移扩展包</a></li>
<li class="chapter" data-level="1.3.5" data-path="intro.html"><a href="intro.html#intro-ins-pack-renv"><i class="fa fa-check"></i><b>1.3.5</b> 项目私有扩展包目录</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#intro-ruse"><i class="fa fa-check"></i><b>1.4</b> 基本R软件的用法</a><ul>
<li class="chapter" data-level="1.4.1" data-path="intro.html"><a href="intro.html#intro-ruse-run"><i class="fa fa-check"></i><b>1.4.1</b> 基本运行</a></li>
<li class="chapter" data-level="1.4.2" data-path="intro.html"><a href="intro.html#intro-ruse-proj"><i class="fa fa-check"></i><b>1.4.2</b> 项目目录</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#intro-rstudio"><i class="fa fa-check"></i><b>1.5</b> RStudio软件</a><ul>
<li class="chapter" data-level="1.5.1" data-path="intro.html"><a href="intro.html#intro-rstudio-intro"><i class="fa fa-check"></i><b>1.5.1</b> 介绍</a></li>
<li class="chapter" data-level="1.5.2" data-path="intro.html"><a href="intro.html#intro-rstudio-proj"><i class="fa fa-check"></i><b>1.5.2</b> 项目</a></li>
<li class="chapter" data-level="1.5.3" data-path="intro.html"><a href="intro.html#intro-rstudio-help"><i class="fa fa-check"></i><b>1.5.3</b> 帮助</a></li>
<li class="chapter" data-level="1.5.4" data-path="intro.html"><a href="intro.html#intro-rstudio-shortcuts"><i class="fa fa-check"></i><b>1.5.4</b> 使用技巧</a></li>
<li class="chapter" data-level="1.5.5" data-path="intro.html"><a href="intro.html#intro-rstudio-rmd"><i class="fa fa-check"></i><b>1.5.5</b> Rmd文件</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#intro-ins-ex"><i class="fa fa-check"></i><b>1.6</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro-example.html"><a href="intro-example.html"><i class="fa fa-check"></i><b>2</b> R语言入门运行样例</a><ul>
<li class="chapter" data-level="2.1" data-path="intro-example.html"><a href="intro-example.html#i-e-command-line"><i class="fa fa-check"></i><b>2.1</b> 命令行界面</a></li>
<li class="chapter" data-level="2.2" data-path="intro-example.html"><a href="intro-example.html#i-e-arith-op"><i class="fa fa-check"></i><b>2.2</b> 四则运算</a><ul>
<li class="chapter" data-level="2.2.1" data-path="intro-example.html"><a href="intro-example.html#i-e-arith-op-poker"><i class="fa fa-check"></i><b>2.2.1</b> 计算例子</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro-example.html"><a href="intro-example.html#i-e-a-o-ex"><i class="fa fa-check"></i><b>2.2.2</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intro-example.html"><a href="intro-example.html#i-e-math-func"><i class="fa fa-check"></i><b>2.3</b> 数学函数</a><ul>
<li class="chapter" data-level="2.3.1" data-path="intro-example.html"><a href="intro-example.html#i-e-m-f-sqrt"><i class="fa fa-check"></i><b>2.3.1</b> 数学函数——平方根、指数、对数</a></li>
<li class="chapter" data-level="2.3.2" data-path="intro-example.html"><a href="intro-example.html#i-e-m-f-round"><i class="fa fa-check"></i><b>2.3.2</b> 数学函数——取整</a></li>
<li class="chapter" data-level="2.3.3" data-path="intro-example.html"><a href="intro-example.html#i-e-m-f-sin"><i class="fa fa-check"></i><b>2.3.3</b> 数学函数——三角函数</a></li>
<li class="chapter" data-level="2.3.4" data-path="intro-example.html"><a href="intro-example.html#i-e-m-f-asin"><i class="fa fa-check"></i><b>2.3.4</b> 数学函数——反三角函数</a></li>
<li class="chapter" data-level="2.3.5" data-path="intro-example.html"><a href="intro-example.html#i-e-m-f-dist"><i class="fa fa-check"></i><b>2.3.5</b> 分布函数和分位数函数</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro-example.html"><a href="intro-example.html#i-e-output"><i class="fa fa-check"></i><b>2.4</b> 输出</a><ul>
<li class="chapter" data-level="2.4.1" data-path="intro-example.html"><a href="intro-example.html#i-e-o-simple"><i class="fa fa-check"></i><b>2.4.1</b> 简单输出</a></li>
<li class="chapter" data-level="2.4.2" data-path="intro-example.html"><a href="intro-example.html#i-e-o-sink"><i class="fa fa-check"></i><b>2.4.2</b> 用<code>sink()</code>函数作运行记录</a></li>
<li class="chapter" data-level="2.4.3" data-path="intro-example.html"><a href="intro-example.html#i-e-o-ex"><i class="fa fa-check"></i><b>2.4.3</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="intro-example.html"><a href="intro-example.html#i-e-vector"><i class="fa fa-check"></i><b>2.5</b> 向量计算与变量赋值</a></li>
<li class="chapter" data-level="2.6" data-path="intro-example.html"><a href="intro-example.html#i-e-workspace"><i class="fa fa-check"></i><b>2.6</b> 工作空间介绍</a><ul>
<li class="chapter" data-level="2.6.1" data-path="intro-example.html"><a href="intro-example.html#i-e-w-ex"><i class="fa fa-check"></i><b>2.6.1</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="intro-example.html"><a href="intro-example.html#i-e-graph"><i class="fa fa-check"></i><b>2.7</b> 绘图示例</a><ul>
<li class="chapter" data-level="2.7.1" data-path="intro-example.html"><a href="intro-example.html#i-e-g-curve"><i class="fa fa-check"></i><b>2.7.1</b> 函数曲线示例</a></li>
<li class="chapter" data-level="2.7.2" data-path="intro-example.html"><a href="intro-example.html#i-e-g-barplot"><i class="fa fa-check"></i><b>2.7.2</b> 条形图示例</a></li>
<li class="chapter" data-level="2.7.3" data-path="intro-example.html"><a href="intro-example.html#i-e-g-scatter"><i class="fa fa-check"></i><b>2.7.3</b> 散点图示例</a></li>
<li class="chapter" data-level="2.7.4" data-path="intro-example.html"><a href="intro-example.html#i-e-g-demo"><i class="fa fa-check"></i><b>2.7.4</b> R软件自带的图形示例</a></li>
<li class="chapter" data-level="2.7.5" data-path="intro-example.html"><a href="intro-example.html#i-e-g-ex"><i class="fa fa-check"></i><b>2.7.5</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="intro-example.html"><a href="intro-example.html#i-e-summary"><i class="fa fa-check"></i><b>2.8</b> 汇总统计示例</a><ul>
<li class="chapter" data-level="2.8.1" data-path="intro-example.html"><a href="intro-example.html#i-e-s-table"><i class="fa fa-check"></i><b>2.8.1</b> 表格数据</a></li>
<li class="chapter" data-level="2.8.2" data-path="intro-example.html"><a href="intro-example.html#i-e-s-t-read-table"><i class="fa fa-check"></i><b>2.8.2</b> 读入表格数据</a></li>
<li class="chapter" data-level="2.8.3" data-path="intro-example.html"><a href="intro-example.html#i-e-s-ex"><i class="fa fa-check"></i><b>2.8.3</b> 练习</a></li>
<li class="chapter" data-level="2.8.4" data-path="intro-example.html"><a href="intro-example.html#i-e-s-qual-freq"><i class="fa fa-check"></i><b>2.8.4</b> 分类变量频数统计</a></li>
<li class="chapter" data-level="2.8.5" data-path="intro-example.html"><a href="intro-example.html#i-e-s-num-summ"><i class="fa fa-check"></i><b>2.8.5</b> 数值型变量的统计</a></li>
<li class="chapter" data-level="2.8.6" data-path="intro-example.html"><a href="intro-example.html#i-e-s-ex2"><i class="fa fa-check"></i><b>2.8.6</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="intro-example.html"><a href="intro-example.html#i-e-source"><i class="fa fa-check"></i><b>2.9</b> 运行源程序文件</a><ul>
<li class="chapter" data-level="2.9.1" data-path="intro-example.html"><a href="intro-example.html#i-e-source-enc"><i class="fa fa-check"></i><b>2.9.1</b> 源文件编码</a></li>
<li class="chapter" data-level="2.9.2" data-path="intro-example.html"><a href="intro-example.html#i-e-cwd"><i class="fa fa-check"></i><b>2.9.2</b> 当前工作目录</a></li>
<li class="chapter" data-level="2.9.3" data-path="intro-example.html"><a href="intro-example.html#i-e-source-ex"><i class="fa fa-check"></i><b>2.9.3</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="intro-example.html"><a href="intro-example.html#i-e-appendix-data"><i class="fa fa-check"></i><b>2.10</b> 附录：数据</a><ul>
<li class="chapter" data-level="2.10.1" data-path="intro-example.html"><a href="intro-example.html#i-e-appendix-data-tax"><i class="fa fa-check"></i><b>2.10.1</b> 公司纳税数据样例</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II 数据类型与相应的运算</b></span></li>
<li class="chapter" data-level="3" data-path="prog-type-intro.html"><a href="prog-type-intro.html"><i class="fa fa-check"></i><b>3</b> 常量与变量</a><ul>
<li class="chapter" data-level="3.1" data-path="prog-type-intro.html"><a href="prog-type-intro.html#p-t-const"><i class="fa fa-check"></i><b>3.1</b> 常量</a></li>
<li class="chapter" data-level="3.2" data-path="prog-type-intro.html"><a href="prog-type-intro.html#p-t-cv-var"><i class="fa fa-check"></i><b>3.2</b> 变量</a></li>
<li class="chapter" data-level="3.3" data-path="prog-type-intro.html"><a href="prog-type-intro.html#p-t-type"><i class="fa fa-check"></i><b>3.3</b> R数据类型</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="prog-type-num.html"><a href="prog-type-num.html"><i class="fa fa-check"></i><b>4</b> 数值型向量及其运算</a><ul>
<li class="chapter" data-level="4.1" data-path="prog-type-num.html"><a href="prog-type-num.html#p-t-num"><i class="fa fa-check"></i><b>4.1</b> 数值型向量</a></li>
<li class="chapter" data-level="4.2" data-path="prog-type-num.html"><a href="prog-type-num.html#p-t-arith"><i class="fa fa-check"></i><b>4.2</b> 向量运算</a><ul>
<li class="chapter" data-level="4.2.1" data-path="prog-type-num.html"><a href="prog-type-num.html#p-t-arith-scalar"><i class="fa fa-check"></i><b>4.2.1</b> 标量和标量运算</a></li>
<li class="chapter" data-level="4.2.2" data-path="prog-type-num.html"><a href="prog-type-num.html#p-t-arith-vec-with-scalar"><i class="fa fa-check"></i><b>4.2.2</b> 向量与标量运算</a></li>
<li class="chapter" data-level="4.2.3" data-path="prog-type-num.html"><a href="prog-type-num.html#p-t-arith-vec-eq-len"><i class="fa fa-check"></i><b>4.2.3</b> 等长向量运算</a></li>
<li class="chapter" data-level="4.2.4" data-path="prog-type-num.html"><a href="prog-type-num.html#p-t-arith-vec-uneq-len"><i class="fa fa-check"></i><b>4.2.4</b> 不等长向量的运算</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="prog-type-num.html"><a href="prog-type-num.html#p-t-vfunc"><i class="fa fa-check"></i><b>4.3</b> 向量函数</a><ul>
<li class="chapter" data-level="4.3.1" data-path="prog-type-num.html"><a href="prog-type-num.html#p-t-vfunc-vector-func"><i class="fa fa-check"></i><b>4.3.1</b> 向量化的函数</a></li>
<li class="chapter" data-level="4.3.2" data-path="prog-type-num.html"><a href="prog-type-num.html#p-t-vfunc-sort"><i class="fa fa-check"></i><b>4.3.2</b> 排序函数</a></li>
<li class="chapter" data-level="4.3.3" data-path="prog-type-num.html"><a href="prog-type-num.html#p-t-vfunc-stat"><i class="fa fa-check"></i><b>4.3.3</b> 统计函数</a></li>
<li class="chapter" data-level="4.3.4" data-path="prog-type-num.html"><a href="prog-type-num.html#p-t-vfunc-seq"><i class="fa fa-check"></i><b>4.3.4</b> 生成规则序列的函数</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="prog-type-num.html"><a href="prog-type-num.html#p-t-complex"><i class="fa fa-check"></i><b>4.4</b> 复数向量</a></li>
<li class="chapter" data-level="4.5" data-path="prog-type-num.html"><a href="prog-type-num.html#p-t-vfunc-ex"><i class="fa fa-check"></i><b>4.5</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="prog-type-logi.html"><a href="prog-type-logi.html"><i class="fa fa-check"></i><b>5</b> 逻辑型向量及其运算</a><ul>
<li class="chapter" data-level="5.1" data-path="prog-type-logi.html"><a href="prog-type-logi.html#p-t-logical-vec"><i class="fa fa-check"></i><b>5.1</b> 逻辑型向量与比较运算</a></li>
<li class="chapter" data-level="5.2" data-path="prog-type-logi.html"><a href="prog-type-logi.html#p-t-lvec-logic-op"><i class="fa fa-check"></i><b>5.2</b> 逻辑运算</a></li>
<li class="chapter" data-level="5.3" data-path="prog-type-logi.html"><a href="prog-type-logi.html#p-t-lvec-logic-op-vec"><i class="fa fa-check"></i><b>5.3</b> 逻辑运算函数</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="prog-type-char.html"><a href="prog-type-char.html"><i class="fa fa-check"></i><b>6</b> 字符型数据及其处理</a><ul>
<li class="chapter" data-level="6.1" data-path="prog-type-char.html"><a href="prog-type-char.html#p-t-char"><i class="fa fa-check"></i><b>6.1</b> 字符型向量</a></li>
<li class="chapter" data-level="6.2" data-path="prog-type-char.html"><a href="prog-type-char.html#p-t-char-paste"><i class="fa fa-check"></i><b>6.2</b> <code>paste()</code>函数</a></li>
<li class="chapter" data-level="6.3" data-path="prog-type-char.html"><a href="prog-type-char.html#p-t-char-toupper"><i class="fa fa-check"></i><b>6.3</b> 转换大小写</a></li>
<li class="chapter" data-level="6.4" data-path="prog-type-char.html"><a href="prog-type-char.html#p-t-char-nchar"><i class="fa fa-check"></i><b>6.4</b> 字符串长度</a></li>
<li class="chapter" data-level="6.5" data-path="prog-type-char.html"><a href="prog-type-char.html#p-t-char-substr"><i class="fa fa-check"></i><b>6.5</b> 取子串</a></li>
<li class="chapter" data-level="6.6" data-path="prog-type-char.html"><a href="prog-type-char.html#p-t-char-asnum"><i class="fa fa-check"></i><b>6.6</b> 类型转换</a></li>
<li class="chapter" data-level="6.7" data-path="prog-type-char.html"><a href="prog-type-char.html#p-t-char-strsplit"><i class="fa fa-check"></i><b>6.7</b> 字符串拆分</a></li>
<li class="chapter" data-level="6.8" data-path="prog-type-char.html"><a href="prog-type-char.html#p-t-char-gsub"><i class="fa fa-check"></i><b>6.8</b> 字符串替换功能</a></li>
<li class="chapter" data-level="6.9" data-path="prog-type-char.html"><a href="prog-type-char.html#p-t-char-regexp"><i class="fa fa-check"></i><b>6.9</b> 正则表达式</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="prog-type-index.html"><a href="prog-type-index.html"><i class="fa fa-check"></i><b>7</b> R向量下标和子集</a><ul>
<li class="chapter" data-level="7.1" data-path="prog-type-index.html"><a href="prog-type-index.html#p-t-subset-int"><i class="fa fa-check"></i><b>7.1</b> 正整数下标</a></li>
<li class="chapter" data-level="7.2" data-path="prog-type-index.html"><a href="prog-type-index.html#p-t-subset-negint"><i class="fa fa-check"></i><b>7.2</b> 负整数下标</a></li>
<li class="chapter" data-level="7.3" data-path="prog-type-index.html"><a href="prog-type-index.html#p-t-subset-all"><i class="fa fa-check"></i><b>7.3</b> 空下标与零下标</a></li>
<li class="chapter" data-level="7.4" data-path="prog-type-index.html"><a href="prog-type-index.html#p-t-subset-over"><i class="fa fa-check"></i><b>7.4</b> 下标超界</a></li>
<li class="chapter" data-level="7.5" data-path="prog-type-index.html"><a href="prog-type-index.html#p-t-subset-logic"><i class="fa fa-check"></i><b>7.5</b> 逻辑下标</a></li>
<li class="chapter" data-level="7.6" data-path="prog-type-index.html"><a href="prog-type-index.html#p-t-subset-which"><i class="fa fa-check"></i><b>7.6</b> <code>which()</code>、<code>which.min()</code>、<code>which.max()</code>函数</a></li>
<li class="chapter" data-level="7.7" data-path="prog-type-index.html"><a href="prog-type-index.html#p-t-subset-names"><i class="fa fa-check"></i><b>7.7</b> 元素名</a></li>
<li class="chapter" data-level="7.8" data-path="prog-type-index.html"><a href="prog-type-index.html#p-t-subset-mapping"><i class="fa fa-check"></i><b>7.8</b> 用R向量下标作映射</a></li>
<li class="chapter" data-level="7.9" data-path="prog-type-index.html"><a href="prog-type-index.html#p-t-subset-set"><i class="fa fa-check"></i><b>7.9</b> 集合运算</a></li>
<li class="chapter" data-level="7.10" data-path="prog-type-index.html"><a href="prog-type-index.html#p-t-set-ex"><i class="fa fa-check"></i><b>7.10</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="prog-type-attr.html"><a href="prog-type-attr.html"><i class="fa fa-check"></i><b>8</b> R数据类型的性质</a><ul>
<li class="chapter" data-level="8.1" data-path="prog-type-attr.html"><a href="prog-type-attr.html#p-t-modes-typeof"><i class="fa fa-check"></i><b>8.1</b> 存储模式与基本类型</a></li>
<li class="chapter" data-level="8.2" data-path="prog-type-attr.html"><a href="prog-type-attr.html#p-t-modes-as"><i class="fa fa-check"></i><b>8.2</b> 类型转换与类型升档</a></li>
<li class="chapter" data-level="8.3" data-path="prog-type-attr.html"><a href="prog-type-attr.html#p-t-modes-attr"><i class="fa fa-check"></i><b>8.3</b> 属性</a><ul>
<li class="chapter" data-level="8.3.1" data-path="prog-type-attr.html"><a href="prog-type-attr.html#p-t-modes-attr-asfun"><i class="fa fa-check"></i><b>8.3.1</b> <code>attributes</code>函数</a></li>
<li class="chapter" data-level="8.3.2" data-path="prog-type-attr.html"><a href="prog-type-attr.html#p-t-modes-attr-attrfun"><i class="fa fa-check"></i><b>8.3.2</b> <code>attr</code>函数</a></li>
<li class="chapter" data-level="8.3.3" data-path="prog-type-attr.html"><a href="prog-type-attr.html#p-t-modes-attr-names"><i class="fa fa-check"></i><b>8.3.3</b> <code>names</code>属性</a></li>
<li class="chapter" data-level="8.3.4" data-path="prog-type-attr.html"><a href="prog-type-attr.html#p-t-modes-attr-dim"><i class="fa fa-check"></i><b>8.3.4</b> <code>dim</code>属性</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="prog-type-attr.html"><a href="prog-type-attr.html#p-t-modes-class"><i class="fa fa-check"></i><b>8.4</b> 类属</a></li>
<li class="chapter" data-level="8.5" data-path="prog-type-attr.html"><a href="prog-type-attr.html#p-t-modes-str"><i class="fa fa-check"></i><b>8.5</b> <code>str()</code>函数</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="prog-type-date.html"><a href="prog-type-date.html"><i class="fa fa-check"></i><b>9</b> R日期时间</a><ul>
<li class="chapter" data-level="9.1" data-path="prog-type-date.html"><a href="prog-type-date.html#prog-type-dt-intro"><i class="fa fa-check"></i><b>9.1</b> R日期和日期时间类型</a></li>
<li class="chapter" data-level="9.2" data-path="prog-type-date.html"><a href="prog-type-date.html#prog-type-dt-fromchr"><i class="fa fa-check"></i><b>9.2</b> 从字符串生成日期数据</a></li>
<li class="chapter" data-level="9.3" data-path="prog-type-date.html"><a href="prog-type-date.html#p-t-date-format"><i class="fa fa-check"></i><b>9.3</b> 日期显示格式</a></li>
<li class="chapter" data-level="9.4" data-path="prog-type-date.html"><a href="prog-type-date.html#p-t-date-comp"><i class="fa fa-check"></i><b>9.4</b> 访问日期时间的组成值</a></li>
<li class="chapter" data-level="9.5" data-path="prog-type-date.html"><a href="prog-type-date.html#p-t-date-round"><i class="fa fa-check"></i><b>9.5</b> 日期舍入计算</a></li>
<li class="chapter" data-level="9.6" data-path="prog-type-date.html"><a href="prog-type-date.html#p-t-date-calc"><i class="fa fa-check"></i><b>9.6</b> 日期计算</a><ul>
<li class="chapter" data-level="9.6.1" data-path="prog-type-date.html"><a href="prog-type-date.html#p-t-date-calc-dur"><i class="fa fa-check"></i><b>9.6.1</b> 时间长度</a></li>
<li class="chapter" data-level="9.6.2" data-path="prog-type-date.html"><a href="prog-type-date.html#p-t-date-calc-per"><i class="fa fa-check"></i><b>9.6.2</b> 时间周期</a></li>
<li class="chapter" data-level="9.6.3" data-path="prog-type-date.html"><a href="prog-type-date.html#p-t-date-calc-int"><i class="fa fa-check"></i><b>9.6.3</b> 时间区间</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="prog-type-date.html"><a href="prog-type-date.html#prog-type-dt-baser"><i class="fa fa-check"></i><b>9.7</b> 基本R软件的日期功能</a><ul>
<li class="chapter" data-level="9.7.1" data-path="prog-type-date.html"><a href="prog-type-date.html#p-t-date-baser-gen"><i class="fa fa-check"></i><b>9.7.1</b> 生成日期和日期时间型数据</a></li>
<li class="chapter" data-level="9.7.2" data-path="prog-type-date.html"><a href="prog-type-date.html#p-t-date-baser-comp"><i class="fa fa-check"></i><b>9.7.2</b> 取出日期时间的组成值</a></li>
<li class="chapter" data-level="9.7.3" data-path="prog-type-date.html"><a href="prog-type-date.html#p-t-date-baser-calc"><i class="fa fa-check"></i><b>9.7.3</b> 日期计算</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="prog-type-date.html"><a href="prog-type-date.html#p-t-date-ex"><i class="fa fa-check"></i><b>9.8</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="prog-type-fact.html"><a href="prog-type-fact.html"><i class="fa fa-check"></i><b>10</b> R因子类型</a><ul>
<li class="chapter" data-level="10.1" data-path="prog-type-fact.html"><a href="prog-type-fact.html#p-t-fact"><i class="fa fa-check"></i><b>10.1</b> 因子</a></li>
<li class="chapter" data-level="10.2" data-path="prog-type-fact.html"><a href="prog-type-fact.html#p-t-factor-table"><i class="fa fa-check"></i><b>10.2</b> <code>table()</code>函数</a></li>
<li class="chapter" data-level="10.3" data-path="prog-type-fact.html"><a href="prog-type-fact.html#p-t-factor-tapply"><i class="fa fa-check"></i><b>10.3</b> <code>tapply()</code>函数</a></li>
<li class="chapter" data-level="10.4" data-path="prog-type-fact.html"><a href="prog-type-fact.html#summ-by-forcats"><i class="fa fa-check"></i><b>10.4</b> forcats包的因子函数</a></li>
<li class="chapter" data-level="10.5" data-path="prog-type-fact.html"><a href="prog-type-fact.html#p-t-factor-ex"><i class="fa fa-check"></i><b>10.5</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="prog-type-list.html"><a href="prog-type-list.html"><i class="fa fa-check"></i><b>11</b> 列表类型</a><ul>
<li class="chapter" data-level="11.1" data-path="prog-type-list.html"><a href="prog-type-list.html#p-t-list"><i class="fa fa-check"></i><b>11.1</b> 列表</a></li>
<li class="chapter" data-level="11.2" data-path="prog-type-list.html"><a href="prog-type-list.html#p-t-list-access"><i class="fa fa-check"></i><b>11.2</b> 列表元素访问</a></li>
<li class="chapter" data-level="11.3" data-path="prog-type-list.html"><a href="prog-type-list.html#p-t-list-as"><i class="fa fa-check"></i><b>11.3</b> 列表类型转换</a></li>
<li class="chapter" data-level="11.4" data-path="prog-type-list.html"><a href="prog-type-list.html#p-t-list-ex-strsplit"><i class="fa fa-check"></i><b>11.4</b> 返回列表的函数示例–<code>strsplit()</code></a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="prog-type-matrix.html"><a href="prog-type-matrix.html"><i class="fa fa-check"></i><b>12</b> R矩阵和数组</a><ul>
<li class="chapter" data-level="12.1" data-path="prog-type-matrix.html"><a href="prog-type-matrix.html#p-t-array-matrix"><i class="fa fa-check"></i><b>12.1</b> R矩阵</a></li>
<li class="chapter" data-level="12.2" data-path="prog-type-matrix.html"><a href="prog-type-matrix.html#p-t-array-subset"><i class="fa fa-check"></i><b>12.2</b> 矩阵子集</a></li>
<li class="chapter" data-level="12.3" data-path="prog-type-matrix.html"><a href="prog-type-matrix.html#p-t-array-cbind"><i class="fa fa-check"></i><b>12.3</b> <code>cbind()</code>和<code>rbind()</code>函数</a></li>
<li class="chapter" data-level="12.4" data-path="prog-type-matrix.html"><a href="prog-type-matrix.html#p-t-array-matop"><i class="fa fa-check"></i><b>12.4</b> 矩阵运算</a><ul>
<li class="chapter" data-level="12.4.1" data-path="prog-type-matrix.html"><a href="prog-type-matrix.html#p-t-array-matop-arith"><i class="fa fa-check"></i><b>12.4.1</b> 四则运算</a></li>
<li class="chapter" data-level="12.4.2" data-path="prog-type-matrix.html"><a href="prog-type-matrix.html#p-t-array-matop-mult"><i class="fa fa-check"></i><b>12.4.2</b> 矩阵乘法</a></li>
<li class="chapter" data-level="12.4.3" data-path="prog-type-matrix.html"><a href="prog-type-matrix.html#p-t-array-matop-vecmat"><i class="fa fa-check"></i><b>12.4.3</b> 向量与矩阵相乘</a></li>
<li class="chapter" data-level="12.4.4" data-path="prog-type-matrix.html"><a href="prog-type-matrix.html#p-t-array-matop-inprod"><i class="fa fa-check"></i><b>12.4.4</b> 内积</a></li>
<li class="chapter" data-level="12.4.5" data-path="prog-type-matrix.html"><a href="prog-type-matrix.html#p-t-array-matop-outer"><i class="fa fa-check"></i><b>12.4.5</b> 外积</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="prog-type-matrix.html"><a href="prog-type-matrix.html#p-t-array-solve"><i class="fa fa-check"></i><b>12.5</b> 逆矩阵与线性方程组求解</a></li>
<li class="chapter" data-level="12.6" data-path="prog-type-matrix.html"><a href="prog-type-matrix.html#p-t-array-apply"><i class="fa fa-check"></i><b>12.6</b> <code>apply()</code>函数</a></li>
<li class="chapter" data-level="12.7" data-path="prog-type-matrix.html"><a href="prog-type-matrix.html#p-t-array-array"><i class="fa fa-check"></i><b>12.7</b> 多维数组</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="prog-type-df.html"><a href="prog-type-df.html"><i class="fa fa-check"></i><b>13</b> 数据框</a><ul>
<li class="chapter" data-level="13.1" data-path="prog-type-df.html"><a href="prog-type-df.html#p-t-dataframe"><i class="fa fa-check"></i><b>13.1</b> 数据框</a></li>
<li class="chapter" data-level="13.2" data-path="prog-type-df.html"><a href="prog-type-df.html#p-t-df-access"><i class="fa fa-check"></i><b>13.2</b> 数据框内容访问</a></li>
<li class="chapter" data-level="13.3" data-path="prog-type-df.html"><a href="prog-type-df.html#p-t-df-rownames"><i class="fa fa-check"></i><b>13.3</b> 数据框的行名</a></li>
<li class="chapter" data-level="13.4" data-path="prog-type-df.html"><a href="prog-type-df.html#p-t-df-notmatrix"><i class="fa fa-check"></i><b>13.4</b> 数据框与矩阵的区别</a></li>
<li class="chapter" data-level="13.5" data-path="prog-type-df.html"><a href="prog-type-df.html#p-t-df-gl-func"><i class="fa fa-check"></i><b>13.5</b> <code>tidyr::expand_grid()</code>函数</a></li>
<li class="chapter" data-level="13.6" data-path="prog-type-df.html"><a href="prog-type-df.html#p-t-tibble"><i class="fa fa-check"></i><b>13.6</b> <code>tibble</code>类型</a></li>
<li class="chapter" data-level="13.7" data-path="prog-type-df.html"><a href="prog-type-df.html#p-t-df-ex"><i class="fa fa-check"></i><b>13.7</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="prog-type-ws.html"><a href="prog-type-ws.html"><i class="fa fa-check"></i><b>14</b> 工作空间和变量赋值</a><ul>
<li class="chapter" data-level="14.1" data-path="prog-type-ws.html"><a href="prog-type-ws.html#p-t-ws"><i class="fa fa-check"></i><b>14.1</b> 工作空间</a></li>
<li class="chapter" data-level="14.2" data-path="prog-type-ws.html"><a href="prog-type-ws.html#p-t-nlvname"><i class="fa fa-check"></i><b>14.2</b> 非法变量名</a></li>
<li class="chapter" data-level="14.3" data-path="prog-type-ws.html"><a href="prog-type-ws.html#p-t-ws-asign"><i class="fa fa-check"></i><b>14.3</b> 变量赋值与绑定</a></li>
<li class="chapter" data-level="14.4" data-path="prog-type-ws.html"><a href="prog-type-ws.html#p-t-ws-env"><i class="fa fa-check"></i><b>14.4</b> 环境</a></li>
</ul></li>
<li class="part"><span><b>III 编程</b></span></li>
<li class="chapter" data-level="15" data-path="prog-io.html"><a href="prog-io.html"><i class="fa fa-check"></i><b>15</b> R输入输出</a><ul>
<li class="chapter" data-level="15.1" data-path="prog-io.html"><a href="prog-io.html#p-io-simple"><i class="fa fa-check"></i><b>15.1</b> 输入输出的简单方法</a><ul>
<li class="chapter" data-level="15.1.1" data-path="prog-io.html"><a href="prog-io.html#p-io-simple-out"><i class="fa fa-check"></i><b>15.1.1</b> 简单的输出</a></li>
<li class="chapter" data-level="15.1.2" data-path="prog-io.html"><a href="prog-io.html#p-io-simple-input"><i class="fa fa-check"></i><b>15.1.2</b> 简单的输入</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="prog-io.html"><a href="prog-io.html#p-io-read-csv"><i class="fa fa-check"></i><b>15.2</b> 读取CSV文件</a><ul>
<li class="chapter" data-level="15.2.1" data-path="prog-io.html"><a href="prog-io.html#p-io-read-csv-format"><i class="fa fa-check"></i><b>15.2.1</b> CSV格式</a></li>
<li class="chapter" data-level="15.2.2" data-path="prog-io.html"><a href="prog-io.html#p-io-read-csv-fromstr"><i class="fa fa-check"></i><b>15.2.2</b> 从字符串读入</a></li>
<li class="chapter" data-level="15.2.3" data-path="prog-io.html"><a href="prog-io.html#p-io-read-csv-opt"><i class="fa fa-check"></i><b>15.2.3</b> <code>read_csv</code>选项</a></li>
<li class="chapter" data-level="15.2.4" data-path="prog-io.html"><a href="prog-io.html#p-io-read-csv-enc"><i class="fa fa-check"></i><b>15.2.4</b> 编码设置</a></li>
<li class="chapter" data-level="15.2.5" data-path="prog-io.html"><a href="prog-io.html#p-io-read-csv-na"><i class="fa fa-check"></i><b>15.2.5</b> 缺失值设置</a></li>
<li class="chapter" data-level="15.2.6" data-path="prog-io.html"><a href="prog-io.html#p-io-read-csv-colt"><i class="fa fa-check"></i><b>15.2.6</b> 各列类型设置</a></li>
<li class="chapter" data-level="15.2.7" data-path="prog-io.html"><a href="prog-io.html#p-io-read-csv-fact"><i class="fa fa-check"></i><b>15.2.7</b> 因子类型设置</a></li>
<li class="chapter" data-level="15.2.8" data-path="prog-io.html"><a href="prog-io.html#p-io-read-csv-date"><i class="fa fa-check"></i><b>15.2.8</b> 读入日期</a></li>
<li class="chapter" data-level="15.2.9" data-path="prog-io.html"><a href="prog-io.html#p-io-read-csv-funcs"><i class="fa fa-check"></i><b>15.2.9</b> 其它函数</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="prog-io.html"><a href="prog-io.html#p-io-excel"><i class="fa fa-check"></i><b>15.3</b> Excel表访问</a><ul>
<li class="chapter" data-level="15.3.1" data-path="prog-io.html"><a href="prog-io.html#p-io-excel-csv"><i class="fa fa-check"></i><b>15.3.1</b> 借助于文本格式</a></li>
<li class="chapter" data-level="15.3.2" data-path="prog-io.html"><a href="prog-io.html#p-io-excel-clip"><i class="fa fa-check"></i><b>15.3.2</b> 使用剪贴板</a></li>
<li class="chapter" data-level="15.3.3" data-path="prog-io.html"><a href="prog-io.html#p-io-excel-readxl"><i class="fa fa-check"></i><b>15.3.3</b> 利用readxl扩展包</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="prog-io.html"><a href="prog-io.html#p-io-file"><i class="fa fa-check"></i><b>15.4</b> 文件访问</a><ul>
<li class="chapter" data-level="15.4.1" data-path="prog-io.html"><a href="prog-io.html#p-io-file-conn"><i class="fa fa-check"></i><b>15.4.1</b> 连接</a></li>
<li class="chapter" data-level="15.4.2" data-path="prog-io.html"><a href="prog-io.html#p-io-file-text"><i class="fa fa-check"></i><b>15.4.2</b> 文本文件访问</a></li>
<li class="chapter" data-level="15.4.3" data-path="prog-io.html"><a href="prog-io.html#p-io-enc-batch"><i class="fa fa-check"></i><b>15.4.3</b> 文本文件分批读写</a></li>
<li class="chapter" data-level="15.4.4" data-path="prog-io.html"><a href="prog-io.html#p-io-file-bin"><i class="fa fa-check"></i><b>15.4.4</b> 二进制文件访问</a></li>
<li class="chapter" data-level="15.4.5" data-path="prog-io.html"><a href="prog-io.html#p-io-file-textcon"><i class="fa fa-check"></i><b>15.4.5</b> 字符型连接</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="prog-io.html"><a href="prog-io.html#p-io-enc"><i class="fa fa-check"></i><b>15.5</b> 中文编码问题</a><ul>
<li class="chapter" data-level="15.5.1" data-path="prog-io.html"><a href="prog-io.html#p-io-enc-base"><i class="fa fa-check"></i><b>15.5.1</b> 用基本R的读取函数读取</a></li>
<li class="chapter" data-level="15.5.2" data-path="prog-io.html"><a href="prog-io.html#p-io-enc-readr"><i class="fa fa-check"></i><b>15.5.2</b> 用readr包读取</a></li>
<li class="chapter" data-level="15.5.3" data-path="prog-io.html"><a href="prog-io.html#p-io-enc-write"><i class="fa fa-check"></i><b>15.5.3</b> 输出文件的编码</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="prog-io.html"><a href="prog-io.html#p-io-dir"><i class="fa fa-check"></i><b>15.6</b> 目录和文件管理</a></li>
<li class="chapter" data-level="15.7" data-path="prog-io.html"><a href="prog-io.html#p-io-db"><i class="fa fa-check"></i><b>15.7</b> SQL数据库访问</a><ul>
<li class="chapter" data-level="15.7.1" data-path="prog-io.html"><a href="prog-io.html#p-io-db-intro"><i class="fa fa-check"></i><b>15.7.1</b> 介绍</a></li>
<li class="chapter" data-level="15.7.2" data-path="prog-io.html"><a href="prog-io.html#p-io-db-sqlite"><i class="fa fa-check"></i><b>15.7.2</b> SQLite数据库访问</a></li>
<li class="chapter" data-level="15.7.3" data-path="prog-io.html"><a href="prog-io.html#p-io-db-sql"><i class="fa fa-check"></i><b>15.7.3</b> SQL命令简介</a></li>
<li class="chapter" data-level="15.7.4" data-path="prog-io.html"><a href="prog-io.html#p-io-db-oracle"><i class="fa fa-check"></i><b>15.7.4</b> 访问Oracle数据库</a></li>
<li class="chapter" data-level="15.7.5" data-path="prog-io.html"><a href="prog-io.html#p-io-db-mysql"><i class="fa fa-check"></i><b>15.7.5</b> MySQL数据库访问</a></li>
<li class="chapter" data-level="15.7.6" data-path="prog-io.html"><a href="prog-io.html#p-io-excel-rodbc"><i class="fa fa-check"></i><b>15.7.6</b> 利用RODBC访问Access数据库</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="prog-control.html"><a href="prog-control.html"><i class="fa fa-check"></i><b>16</b> 程序控制结构</a><ul>
<li class="chapter" data-level="16.1" data-path="prog-control.html"><a href="prog-control.html#p-con-exp"><i class="fa fa-check"></i><b>16.1</b> 表达式</a></li>
<li class="chapter" data-level="16.2" data-path="prog-control.html"><a href="prog-control.html#p-con-if"><i class="fa fa-check"></i><b>16.2</b> 分支结构</a><ul>
<li class="chapter" data-level="16.2.1" data-path="prog-control.html"><a href="prog-control.html#p-con-logic-index"><i class="fa fa-check"></i><b>16.2.1</b> 用逻辑下标代替分支结构</a></li>
<li class="chapter" data-level="16.2.2" data-path="prog-control.html"><a href="prog-control.html#p-con-ifelsef"><i class="fa fa-check"></i><b>16.2.2</b> <code>ifelse</code>函数</a></li>
<li class="chapter" data-level="16.2.3" data-path="prog-control.html"><a href="prog-control.html#p-con-switch"><i class="fa fa-check"></i><b>16.2.3</b> <code>switch</code>函数</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="prog-control.html"><a href="prog-control.html#p-con-loop"><i class="fa fa-check"></i><b>16.3</b> 循环结构</a><ul>
<li class="chapter" data-level="16.3.1" data-path="prog-control.html"><a href="prog-control.html#p-con-for"><i class="fa fa-check"></i><b>16.3.1</b> 计数循环</a></li>
<li class="chapter" data-level="16.3.2" data-path="prog-control.html"><a href="prog-control.html#p-con-while"><i class="fa fa-check"></i><b>16.3.2</b> <code>while</code>循环和<code>repeat</code>循环</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="prog-control.html"><a href="prog-control.html#p-con-cond"><i class="fa fa-check"></i><b>16.4</b> R中判断条件</a></li>
<li class="chapter" data-level="16.5" data-path="prog-control.html"><a href="prog-control.html#p-pipe"><i class="fa fa-check"></i><b>16.5</b> 管道控制</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="prog-func.html"><a href="prog-func.html"><i class="fa fa-check"></i><b>17</b> 函数</a><ul>
<li class="chapter" data-level="17.1" data-path="prog-func.html"><a href="prog-func.html#p-func"><i class="fa fa-check"></i><b>17.1</b> 函数基础</a><ul>
<li class="chapter" data-level="17.1.1" data-path="prog-func.html"><a href="prog-func.html#p-func-intro"><i class="fa fa-check"></i><b>17.1.1</b> 介绍</a></li>
<li class="chapter" data-level="17.1.2" data-path="prog-func.html"><a href="prog-func.html#p-func-def"><i class="fa fa-check"></i><b>17.1.2</b> 函数定义</a></li>
<li class="chapter" data-level="17.1.3" data-path="prog-func.html"><a href="prog-func.html#p-func-call"><i class="fa fa-check"></i><b>17.1.3</b> 函数调用</a></li>
<li class="chapter" data-level="17.1.4" data-path="prog-func.html"><a href="prog-func.html#p-func-recursive"><i class="fa fa-check"></i><b>17.1.4</b> 递归调用</a></li>
<li class="chapter" data-level="17.1.5" data-path="prog-func.html"><a href="prog-func.html#p-func-vr"><i class="fa fa-check"></i><b>17.1.5</b> 向量化</a></li>
<li class="chapter" data-level="17.1.6" data-path="prog-func.html"><a href="prog-func.html#p-func-anonymf"><i class="fa fa-check"></i><b>17.1.6</b> 无名函数</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="prog-func.html"><a href="prog-func.html#p-func-space"><i class="fa fa-check"></i><b>17.2</b> 变量作用域</a><ul>
<li class="chapter" data-level="17.2.1" data-path="prog-func.html"><a href="prog-func.html#p-func-global"><i class="fa fa-check"></i><b>17.2.1</b> 全局变量和工作空间</a></li>
<li class="chapter" data-level="17.2.2" data-path="prog-func.html"><a href="prog-func.html#p-func-local"><i class="fa fa-check"></i><b>17.2.2</b> 局部变量</a></li>
<li class="chapter" data-level="17.2.3" data-path="prog-func.html"><a href="prog-func.html#p-func-global-access"><i class="fa fa-check"></i><b>17.2.3</b> 在函数内访问全局变量</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="prog-prof.html"><a href="prog-prof.html"><i class="fa fa-check"></i><b>18</b> R程序效率</a><ul>
<li class="chapter" data-level="18.1" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-effic"><i class="fa fa-check"></i><b>18.1</b> R的运行效率</a></li>
<li class="chapter" data-level="18.2" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-vect"><i class="fa fa-check"></i><b>18.2</b> 向量化编程</a><ul>
<li class="chapter" data-level="18.2.1" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-vect-ex1"><i class="fa fa-check"></i><b>18.2.1</b> 示例1</a></li>
<li class="chapter" data-level="18.2.2" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-vect-ex2"><i class="fa fa-check"></i><b>18.2.2</b> 示例2</a></li>
<li class="chapter" data-level="18.2.3" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-vect-ex3"><i class="fa fa-check"></i><b>18.2.3</b> 示例3</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-loop"><i class="fa fa-check"></i><b>18.3</b> 减少显式循环</a><ul>
<li class="chapter" data-level="18.3.1" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-replicate"><i class="fa fa-check"></i><b>18.3.1</b> <code>replicate()</code>函数</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-copy"><i class="fa fa-check"></i><b>18.4</b> 避免制作副本</a></li>
<li class="chapter" data-level="18.5" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-mathfun"><i class="fa fa-check"></i><b>18.5</b> R的计算函数</a><ul>
<li class="chapter" data-level="18.5.1" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-mathfun-math"><i class="fa fa-check"></i><b>18.5.1</b> 数学函数</a></li>
<li class="chapter" data-level="18.5.2" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-mathfun-sum"><i class="fa fa-check"></i><b>18.5.2</b> 概括函数</a></li>
<li class="chapter" data-level="18.5.3" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-mathfun-max"><i class="fa fa-check"></i><b>18.5.3</b> 最值</a></li>
<li class="chapter" data-level="18.5.4" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-mathfun-sort"><i class="fa fa-check"></i><b>18.5.4</b> 排序</a></li>
<li class="chapter" data-level="18.5.5" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-mathfun-integrate"><i class="fa fa-check"></i><b>18.5.5</b> 一元定积分<code>integrate</code></a></li>
<li class="chapter" data-level="18.5.6" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-mathfun-uniroot"><i class="fa fa-check"></i><b>18.5.6</b> 一元函数求根<code>uniroot</code></a></li>
<li class="chapter" data-level="18.5.7" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-mathfun-fft"><i class="fa fa-check"></i><b>18.5.7</b> 离散傅立叶变换<code>fft</code></a></li>
<li class="chapter" data-level="18.5.8" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-mathfun-filter"><i class="fa fa-check"></i><b>18.5.8</b> 用<code>filter</code>函数作迭代</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-mcpu"><i class="fa fa-check"></i><b>18.6</b> 并行计算</a><ul>
<li class="chapter" data-level="18.6.1" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-mcpu-ex1"><i class="fa fa-check"></i><b>18.6.1</b> 例1：完全不互相依赖的并行运算</a></li>
<li class="chapter" data-level="18.6.2" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-mcpu-ex2"><i class="fa fa-check"></i><b>18.6.2</b> 例2：使用相同随机数序列的并行计算</a></li>
<li class="chapter" data-level="18.6.3" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-mcpu-ex3"><i class="fa fa-check"></i><b>18.6.3</b> 例3：使用独立随机数序列的并行计算</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="p-advfunc.html"><a href="p-advfunc.html"><i class="fa fa-check"></i><b>19</b> 函数进阶</a><ul>
<li class="chapter" data-level="19.1" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-callspe"><i class="fa fa-check"></i><b>19.1</b> 函数调用的各种形式</a></li>
<li class="chapter" data-level="19.2" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-lex"><i class="fa fa-check"></i><b>19.2</b> 嵌套定义与句法作用域(lexical scoping)</a></li>
<li class="chapter" data-level="19.3" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-inner"><i class="fa fa-check"></i><b>19.3</b> 辅助嵌套函数</a></li>
<li class="chapter" data-level="19.4" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-lazy"><i class="fa fa-check"></i><b>19.4</b> 懒惰求值</a></li>
<li class="chapter" data-level="19.5" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-debug"><i class="fa fa-check"></i><b>19.5</b> 程序调试</a><ul>
<li class="chapter" data-level="19.5.1" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-debug-intro"><i class="fa fa-check"></i><b>19.5.1</b> 基本调试策略</a></li>
<li class="chapter" data-level="19.5.2" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-debug-findfunc"><i class="fa fa-check"></i><b>19.5.2</b> 找到出错的函数</a></li>
<li class="chapter" data-level="19.5.3" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-debug-browser"><i class="fa fa-check"></i><b>19.5.3</b> 跟踪调试</a></li>
<li class="chapter" data-level="19.5.4" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-debug-cond"><i class="fa fa-check"></i><b>19.5.4</b> 条件断点</a></li>
<li class="chapter" data-level="19.5.5" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-debug-debugf"><i class="fa fa-check"></i><b>19.5.5</b> 开启对一个函数的调试</a></li>
<li class="chapter" data-level="19.5.6" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-debug-opt"><i class="fa fa-check"></i><b>19.5.6</b> 出错调试选项</a></li>
<li class="chapter" data-level="19.5.7" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-debug-stop"><i class="fa fa-check"></i><b>19.5.7</b> <code>stop()</code>、<code>warning()</code>、<code>message()</code></a></li>
<li class="chapter" data-level="19.5.8" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-debug-preventive"><i class="fa fa-check"></i><b>19.5.8</b> 预防性设计</a></li>
<li class="chapter" data-level="19.5.9" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-debug-try"><i class="fa fa-check"></i><b>19.5.9</b> 出错处理机制</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-funcprog"><i class="fa fa-check"></i><b>19.6</b> 函数式编程介绍</a><ul>
<li class="chapter" data-level="19.6.1" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-pure"><i class="fa fa-check"></i><b>19.6.1</b> 纯函数</a></li>
<li class="chapter" data-level="19.6.2" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-rec"><i class="fa fa-check"></i><b>19.6.2</b> 副作用和运行环境恢复</a></li>
<li class="chapter" data-level="19.6.3" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-rsupp"><i class="fa fa-check"></i><b>19.6.3</b> R的函数式编程功能</a></li>
</ul></li>
<li class="chapter" data-level="19.7" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-functional"><i class="fa fa-check"></i><b>19.7</b> 泛函</a><ul>
<li class="chapter" data-level="19.7.1" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-fnctnl-map"><i class="fa fa-check"></i><b>19.7.1</b> <code>purrr::map</code>函数</a></li>
<li class="chapter" data-level="19.7.2" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-fnctnl-mapv"><i class="fa fa-check"></i><b>19.7.2</b> purrr包中<code>map</code>函数的变种</a></li>
<li class="chapter" data-level="19.7.3" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-fnctnl-reduce"><i class="fa fa-check"></i><b>19.7.3</b> purrr包中<code>reduce</code>类函数</a></li>
<li class="chapter" data-level="19.7.4" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-fnctnl-pred"><i class="fa fa-check"></i><b>19.7.4</b> purrr包中使用示性函数的泛函</a></li>
<li class="chapter" data-level="19.7.5" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-fnctnl-lapp"><i class="fa fa-check"></i><b>19.7.5</b> 基本R的函数式编程支持</a></li>
<li class="chapter" data-level="19.7.6" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-fnctnl-udef"><i class="fa fa-check"></i><b>19.7.6</b> 自定义泛函</a></li>
</ul></li>
<li class="chapter" data-level="19.8" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-factory"><i class="fa fa-check"></i><b>19.8</b> 函数工厂</a><ul>
<li class="chapter" data-level="19.8.1" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-factory-clex"><i class="fa fa-check"></i><b>19.8.1</b> 闭包例子</a></li>
<li class="chapter" data-level="19.8.2" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-factory-lazy"><i class="fa fa-check"></i><b>19.8.2</b> 动态查找和懒惰求值引起的问题</a></li>
<li class="chapter" data-level="19.8.3" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-factory-mem"><i class="fa fa-check"></i><b>19.8.3</b> 函数工厂的内存负担</a></li>
<li class="chapter" data-level="19.8.4" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-operator"><i class="fa fa-check"></i><b>19.8.4</b> 函数算子</a></li>
</ul></li>
<li class="chapter" data-level="19.9" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-env"><i class="fa fa-check"></i><b>19.9</b> 环境</a><ul>
<li class="chapter" data-level="19.9.1" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-env-def"><i class="fa fa-check"></i><b>19.9.1</b> 基本概念</a></li>
<li class="chapter" data-level="19.9.2" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-env-recurs"><i class="fa fa-check"></i><b>19.9.2</b> 逐层向上访问环境</a></li>
<li class="chapter" data-level="19.9.3" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-env-spec"><i class="fa fa-check"></i><b>19.9.3</b> 特殊环境</a></li>
<li class="chapter" data-level="19.9.4" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-env-callst"><i class="fa fa-check"></i><b>19.9.4</b> 调用栈</a></li>
<li class="chapter" data-level="19.9.5" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-env-usedt"><i class="fa fa-check"></i><b>19.9.5</b> 将环境用作一般数据结构</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV 制作研究报告和图书</b></span></li>
<li class="chapter" data-level="20" data-path="knitr.html"><a href="knitr.html"><i class="fa fa-check"></i><b>20</b> 用R制作研究报告</a></li>
<li class="chapter" data-level="21" data-path="markdown.html"><a href="markdown.html"><i class="fa fa-check"></i><b>21</b> Markdown格式</a><ul>
<li class="chapter" data-level="21.1" data-path="markdown.html"><a href="markdown.html#markdown-intro"><i class="fa fa-check"></i><b>21.1</b> 介绍</a></li>
<li class="chapter" data-level="21.2" data-path="markdown.html"><a href="markdown.html#markdown-app"><i class="fa fa-check"></i><b>21.2</b> Markdown格式文件的应用</a></li>
<li class="chapter" data-level="21.3" data-path="markdown.html"><a href="markdown.html#markdown-format"><i class="fa fa-check"></i><b>21.3</b> markdown格式说明</a><ul>
<li class="chapter" data-level="21.3.1" data-path="markdown.html"><a href="markdown.html#markdown-format-intro"><i class="fa fa-check"></i><b>21.3.1</b> 概述</a></li>
<li class="chapter" data-level="21.3.2" data-path="markdown.html"><a href="markdown.html#markdown-format-paragraph"><i class="fa fa-check"></i><b>21.3.2</b> 段落</a></li>
<li class="chapter" data-level="21.3.3" data-path="markdown.html"><a href="markdown.html#markdown-format-inline"><i class="fa fa-check"></i><b>21.3.3</b> 段内文字格式</a></li>
<li class="chapter" data-level="21.3.4" data-path="markdown.html"><a href="markdown.html#markdown-format-header"><i class="fa fa-check"></i><b>21.3.4</b> 标题和分隔线</a></li>
<li class="chapter" data-level="21.3.5" data-path="markdown.html"><a href="markdown.html#markdown-format-cite"><i class="fa fa-check"></i><b>21.3.5</b> 引用段落</a></li>
<li class="chapter" data-level="21.3.6" data-path="markdown.html"><a href="markdown.html#markdown-format-list"><i class="fa fa-check"></i><b>21.3.6</b> 列表</a></li>
<li class="chapter" data-level="21.3.7" data-path="markdown.html"><a href="markdown.html#markdown-format-code"><i class="fa fa-check"></i><b>21.3.7</b> 源程序</a></li>
<li class="chapter" data-level="21.3.8" data-path="markdown.html"><a href="markdown.html#markdown-format-link"><i class="fa fa-check"></i><b>21.3.8</b> 链接</a></li>
<li class="chapter" data-level="21.3.9" data-path="markdown.html"><a href="markdown.html#markdown-format-fig"><i class="fa fa-check"></i><b>21.3.9</b> 插入图形</a></li>
<li class="chapter" data-level="21.3.10" data-path="markdown.html"><a href="markdown.html#markdown-format-table"><i class="fa fa-check"></i><b>21.3.10</b> 表格</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="markdown.html"><a href="markdown.html#markdown-pandoc"><i class="fa fa-check"></i><b>21.4</b> 附录：pandoc软件介绍</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="rmarkdown.html"><a href="rmarkdown.html"><i class="fa fa-check"></i><b>22</b> R Markdown文件格式</a><ul>
<li class="chapter" data-level="22.1" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-intro"><i class="fa fa-check"></i><b>22.1</b> R Markdown文件</a></li>
<li class="chapter" data-level="22.2" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-compile"><i class="fa fa-check"></i><b>22.2</b> R Markdown文件的编译</a><ul>
<li class="chapter" data-level="22.2.1" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-compile-proc"><i class="fa fa-check"></i><b>22.2.1</b> 编译的实际过程</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-rcode"><i class="fa fa-check"></i><b>22.3</b> 在R Markdown文件中插入R代码</a></li>
<li class="chapter" data-level="22.4" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-kable"><i class="fa fa-check"></i><b>22.4</b> 输出表格</a></li>
<li class="chapter" data-level="22.5" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-graph"><i class="fa fa-check"></i><b>22.5</b> 利用R程序插图</a></li>
<li class="chapter" data-level="22.6" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-rcode-opt"><i class="fa fa-check"></i><b>22.6</b> 代码段选项</a><ul>
<li class="chapter" data-level="22.6.1" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-rcode-outformat"><i class="fa fa-check"></i><b>22.6.1</b> 代码和文本输出结果格式</a></li>
<li class="chapter" data-level="22.6.2" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-rcode-figopt"><i class="fa fa-check"></i><b>22.6.2</b> 图形选项</a></li>
<li class="chapter" data-level="22.6.3" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-rcode-cache"><i class="fa fa-check"></i><b>22.6.3</b> 缓存(cache)选项</a></li>
</ul></li>
<li class="chapter" data-level="22.7" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd--sectionlink"><i class="fa fa-check"></i><b>22.7</b> 章节目录链接问题</a></li>
<li class="chapter" data-level="22.8" data-path="rmarkdown.html"><a href="rmarkdown.html#markdown-formula"><i class="fa fa-check"></i><b>22.8</b> 数学公式</a><ul>
<li class="chapter" data-level="22.8.1" data-path="rmarkdown.html"><a href="rmarkdown.html#markdown-formula-intro"><i class="fa fa-check"></i><b>22.8.1</b> 在Markdown中输入数学公式</a></li>
<li class="chapter" data-level="22.8.2" data-path="rmarkdown.html"><a href="rmarkdown.html#markdown-formula-type"><i class="fa fa-check"></i><b>22.8.2</b> 数学公式类别</a></li>
<li class="chapter" data-level="22.8.3" data-path="rmarkdown.html"><a href="rmarkdown.html#markdown-formula-basic"><i class="fa fa-check"></i><b>22.8.3</b> 基本功能</a></li>
<li class="chapter" data-level="22.8.4" data-path="rmarkdown.html"><a href="rmarkdown.html#markdown-formula-accent"><i class="fa fa-check"></i><b>22.8.4</b> 修饰符</a></li>
<li class="chapter" data-level="22.8.5" data-path="rmarkdown.html"><a href="rmarkdown.html#markdown-formula-align"><i class="fa fa-check"></i><b>22.8.5</b> 对齐与矩阵</a></li>
<li class="chapter" data-level="22.8.6" data-path="rmarkdown.html"><a href="rmarkdown.html#markdown-formula-fonts"><i class="fa fa-check"></i><b>22.8.6</b> 特殊字体</a></li>
</ul></li>
<li class="chapter" data-level="22.9" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-engines"><i class="fa fa-check"></i><b>22.9</b> 其它编程语言引擎</a></li>
<li class="chapter" data-level="22.10" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-interact"><i class="fa fa-check"></i><b>22.10</b> 交互内容</a></li>
<li class="chapter" data-level="22.11" data-path="rmarkdown.html"><a href="rmarkdown.html#rmarkdown-attryaml"><i class="fa fa-check"></i><b>22.11</b> 属性设置</a><ul>
<li class="chapter" data-level="22.11.1" data-path="rmarkdown.html"><a href="rmarkdown.html#rmarkdown-yaml"><i class="fa fa-check"></i><b>22.11.1</b> YAML元数据</a></li>
<li class="chapter" data-level="22.11.2" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-output-types"><i class="fa fa-check"></i><b>22.11.2</b> 输出格式</a></li>
<li class="chapter" data-level="22.11.3" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-output-attr"><i class="fa fa-check"></i><b>22.11.3</b> 输出格式设置</a></li>
<li class="chapter" data-level="22.11.4" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-output-attr-toc"><i class="fa fa-check"></i><b>22.11.4</b> 目录设置</a></li>
<li class="chapter" data-level="22.11.5" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-output-attr-numsec"><i class="fa fa-check"></i><b>22.11.5</b> 章节自动编号</a></li>
<li class="chapter" data-level="22.11.6" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-output-attr-wordnumsec"><i class="fa fa-check"></i><b>22.11.6</b> Word输出章节自动编号及模板功能</a></li>
<li class="chapter" data-level="22.11.7" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-output-htmlspecific"><i class="fa fa-check"></i><b>22.11.7</b> HTML特有输出格式设置</a></li>
<li class="chapter" data-level="22.11.8" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-mathjax"><i class="fa fa-check"></i><b>22.11.8</b> 关于数学公式支持的设置</a></li>
<li class="chapter" data-level="22.11.9" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-output-yml"><i class="fa fa-check"></i><b>22.11.9</b> 输出设置文件</a></li>
</ul></li>
<li class="chapter" data-level="22.12" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-latex"><i class="fa fa-check"></i><b>22.12</b> LaTeX和PDF输出</a><ul>
<li class="chapter" data-level="22.12.1" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-latex-tinytex"><i class="fa fa-check"></i><b>22.12.1</b> TinyTex的安装使用</a></li>
<li class="chapter" data-level="22.12.2" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-latex-yaml"><i class="fa fa-check"></i><b>22.12.2</b> Rmd中Latex设置</a></li>
</ul></li>
<li class="chapter" data-level="22.13" data-path="rmarkdown.html"><a href="rmarkdown.html#rmarkdown-rticles"><i class="fa fa-check"></i><b>22.13</b> 生成期刊文章</a></li>
<li class="chapter" data-level="22.14" data-path="rmarkdown.html"><a href="rmarkdown.html#rmarkdown-app1"><i class="fa fa-check"></i><b>22.14</b> 附录：经验与问题</a><ul>
<li class="chapter" data-level="22.14.1" data-path="rmarkdown.html"><a href="rmarkdown.html#rmarkdown-app1-wordtemplate"><i class="fa fa-check"></i><b>22.14.1</b> Word模板制作</a></li>
<li class="chapter" data-level="22.14.2" data-path="rmarkdown.html"><a href="rmarkdown.html#rmarkdown-app1-math"><i class="fa fa-check"></i><b>22.14.2</b> 数学公式设置补充</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="bookdown.html"><a href="bookdown.html"><i class="fa fa-check"></i><b>23</b> 用bookdown制作图书</a><ul>
<li class="chapter" data-level="23.1" data-path="bookdown.html"><a href="bookdown.html#bookdown-intro"><i class="fa fa-check"></i><b>23.1</b> 介绍</a></li>
<li class="chapter" data-level="23.2" data-path="bookdown.html"><a href="bookdown.html#bookdown-settings"><i class="fa fa-check"></i><b>23.2</b> 一本书的设置</a></li>
<li class="chapter" data-level="23.3" data-path="bookdown.html"><a href="bookdown.html#bookdown-sectioning"><i class="fa fa-check"></i><b>23.3</b> 章节结构</a></li>
<li class="chapter" data-level="23.4" data-path="bookdown.html"><a href="bookdown.html#bookdown-compile"><i class="fa fa-check"></i><b>23.4</b> 书的编译</a></li>
<li class="chapter" data-level="23.5" data-path="bookdown.html"><a href="bookdown.html#bookdown-cref"><i class="fa fa-check"></i><b>23.5</b> 交叉引用</a></li>
<li class="chapter" data-level="23.6" data-path="bookdown.html"><a href="bookdown.html#bookdown-formula"><i class="fa fa-check"></i><b>23.6</b> 数学公式和公式编号</a></li>
<li class="chapter" data-level="23.7" data-path="bookdown.html"><a href="bookdown.html#bookdown-theorem"><i class="fa fa-check"></i><b>23.7</b> 定理类编号</a></li>
<li class="chapter" data-level="23.8" data-path="bookdown.html"><a href="bookdown.html#bookdown-bib"><i class="fa fa-check"></i><b>23.8</b> 文献引用</a></li>
<li class="chapter" data-level="23.9" data-path="bookdown.html"><a href="bookdown.html#bookdown-graph"><i class="fa fa-check"></i><b>23.9</b> 插图</a></li>
<li class="chapter" data-level="23.10" data-path="bookdown.html"><a href="bookdown.html#bookdown-table"><i class="fa fa-check"></i><b>23.10</b> 表格</a><ul>
<li class="chapter" data-level="23.10.1" data-path="bookdown.html"><a href="bookdown.html#bookdown-table-md"><i class="fa fa-check"></i><b>23.10.1</b> Markdown表格</a></li>
<li class="chapter" data-level="23.10.2" data-path="bookdown.html"><a href="bookdown.html#bookdown-table-kable"><i class="fa fa-check"></i><b>23.10.2</b> 用<code>kable()</code>函数制作表格</a></li>
<li class="chapter" data-level="23.10.3" data-path="bookdown.html"><a href="bookdown.html#bookdown-table-kable"><i class="fa fa-check"></i><b>23.10.3</b> R中其它制作表格的包</a></li>
</ul></li>
<li class="chapter" data-level="23.11" data-path="bookdown.html"><a href="bookdown.html#bookdown-mathjax"><i class="fa fa-check"></i><b>23.11</b> 数学公式的设置</a></li>
<li class="chapter" data-level="23.12" data-path="bookdown.html"><a href="bookdown.html#bookdown-exp"><i class="fa fa-check"></i><b>23.12</b> 使用经验</a></li>
<li class="chapter" data-level="23.13" data-path="bookdown.html"><a href="bookdown.html#bookdown-bugs"><i class="fa fa-check"></i><b>23.13</b> bookdown的一些使用问题</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="rmdsite.html"><a href="rmdsite.html"><i class="fa fa-check"></i><b>24</b> 用R Markdown制作简易网站</a><ul>
<li class="chapter" data-level="24.1" data-path="rmdsite.html"><a href="rmdsite.html#rmdsite-intro"><i class="fa fa-check"></i><b>24.1</b> 介绍</a></li>
<li class="chapter" data-level="24.2" data-path="rmdsite.html"><a href="rmdsite.html#rmdsite-rmarkdown"><i class="fa fa-check"></i><b>24.2</b> 简易网站制作</a><ul>
<li class="chapter" data-level="24.2.1" data-path="rmdsite.html"><a href="rmdsite.html#rmdsite-rmarkdown-struct"><i class="fa fa-check"></i><b>24.2.1</b> 网站结构</a></li>
<li class="chapter" data-level="24.2.2" data-path="rmdsite.html"><a href="rmdsite.html#rmdsite-rmarkdown-build"><i class="fa fa-check"></i><b>24.2.2</b> 编译</a></li>
<li class="chapter" data-level="24.2.3" data-path="rmdsite.html"><a href="rmdsite.html#rmdsite-rmarkdown-pages"><i class="fa fa-check"></i><b>24.2.3</b> 内容文件</a></li>
<li class="chapter" data-level="24.2.4" data-path="rmdsite.html"><a href="rmdsite.html#rmdsite-rmarkdown-config"><i class="fa fa-check"></i><b>24.2.4</b> 网站设置</a></li>
</ul></li>
<li class="chapter" data-level="24.3" data-path="rmdsite.html"><a href="rmdsite.html#blogdown"><i class="fa fa-check"></i><b>24.3</b> 用blogdown制作网站</a><ul>
<li class="chapter" data-level="24.3.1" data-path="rmdsite.html"><a href="rmdsite.html#blogd-new"><i class="fa fa-check"></i><b>24.3.1</b> 生成新网站的框架</a></li>
<li class="chapter" data-level="24.3.2" data-path="rmdsite.html"><a href="rmdsite.html#blogd-page"><i class="fa fa-check"></i><b>24.3.2</b> 网页内容文件及其设置</a></li>
<li class="chapter" data-level="24.3.3" data-path="rmdsite.html"><a href="rmdsite.html#blogd-workflow"><i class="fa fa-check"></i><b>24.3.3</b> 初学者的工作流程</a></li>
<li class="chapter" data-level="24.3.4" data-path="rmdsite.html"><a href="rmdsite.html#blogd-config"><i class="fa fa-check"></i><b>24.3.4</b> 网站设置文件</a></li>
<li class="chapter" data-level="24.3.5" data-path="rmdsite.html"><a href="rmdsite.html#blogd-static"><i class="fa fa-check"></i><b>24.3.5</b> 静态文件</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="25" data-path="slides.html"><a href="slides.html"><i class="fa fa-check"></i><b>25</b> 制作幻灯片</a><ul>
<li class="chapter" data-level="25.1" data-path="slides.html"><a href="slides.html#rmd-slides-intro"><i class="fa fa-check"></i><b>25.1</b> 介绍</a></li>
<li class="chapter" data-level="25.2" data-path="slides.html"><a href="slides.html#rmd-slidy"><i class="fa fa-check"></i><b>25.2</b> Slidy幻灯片</a><ul>
<li class="chapter" data-level="25.2.1" data-path="slides.html"><a href="slides.html#rmd-slidy-format"><i class="fa fa-check"></i><b>25.2.1</b> 文件格式</a></li>
<li class="chapter" data-level="25.2.2" data-path="slides.html"><a href="slides.html#rmd-slidy-compile"><i class="fa fa-check"></i><b>25.2.2</b> 幻灯片编译</a></li>
<li class="chapter" data-level="25.2.3" data-path="slides.html"><a href="slides.html#rmd-slidy-play"><i class="fa fa-check"></i><b>25.2.3</b> 播放控制</a></li>
<li class="chapter" data-level="25.2.4" data-path="slides.html"><a href="slides.html#rmd-slidy-handout"><i class="fa fa-check"></i><b>25.2.4</b> 生成单页HTML</a></li>
<li class="chapter" data-level="25.2.5" data-path="slides.html"><a href="slides.html#rmd-slidy-mathjax"><i class="fa fa-check"></i><b>25.2.5</b> 数学公式处理与输出设置文件</a></li>
<li class="chapter" data-level="25.2.6" data-path="slides.html"><a href="slides.html#rmd-slidy-options"><i class="fa fa-check"></i><b>25.2.6</b> 其它选项</a></li>
<li class="chapter" data-level="25.2.7" data-path="slides.html"><a href="slides.html#rmd-slidy-laser"><i class="fa fa-check"></i><b>25.2.7</b> slidy幻灯片激光笔失效问题的修改</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="slides.html"><a href="slides.html#rmdslides-pp"><i class="fa fa-check"></i><b>25.3</b> MS PowerPoint幻灯片</a></li>
<li class="chapter" data-level="25.4" data-path="slides.html"><a href="slides.html#rmdslides-beamer"><i class="fa fa-check"></i><b>25.4</b> Bearmer幻灯片格式</a></li>
<li class="chapter" data-level="25.5" data-path="slides.html"><a href="slides.html#rmdslides-rpres"><i class="fa fa-check"></i><b>25.5</b> R Presentation格式</a></li>
</ul></li>
<li class="part"><span><b>V 数据整理与汇总</b></span></li>
<li class="chapter" data-level="26" data-path="summary-manip.html"><a href="summary-manip.html"><i class="fa fa-check"></i><b>26</b> 数据整理</a><ul>
<li class="chapter" data-level="26.1" data-path="summary-manip.html"><a href="summary-manip.html#summm-tidyv"><i class="fa fa-check"></i><b>26.1</b> tidyverse系统</a></li>
<li class="chapter" data-level="26.2" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-filter"><i class="fa fa-check"></i><b>26.2</b> 用<code>filter()</code>选择行子集</a></li>
<li class="chapter" data-level="26.3" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-head"><i class="fa fa-check"></i><b>26.3</b> 按行序号选择行子集</a></li>
<li class="chapter" data-level="26.4" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-samplen"><i class="fa fa-check"></i><b>26.4</b> 用<code>sample_n()</code>对观测随机抽样</a></li>
<li class="chapter" data-level="26.5" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-distinct"><i class="fa fa-check"></i><b>26.5</b> 用<code>distinct()</code>去除重复行</a></li>
<li class="chapter" data-level="26.6" data-path="summary-manip.html"><a href="summary-manip.html#tidyr-dropna"><i class="fa fa-check"></i><b>26.6</b> 用<code>drop_na()</code>去除指定的变量有缺失值的行</a></li>
<li class="chapter" data-level="26.7" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-select"><i class="fa fa-check"></i><b>26.7</b> 用<code>select()</code>选择列子集</a></li>
<li class="chapter" data-level="26.8" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-pull"><i class="fa fa-check"></i><b>26.8</b> 取出单个变量为向量</a></li>
<li class="chapter" data-level="26.9" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-arrange"><i class="fa fa-check"></i><b>26.9</b> 用<code>arrange()</code>排序</a></li>
<li class="chapter" data-level="26.10" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-rename"><i class="fa fa-check"></i><b>26.10</b> 用<code>rename()</code>修改变量名</a></li>
<li class="chapter" data-level="26.11" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-mutate"><i class="fa fa-check"></i><b>26.11</b> 用<code>mutate()</code>计算新变量</a></li>
<li class="chapter" data-level="26.12" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-transmute"><i class="fa fa-check"></i><b>26.12</b> 用<code>tranmute()</code>生成新变量的数据框</a></li>
<li class="chapter" data-level="26.13" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-pipe"><i class="fa fa-check"></i><b>26.13</b> 用管道连接多次操作</a></li>
<li class="chapter" data-level="26.14" data-path="summary-manip.html"><a href="summary-manip.html#tidyr-longer"><i class="fa fa-check"></i><b>26.14</b> 宽表转换为长表</a><ul>
<li class="chapter" data-level="26.14.1" data-path="summary-manip.html"><a href="summary-manip.html#tidyr-longer-pl"><i class="fa fa-check"></i><b>26.14.1</b> <code>pivot_longer</code>函数</a></li>
<li class="chapter" data-level="26.14.2" data-path="summary-manip.html"><a href="summary-manip.html#tidyr-longer-prefixvalue"><i class="fa fa-check"></i><b>26.14.2</b> 从列名中提取数值</a></li>
<li class="chapter" data-level="26.14.3" data-path="summary-manip.html"><a href="summary-manip.html#tidyr-longer-colnamemultclassv"><i class="fa fa-check"></i><b>26.14.3</b> 从列名中提取多个分类变量值</a></li>
<li class="chapter" data-level="26.14.4" data-path="summary-manip.html"><a href="summary-manip.html#tidyr-longer-multvarsmultclassv"><i class="fa fa-check"></i><b>26.14.4</b> 一行中有多个属性的多次观测的情形</a></li>
</ul></li>
<li class="chapter" data-level="26.15" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-wider"><i class="fa fa-check"></i><b>26.15</b> 长表转换为宽表</a><ul>
<li class="chapter" data-level="26.15.1" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-wider-sepvars"><i class="fa fa-check"></i><b>26.15.1</b> 将多个混在一起的变量拆开</a></li>
<li class="chapter" data-level="26.15.2" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-wider-combtimes"><i class="fa fa-check"></i><b>26.15.2</b> 将多个类别合并到一个观测</a></li>
<li class="chapter" data-level="26.15.3" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-wider-combcross"><i class="fa fa-check"></i><b>26.15.3</b> 将交叉类别合并到一个观测</a></li>
<li class="chapter" data-level="26.15.4" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-wider-mvmest"><i class="fa fa-check"></i><b>26.15.4</b> 多个变量的多种值</a></li>
<li class="chapter" data-level="26.15.5" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-wider-mixed"><i class="fa fa-check"></i><b>26.15.5</b> 长宽转换混合使用</a></li>
</ul></li>
<li class="chapter" data-level="26.16" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-spearate"><i class="fa fa-check"></i><b>26.16</b> 拆分数据列</a></li>
<li class="chapter" data-level="26.17" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-unite"><i class="fa fa-check"></i><b>26.17</b> 合并数据列</a></li>
<li class="chapter" data-level="26.18" data-path="summary-manip.html"><a href="summary-manip.html#summ-trans-combv"><i class="fa fa-check"></i><b>26.18</b> 数据框纵向合并</a></li>
<li class="chapter" data-level="26.19" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-join"><i class="fa fa-check"></i><b>26.19</b> 横向合并</a></li>
<li class="chapter" data-level="26.20" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-semi"><i class="fa fa-check"></i><b>26.20</b> 利用第二个数据集筛选</a></li>
<li class="chapter" data-level="26.21" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-set"><i class="fa fa-check"></i><b>26.21</b> 数据集的集合操作</a></li>
<li class="chapter" data-level="26.22" data-path="summary-manip.html"><a href="summary-manip.html#summ-trans-standard"><i class="fa fa-check"></i><b>26.22</b> 标准化</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="summary-summ.html"><a href="summary-summ.html"><i class="fa fa-check"></i><b>27</b> 数据汇总</a><ul>
<li class="chapter" data-level="27.1" data-path="summary-summ.html"><a href="summary-summ.html#dplyr-summ"><i class="fa fa-check"></i><b>27.1</b> 用dplyr作数据汇总</a></li>
<li class="chapter" data-level="27.2" data-path="summary-summ.html"><a href="summary-summ.html#dplyr-summat"><i class="fa fa-check"></i><b>27.2</b> 多个变量的汇总</a></li>
<li class="chapter" data-level="27.3" data-path="summary-summ.html"><a href="summary-summ.html#dplyr-groupby"><i class="fa fa-check"></i><b>27.3</b> 用dplyr作数据分组汇总</a></li>
<li class="chapter" data-level="27.4" data-path="summary-summ.html"><a href="summary-summ.html#dplyr-crossgroup"><i class="fa fa-check"></i><b>27.4</b> 交叉分类的汇总</a></li>
<li class="chapter" data-level="27.5" data-path="summary-summ.html"><a href="summary-summ.html#summ-nest"><i class="fa fa-check"></i><b>27.5</b> tibble中的列表列</a><ul>
<li class="chapter" data-level="27.5.1" data-path="summary-summ.html"><a href="summary-summ.html#summ-nest-intro"><i class="fa fa-check"></i><b>27.5.1</b> <code>nest</code>和<code>unnest</code></a></li>
<li class="chapter" data-level="27.5.2" data-path="summary-summ.html"><a href="summary-summ.html#summ-nest-groupby"><i class="fa fa-check"></i><b>27.5.2</b> <code>group_by</code>与<code>nest</code>配合</a></li>
<li class="chapter" data-level="27.5.3" data-path="summary-summ.html"><a href="summary-summ.html#summ-nest-summarise"><i class="fa fa-check"></i><b>27.5.3</b> <code>summarise</code>统计量用列表表示</a></li>
<li class="chapter" data-level="27.5.4" data-path="summary-summ.html"><a href="summary-summ.html#summ-nest-unnest-grammar"><i class="fa fa-check"></i><b>27.5.4</b> <code>unnest</code>的语法格式</a></li>
<li class="chapter" data-level="27.5.5" data-path="summary-summ.html"><a href="summary-summ.html#summ-nest-direct"><i class="fa fa-check"></i><b>27.5.5</b> 直接生成列表类型的列</a></li>
</ul></li>
<li class="chapter" data-level="27.6" data-path="summary-summ.html"><a href="summary-summ.html#summ-base"><i class="fa fa-check"></i><b>27.6</b> 基本R的汇总功能</a><ul>
<li class="chapter" data-level="27.6.1" data-path="summary-summ.html"><a href="summary-summ.html#summ-base-summary"><i class="fa fa-check"></i><b>27.6.1</b> <code>summary()</code>函数</a></li>
<li class="chapter" data-level="27.6.2" data-path="summary-summ.html"><a href="summary-summ.html#summ-cont"><i class="fa fa-check"></i><b>27.6.2</b> 连续型变量概括函数</a></li>
<li class="chapter" data-level="27.6.3" data-path="summary-summ.html"><a href="summary-summ.html#summ-fact"><i class="fa fa-check"></i><b>27.6.3</b> 分类变量概括</a></li>
<li class="chapter" data-level="27.6.4" data-path="summary-summ.html"><a href="summary-summ.html#summ-df"><i class="fa fa-check"></i><b>27.6.4</b> 数据框概括</a></li>
</ul></li>
<li class="chapter" data-level="27.7" data-path="summary-summ.html"><a href="summary-summ.html#summ-by"><i class="fa fa-check"></i><b>27.7</b> 用基本R作分类概括</a><ul>
<li class="chapter" data-level="27.7.1" data-path="summary-summ.html"><a href="summary-summ.html#summ-by-tapply"><i class="fa fa-check"></i><b>27.7.1</b> 用<code>tapply()</code>分组概括向量</a></li>
<li class="chapter" data-level="27.7.2" data-path="summary-summ.html"><a href="summary-summ.html#summ-by-aggregate"><i class="fa fa-check"></i><b>27.7.2</b> 用<code>aggregate()</code>分组概括数据框</a></li>
<li class="chapter" data-level="27.7.3" data-path="summary-summ.html"><a href="summary-summ.html#summ-by-split"><i class="fa fa-check"></i><b>27.7.3</b> 用<code>split()</code>函数分组后概括</a></li>
</ul></li>
<li class="chapter" data-level="27.8" data-path="summary-summ.html"><a href="summary-summ.html#summ-by-plyr"><i class="fa fa-check"></i><b>27.8</b> 用plyr包进行分类概括</a></li>
<li class="chapter" data-level="27.9" data-path="summary-summ.html"><a href="summary-summ.html#summ-by-exer"><i class="fa fa-check"></i><b>27.9</b> 练习</a></li>
</ul></li>
<li class="part"><span><b>VI 绘图</b></span></li>
<li class="chapter" data-level="28" data-path="graph.html"><a href="graph.html"><i class="fa fa-check"></i><b>28</b> 基本R绘图</a><ul>
<li class="chapter" data-level="28.1" data-path="graph.html"><a href="graph.html#graph-ph"><i class="fa fa-check"></i><b>28.1</b> 常用高级图形</a><ul>
<li class="chapter" data-level="28.1.1" data-path="graph.html"><a href="graph.html#graph-ph-barplot"><i class="fa fa-check"></i><b>28.1.1</b> 条形图</a></li>
<li class="chapter" data-level="28.1.2" data-path="graph.html"><a href="graph.html#graph-ph-hist"><i class="fa fa-check"></i><b>28.1.2</b> 直方图和密度估计图</a></li>
<li class="chapter" data-level="28.1.3" data-path="graph.html"><a href="graph.html#graph-ph-boxplot"><i class="fa fa-check"></i><b>28.1.3</b> 盒形图</a></li>
<li class="chapter" data-level="28.1.4" data-path="graph.html"><a href="graph.html#graph-pr-qq"><i class="fa fa-check"></i><b>28.1.4</b> 正态QQ图</a></li>
<li class="chapter" data-level="28.1.5" data-path="graph.html"><a href="graph.html#graph-ph-plot"><i class="fa fa-check"></i><b>28.1.5</b> 散点图</a></li>
<li class="chapter" data-level="28.1.6" data-path="graph.html"><a href="graph.html#graph-ph-curve"><i class="fa fa-check"></i><b>28.1.6</b> 曲线图</a></li>
<li class="chapter" data-level="28.1.7" data-path="graph.html"><a href="graph.html#graph-ph-3d"><i class="fa fa-check"></i><b>28.1.7</b> 三维图</a></li>
<li class="chapter" data-level="28.1.8" data-path="graph.html"><a href="graph.html#graph-ph-rgl"><i class="fa fa-check"></i><b>28.1.8</b> 动态三维图</a></li>
</ul></li>
<li class="chapter" data-level="28.2" data-path="graph.html"><a href="graph.html#graph-pl"><i class="fa fa-check"></i><b>28.2</b> 低级图形函数</a><ul>
<li class="chapter" data-level="28.2.1" data-path="graph.html"><a href="graph.html#graph-pl-abline"><i class="fa fa-check"></i><b>28.2.1</b> <code>abline()</code></a></li>
<li class="chapter" data-level="28.2.2" data-path="graph.html"><a href="graph.html#graph-pl-points"><i class="fa fa-check"></i><b>28.2.2</b> <code>points()</code></a></li>
<li class="chapter" data-level="28.2.3" data-path="graph.html"><a href="graph.html#graph-pl-lines"><i class="fa fa-check"></i><b>28.2.3</b> <code>lines()</code></a></li>
<li class="chapter" data-level="28.2.4" data-path="graph.html"><a href="graph.html#graph-pl-legend"><i class="fa fa-check"></i><b>28.2.4</b> 图例</a></li>
<li class="chapter" data-level="28.2.5" data-path="graph.html"><a href="graph.html#graph-pl-axis"><i class="fa fa-check"></i><b>28.2.5</b> <code>axis()</code></a></li>
<li class="chapter" data-level="28.2.6" data-path="graph.html"><a href="graph.html#graph-pl-text"><i class="fa fa-check"></i><b>28.2.6</b> <code>text()</code></a></li>
<li class="chapter" data-level="28.2.7" data-path="graph.html"><a href="graph.html#graph-pl-locator"><i class="fa fa-check"></i><b>28.2.7</b> <code>locator()</code>和<code>identify()</code></a></li>
</ul></li>
<li class="chapter" data-level="28.3" data-path="graph.html"><a href="graph.html#graph-par"><i class="fa fa-check"></i><b>28.3</b> 图形参数</a><ul>
<li class="chapter" data-level="28.3.1" data-path="graph.html"><a href="graph.html#graph-par-ex1"><i class="fa fa-check"></i><b>28.3.1</b> 例子：用图形参数解决barplot图形横坐标值过宽</a></li>
<li class="chapter" data-level="28.3.2" data-path="graph.html"><a href="graph.html#graph-par-elem"><i class="fa fa-check"></i><b>28.3.2</b> 图形元素控制</a></li>
<li class="chapter" data-level="28.3.3" data-path="graph.html"><a href="graph.html#graph-par-axis"><i class="fa fa-check"></i><b>28.3.3</b> 坐标轴与坐标刻度</a></li>
<li class="chapter" data-level="28.3.4" data-path="graph.html"><a href="graph.html#graph-par-mar"><i class="fa fa-check"></i><b>28.3.4</b> 图形边空</a></li>
<li class="chapter" data-level="28.3.5" data-path="graph.html"><a href="graph.html#graph-par-mfrow"><i class="fa fa-check"></i><b>28.3.5</b> 一页多图</a></li>
</ul></li>
<li class="chapter" data-level="28.4" data-path="graph.html"><a href="graph.html#graph-pout"><i class="fa fa-check"></i><b>28.4</b> 图形输出</a><ul>
<li class="chapter" data-level="28.4.1" data-path="graph.html"><a href="graph.html#graph-pout-pdf"><i class="fa fa-check"></i><b>28.4.1</b> PDF 输出</a></li>
<li class="chapter" data-level="28.4.2" data-path="graph.html"><a href="graph.html#graph-pout-png"><i class="fa fa-check"></i><b>28.4.2</b> PNG输出</a></li>
</ul></li>
<li class="chapter" data-level="28.5" data-path="graph.html"><a href="graph.html#graph-pzhn"><i class="fa fa-check"></i><b>28.5</b> 包含多种中文字体的图形</a></li>
<li class="chapter" data-level="28.6" data-path="graph.html"><a href="graph.html#graph-other"><i class="fa fa-check"></i><b>28.6</b> 其它图形</a><ul>
<li class="chapter" data-level="28.6.1" data-path="graph.html"><a href="graph.html#graph-other-corr"><i class="fa fa-check"></i><b>28.6.1</b> 相关系数图</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="29" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>29</b> ggplot作图入门</a><ul>
<li class="chapter" data-level="29.1" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-intro"><i class="fa fa-check"></i><b>29.1</b> 介绍</a></li>
<li class="chapter" data-level="29.2" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-principles"><i class="fa fa-check"></i><b>29.2</b> 作图的一般原则</a></li>
<li class="chapter" data-level="29.3" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-point"><i class="fa fa-check"></i><b>29.3</b> 散点图：ggplot入门</a><ul>
<li class="chapter" data-level="29.3.1" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-point-base"><i class="fa fa-check"></i><b>29.3.1</b> 基本的散点图</a></li>
<li class="chapter" data-level="29.3.2" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-point-layers"><i class="fa fa-check"></i><b>29.3.2</b> 逐步改善</a></li>
<li class="chapter" data-level="29.3.3" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-point-otheraes"><i class="fa fa-check"></i><b>29.3.3</b> 颜色、符号、线型等映射</a></li>
<li class="chapter" data-level="29.3.4" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-point-geomaes"><i class="fa fa-check"></i><b>29.3.4</b> 在geom函数中映射变量</a></li>
<li class="chapter" data-level="29.3.5" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-point-contcolor"><i class="fa fa-check"></i><b>29.3.5</b> 连续变量的颜色映射</a></li>
<li class="chapter" data-level="29.3.6" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-point-save"><i class="fa fa-check"></i><b>29.3.6</b> 保存图像</a></li>
</ul></li>
<li class="chapter" data-level="29.4" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-right"><i class="fa fa-check"></i><b>29.4</b> 折线图、分组、小图</a><ul>
<li class="chapter" data-level="29.4.1" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-right-group"><i class="fa fa-check"></i><b>29.4.1</b> 图形中的分组和折线图</a></li>
<li class="chapter" data-level="29.4.2" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-right-facet"><i class="fa fa-check"></i><b>29.4.2</b> 小图(facet)</a></li>
</ul></li>
<li class="chapter" data-level="29.5" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-bar-trans"><i class="fa fa-check"></i><b>29.5</b> 数据变换与条形图</a><ul>
<li class="chapter" data-level="29.5.1" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-right-morebar"><i class="fa fa-check"></i><b>29.5.1</b> 分段与并列条形图</a></li>
<li class="chapter" data-level="29.5.2" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-bar-morebar"><i class="fa fa-check"></i><b>29.5.2</b> 条形图的其它应用</a></li>
</ul></li>
<li class="chapter" data-level="29.6" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-hist"><i class="fa fa-check"></i><b>29.6</b> 直方图与密度估计</a></li>
<li class="chapter" data-level="29.7" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-gramm"><i class="fa fa-check"></i><b>29.7</b> 绘图语法介绍</a><ul>
<li class="chapter" data-level="29.7.1" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-gramm-gramm"><i class="fa fa-check"></i><b>29.7.1</b> 绘图语法</a></li>
<li class="chapter" data-level="29.7.2" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-gramm-geoms"><i class="fa fa-check"></i><b>29.7.2</b> 图形种类</a></li>
</ul></li>
<li class="chapter" data-level="29.8" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-moregeom"><i class="fa fa-check"></i><b>29.8</b> 更多图形种类</a><ul>
<li class="chapter" data-level="29.8.1" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-moregeom-continuousvar"><i class="fa fa-check"></i><b>29.8.1</b> 连续变量的分组图形</a></li>
<li class="chapter" data-level="29.8.2" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-moregeom-text"><i class="fa fa-check"></i><b>29.8.2</b> 坐标系中的文字</a></li>
<li class="chapter" data-level="29.8.3" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-moregeom-textops"><i class="fa fa-check"></i><b>29.8.3</b> 文字选项</a></li>
<li class="chapter" data-level="29.8.4" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-moregeom-outliers"><i class="fa fa-check"></i><b>29.8.4</b> 标出特殊点</a></li>
</ul></li>
<li class="chapter" data-level="29.9" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-auxfuncs-scale"><i class="fa fa-check"></i><b>29.9</b> 刻度(scale)</a></li>
<li class="chapter" data-level="29.10" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-refine-color"><i class="fa fa-check"></i><b>29.10</b> 如何使用颜色</a><ul>
<li class="chapter" data-level="29.10.1" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-refine-qual"><i class="fa fa-check"></i><b>29.10.1</b> 名义型变量的颜色</a></li>
<li class="chapter" data-level="29.10.2" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-refine-tile"><i class="fa fa-check"></i><b>29.10.2</b> 色块图</a></li>
<li class="chapter" data-level="29.10.3" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-refine-seq"><i class="fa fa-check"></i><b>29.10.3</b> 有序型变量的颜色</a></li>
<li class="chapter" data-level="29.10.4" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-refine-div"><i class="fa fa-check"></i><b>29.10.4</b> 相异型变量的颜色</a></li>
<li class="chapter" data-level="29.10.5" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-refine-num"><i class="fa fa-check"></i><b>29.10.5</b> 连续数值变量的颜色</a></li>
</ul></li>
<li class="chapter" data-level="29.11" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-auxfuncs"><i class="fa fa-check"></i><b>29.11</b> 标题、标注、指南、拼接</a><ul>
<li class="chapter" data-level="29.11.1" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-auxfuncs-labs"><i class="fa fa-check"></i><b>29.11.1</b> 标题</a></li>
<li class="chapter" data-level="29.11.2" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-auxfuncs-anno"><i class="fa fa-check"></i><b>29.11.2</b> 标注功能</a></li>
<li class="chapter" data-level="29.11.3" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-auxfuncs-guides"><i class="fa fa-check"></i><b>29.11.3</b> 指南(guides)</a></li>
<li class="chapter" data-level="29.11.4" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-auxfuncs-compfig"><i class="fa fa-check"></i><b>29.11.4</b> 拼接图形</a></li>
</ul></li>
<li class="chapter" data-level="29.12" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-refine"><i class="fa fa-check"></i><b>29.12</b> 图形定制调整</a><ul>
<li class="chapter" data-level="29.12.1" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-refine-asasec"><i class="fa fa-check"></i><b>29.12.1</b> 图形逐步调整例子</a></li>
</ul></li>
<li class="chapter" data-level="29.13" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-theme"><i class="fa fa-check"></i><b>29.13</b> 主题</a></li>
<li class="chapter" data-level="29.14" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-ref"><i class="fa fa-check"></i><b>29.14</b> 参考文献</a></li>
</ul></li>
<li class="chapter" data-level="30" data-path="ggplotvis.html"><a href="ggplotvis.html"><i class="fa fa-check"></i><b>30</b> ggplot的各种图形</a><ul>
<li class="chapter" data-level="30.1" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-intro"><i class="fa fa-check"></i><b>30.1</b> 介绍</a></li>
<li class="chapter" data-level="30.2" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-amount"><i class="fa fa-check"></i><b>30.2</b> 表现数量</a><ul>
<li class="chapter" data-level="30.2.1" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-amount-bar"><i class="fa fa-check"></i><b>30.2.1</b> 条形图</a></li>
<li class="chapter" data-level="30.2.2" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-amount-point"><i class="fa fa-check"></i><b>30.2.2</b> 点图</a></li>
<li class="chapter" data-level="30.2.3" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-amount-heatmap"><i class="fa fa-check"></i><b>30.2.3</b> 热力图</a></li>
</ul></li>
<li class="chapter" data-level="30.3" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-dist"><i class="fa fa-check"></i><b>30.3</b> 表现分布</a><ul>
<li class="chapter" data-level="30.3.1" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-dist-suni-hist"><i class="fa fa-check"></i><b>30.3.1</b> 单个一元分布的直方图与密度估计图</a></li>
<li class="chapter" data-level="30.3.2" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-dist-muni"><i class="fa fa-check"></i><b>30.3.2</b> 多个一元分布的直方图和密度图形</a></li>
<li class="chapter" data-level="30.3.3" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-dist-cdf"><i class="fa fa-check"></i><b>30.3.3</b> 经验分布函数图</a></li>
<li class="chapter" data-level="30.3.4" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-dist-qqplot"><i class="fa fa-check"></i><b>30.3.4</b> QQ图</a></li>
<li class="chapter" data-level="30.3.5" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-dist-boxplot"><i class="fa fa-check"></i><b>30.3.5</b> 盒形图</a></li>
<li class="chapter" data-level="30.3.6" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-dist-violin"><i class="fa fa-check"></i><b>30.3.6</b> 小提琴图</a></li>
<li class="chapter" data-level="30.3.7" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-dist-mdens"><i class="fa fa-check"></i><b>30.3.7</b> 多个密度的其它画法</a></li>
<li class="chapter" data-level="30.3.8" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-dist-2d"><i class="fa fa-check"></i><b>30.3.8</b> 二元分布直方图和等值线图</a></li>
</ul></li>
<li class="chapter" data-level="30.4" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-prop"><i class="fa fa-check"></i><b>30.4</b> 表现比例</a><ul>
<li class="chapter" data-level="30.4.1" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-prop-uni"><i class="fa fa-check"></i><b>30.4.1</b> 单个分布</a></li>
<li class="chapter" data-level="30.4.2" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-prop-mult"><i class="fa fa-check"></i><b>30.4.2</b> 组间的比例分布的比较</a></li>
<li class="chapter" data-level="30.4.3" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-prop-nest"><i class="fa fa-check"></i><b>30.4.3</b> 嵌套比例分布的比较</a></li>
</ul></li>
<li class="chapter" data-level="30.5" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-mulvar"><i class="fa fa-check"></i><b>30.5</b> 表现多个变量间的关系</a><ul>
<li class="chapter" data-level="30.5.1" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-mulvar-scatter"><i class="fa fa-check"></i><b>30.5.1</b> 散点图</a></li>
<li class="chapter" data-level="30.5.2" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-mulvar-scatmat"><i class="fa fa-check"></i><b>30.5.2</b> 散点图矩阵</a></li>
<li class="chapter" data-level="30.5.3" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-mulvar-corrgram"><i class="fa fa-check"></i><b>30.5.3</b> 相关系数矩阵图</a></li>
<li class="chapter" data-level="30.5.4" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-mulvar-dimreduct"><i class="fa fa-check"></i><b>30.5.4</b> 数据降维</a></li>
<li class="chapter" data-level="30.5.5" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-mulvar-paird"><i class="fa fa-check"></i><b>30.5.5</b> 成对数据</a></li>
</ul></li>
<li class="chapter" data-level="30.6" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-ts"><i class="fa fa-check"></i><b>30.6</b> 时间序列图</a><ul>
<li class="chapter" data-level="30.6.1" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-ts-uni"><i class="fa fa-check"></i><b>30.6.1</b> 一元时间序列</a></li>
<li class="chapter" data-level="30.6.2" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-ts-mul"><i class="fa fa-check"></i><b>30.6.2</b> 多元时间序列</a></li>
<li class="chapter" data-level="30.6.3" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-ts-het"><i class="fa fa-check"></i><b>30.6.3</b> 多个不同类型指标的时间序列</a></li>
</ul></li>
<li class="chapter" data-level="30.7" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-fit"><i class="fa fa-check"></i><b>30.7</b> 拟合曲线图</a><ul>
<li class="chapter" data-level="30.7.1" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-fit-smooth"><i class="fa fa-check"></i><b>30.7.1</b> 平滑方法</a></li>
<li class="chapter" data-level="30.7.2" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-fit-param"><i class="fa fa-check"></i><b>30.7.2</b> 参数模型方法</a></li>
</ul></li>
<li class="chapter" data-level="30.8" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-uncert"><i class="fa fa-check"></i><b>30.8</b> 表现不确定性</a><ul>
<li class="chapter" data-level="30.8.1" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-uncert-prob"><i class="fa fa-check"></i><b>30.8.1</b> 表现概率</a></li>
<li class="chapter" data-level="30.8.2" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-uncert-se"><i class="fa fa-check"></i><b>30.8.2</b> 表现点估计精度</a></li>
<li class="chapter" data-level="30.8.3" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-uncert-cband"><i class="fa fa-check"></i><b>30.8.3</b> 拟合曲线的置信带</a></li>
<li class="chapter" data-level="30.8.4" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-uncert-dyn"><i class="fa fa-check"></i><b>30.8.4</b> 随机结果动态演示</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>VII 统计模型</b></span></li>
<li class="chapter" data-level="31" data-path="stat-basics.html"><a href="stat-basics.html"><i class="fa fa-check"></i><b>31</b> R初等统计分析</a><ul>
<li class="chapter" data-level="31.1" data-path="stat-basics.html"><a href="stat-basics.html#stat-base-distr"><i class="fa fa-check"></i><b>31.1</b> 概率分布</a></li>
<li class="chapter" data-level="31.2" data-path="stat-basics.html"><a href="stat-basics.html#stat-base-mle"><i class="fa fa-check"></i><b>31.2</b> 最大似然估计</a><ul>
<li class="chapter" data-level="31.2.1" data-path="stat-basics.html"><a href="stat-basics.html#stat-base-mle-norm1"><i class="fa fa-check"></i><b>31.2.1</b> 一元正态分布参数最大似然估计</a></li>
</ul></li>
<li class="chapter" data-level="31.3" data-path="stat-basics.html"><a href="stat-basics.html#stat-base-hyptest"><i class="fa fa-check"></i><b>31.3</b> 假设检验和置信区间</a><ul>
<li class="chapter" data-level="31.3.1" data-path="stat-basics.html"><a href="stat-basics.html#stat-base-hyptest-mu"><i class="fa fa-check"></i><b>31.3.1</b> 均值的假设检验和置信区间</a></li>
<li class="chapter" data-level="31.3.2" data-path="stat-basics.html"><a href="stat-basics.html#stat-base-hyptest-prop"><i class="fa fa-check"></i><b>31.3.2</b> 比例的假设检验和置信区间</a></li>
<li class="chapter" data-level="31.3.3" data-path="stat-basics.html"><a href="stat-basics.html#stat-base-hyptest-sigma"><i class="fa fa-check"></i><b>31.3.3</b> 方差的假设检验和置信区间</a></li>
<li class="chapter" data-level="31.3.4" data-path="stat-basics.html"><a href="stat-basics.html#stat-base-hyptest-gof"><i class="fa fa-check"></i><b>31.3.4</b> 拟合优度检验</a></li>
<li class="chapter" data-level="31.3.5" data-path="stat-basics.html"><a href="stat-basics.html#stat-base-hyptest-gof-vcd"><i class="fa fa-check"></i><b>31.3.5</b> 检验分布类型</a></li>
<li class="chapter" data-level="31.3.6" data-path="stat-basics.html"><a href="stat-basics.html#stat-base-hyptest-indepcont"><i class="fa fa-check"></i><b>31.3.6</b> 列联表独立性卡方检验</a></li>
<li class="chapter" data-level="31.3.7" data-path="stat-basics.html"><a href="stat-basics.html#stat-base-hyptest-npar"><i class="fa fa-check"></i><b>31.3.7</b> 非参数检验</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="32" data-path="stat-reg.html"><a href="stat-reg.html"><i class="fa fa-check"></i><b>32</b> R相关与回归</a><ul>
<li class="chapter" data-level="32.1" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-cor"><i class="fa fa-check"></i><b>32.1</b> 相关分析</a><ul>
<li class="chapter" data-level="32.1.1" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-cor-prop"><i class="fa fa-check"></i><b>32.1.1</b> 相关系数的性质</a></li>
<li class="chapter" data-level="32.1.2" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-cor-caus"><i class="fa fa-check"></i><b>32.1.2</b> 相关与因果</a></li>
<li class="chapter" data-level="32.1.3" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-cor-magn"><i class="fa fa-check"></i><b>32.1.3</b> 相关系数大小</a></li>
<li class="chapter" data-level="32.1.4" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-cor-test"><i class="fa fa-check"></i><b>32.1.4</b> 相关系数的检验</a></li>
<li class="chapter" data-level="32.1.5" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-cor-vcorr"><i class="fa fa-check"></i><b>32.1.5</b> 相关阵</a></li>
</ul></li>
<li class="chapter" data-level="32.2" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regsimp"><i class="fa fa-check"></i><b>32.2</b> 一元回归分析</a><ul>
<li class="chapter" data-level="32.2.1" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regsimp-model"><i class="fa fa-check"></i><b>32.2.1</b> 模型</a></li>
<li class="chapter" data-level="32.2.2" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regsimp-ls"><i class="fa fa-check"></i><b>32.2.2</b> 最小二乘法</a></li>
<li class="chapter" data-level="32.2.3" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regsimp-test"><i class="fa fa-check"></i><b>32.2.3</b> 回归有效性</a></li>
<li class="chapter" data-level="32.2.4" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regsimp-prog"><i class="fa fa-check"></i><b>32.2.4</b> R程序</a></li>
<li class="chapter" data-level="32.2.5" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regsimp-diag"><i class="fa fa-check"></i><b>32.2.5</b> 回归诊断</a></li>
<li class="chapter" data-level="32.2.6" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regsimp-ci"><i class="fa fa-check"></i><b>32.2.6</b> 预测区间</a></li>
<li class="chapter" data-level="32.2.7" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regsimp-control"><i class="fa fa-check"></i><b>32.2.7</b> 控制</a></li>
</ul></li>
<li class="chapter" data-level="32.3" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regmu"><i class="fa fa-check"></i><b>32.3</b> 多元线性回归</a><ul>
<li class="chapter" data-level="32.3.1" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regmu-mod"><i class="fa fa-check"></i><b>32.3.1</b> 模型</a></li>
<li class="chapter" data-level="32.3.2" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regmu-est"><i class="fa fa-check"></i><b>32.3.2</b> 参数估计</a></li>
<li class="chapter" data-level="32.3.3" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regmu-rcode"><i class="fa fa-check"></i><b>32.3.3</b> R的多元回归程序</a></li>
<li class="chapter" data-level="32.3.4" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regmu-test"><i class="fa fa-check"></i><b>32.3.4</b> 模型的检验</a></li>
<li class="chapter" data-level="32.3.5" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regmu-subset"><i class="fa fa-check"></i><b>32.3.5</b> 回归自变量筛选</a></li>
<li class="chapter" data-level="32.3.6" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regmu-dum"><i class="fa fa-check"></i><b>32.3.6</b> 哑变量与变截距项的模型</a></li>
<li class="chapter" data-level="32.3.7" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regmu-resid"><i class="fa fa-check"></i><b>32.3.7</b> 残差诊断</a></li>
<li class="chapter" data-level="32.3.8" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regmu-colin"><i class="fa fa-check"></i><b>32.3.8</b> 多重共线性</a></li>
<li class="chapter" data-level="32.3.9" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regmu-lev"><i class="fa fa-check"></i><b>32.3.9</b> 强影响点分析</a></li>
<li class="chapter" data-level="32.3.10" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regmu-overfit"><i class="fa fa-check"></i><b>32.3.10</b> 过度拟合示例</a></li>
<li class="chapter" data-level="32.3.11" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regmu-comp-inset"><i class="fa fa-check"></i><b>32.3.11</b> 嵌套模型的比较</a></li>
<li class="chapter" data-level="32.3.12" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regmu-pred"><i class="fa fa-check"></i><b>32.3.12</b> 拟合与预测</a></li>
<li class="chapter" data-level="32.3.13" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regmu-curve"><i class="fa fa-check"></i><b>32.3.13</b> 利用线性回归模型做曲线拟合</a></li>
<li class="chapter" data-level="32.3.14" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regmu-group"><i class="fa fa-check"></i><b>32.3.14</b> 分组建立多个模型</a></li>
</ul></li>
<li class="chapter" data-level="32.4" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-npar"><i class="fa fa-check"></i><b>32.4</b> 非参数回归</a><ul>
<li class="chapter" data-level="32.4.1" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-npar-mod"><i class="fa fa-check"></i><b>32.4.1</b> 模型</a></li>
<li class="chapter" data-level="32.4.2" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-cfit-spl1d"><i class="fa fa-check"></i><b>32.4.2</b> 样条平滑</a></li>
<li class="chapter" data-level="32.4.3" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-cfit-loess"><i class="fa fa-check"></i><b>32.4.3</b> 局部多项式曲线平滑</a></li>
<li class="chapter" data-level="32.4.4" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-cfit-bs"><i class="fa fa-check"></i><b>32.4.4</b> 样条函数变换</a></li>
<li class="chapter" data-level="32.4.5" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-cfit-gam"><i class="fa fa-check"></i><b>32.4.5</b> 线性可加模型</a></li>
</ul></li>
<li class="chapter" data-level="32.5" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-reglog"><i class="fa fa-check"></i><b>32.5</b> Logistic回归</a><ul>
<li class="chapter" data-level="32.5.1" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-reglog-mod"><i class="fa fa-check"></i><b>32.5.1</b> 模型</a></li>
<li class="chapter" data-level="32.5.2" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-reglog-rcode"><i class="fa fa-check"></i><b>32.5.2</b> R程序</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="33" data-path="stat-tsa.html"><a href="stat-tsa.html"><i class="fa fa-check"></i><b>33</b> R时间序列分析</a><ul>
<li class="chapter" data-level="33.1" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-defs"><i class="fa fa-check"></i><b>33.1</b> 基本概念</a></li>
<li class="chapter" data-level="33.2" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-dtype"><i class="fa fa-check"></i><b>33.2</b> 时间序列数据类型</a><ul>
<li class="chapter" data-level="33.2.1" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-dtype-ts"><i class="fa fa-check"></i><b>33.2.1</b> ts类型</a></li>
<li class="chapter" data-level="33.2.2" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-dtype-xts"><i class="fa fa-check"></i><b>33.2.2</b> xts类型与常用函数</a></li>
</ul></li>
<li class="chapter" data-level="33.3" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-basicstat"><i class="fa fa-check"></i><b>33.3</b> 基本分析与作图</a></li>
<li class="chapter" data-level="33.4" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-arima"><i class="fa fa-check"></i><b>33.4</b> ARIMA建模和模拟</a><ul>
<li class="chapter" data-level="33.4.1" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-arima-def"><i class="fa fa-check"></i><b>33.4.1</b> 模型公式</a></li>
<li class="chapter" data-level="33.4.2" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-arima-sim"><i class="fa fa-check"></i><b>33.4.2</b> 模拟</a></li>
<li class="chapter" data-level="33.4.3" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-arima-armod"><i class="fa fa-check"></i><b>33.4.3</b> AR建模</a></li>
<li class="chapter" data-level="33.4.4" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-arima-armamod"><i class="fa fa-check"></i><b>33.4.4</b> ARMA建模</a></li>
<li class="chapter" data-level="33.4.5" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-arima-diag"><i class="fa fa-check"></i><b>33.4.5</b> 模型诊断</a></li>
<li class="chapter" data-level="33.4.6" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-arima-lbtest"><i class="fa fa-check"></i><b>33.4.6</b> 白噪声检验</a></li>
<li class="chapter" data-level="33.4.7" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-arima-sparse"><i class="fa fa-check"></i><b>33.4.7</b> 稀疏系数估计</a></li>
<li class="chapter" data-level="33.4.8" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-arima-adftest"><i class="fa fa-check"></i><b>33.4.8</b> 单位根检验</a></li>
<li class="chapter" data-level="33.4.9" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-arima-cfuncs"><i class="fa fa-check"></i><b>33.4.9</b> ARMA模型的一些自定义函数</a></li>
</ul></li>
<li class="chapter" data-level="33.5" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-spectra"><i class="fa fa-check"></i><b>33.5</b> 谱密度估计</a></li>
<li class="chapter" data-level="33.6" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-garch"><i class="fa fa-check"></i><b>33.6</b> GARCH类模型</a></li>
<li class="chapter" data-level="33.7" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-mtsa"><i class="fa fa-check"></i><b>33.7</b> 多元时间序列基础统计</a></li>
<li class="chapter" data-level="33.8" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-var"><i class="fa fa-check"></i><b>33.8</b> VAR模型</a></li>
<li class="chapter" data-level="33.9" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-coint"><i class="fa fa-check"></i><b>33.9</b> 协整分析</a></li>
<li class="chapter" data-level="33.10" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-causal"><i class="fa fa-check"></i><b>33.10</b> 因果性检验</a></li>
</ul></li>
<li class="chapter" data-level="34" data-path="stat-learning.html"><a href="stat-learning.html"><i class="fa fa-check"></i><b>34</b> 统计学习介绍</a><ul>
<li class="chapter" data-level="34.1" data-path="stat-learning.html"><a href="stat-learning.html#statl-intro"><i class="fa fa-check"></i><b>34.1</b> 统计学习的基本概念和一般步骤</a><ul>
<li class="chapter" data-level="34.1.1" data-path="stat-learning.html"><a href="stat-learning.html#statl-intro-basic"><i class="fa fa-check"></i><b>34.1.1</b> 统计学习的基本概念和方法</a></li>
<li class="chapter" data-level="34.1.2" data-path="stat-learning.html"><a href="stat-learning.html#statl-intro-biasvar"><i class="fa fa-check"></i><b>34.1.2</b> 偏差与方差折衷</a></li>
<li class="chapter" data-level="34.1.3" data-path="stat-learning.html"><a href="stat-learning.html#statl-cv"><i class="fa fa-check"></i><b>34.1.3</b> 交叉验证</a></li>
<li class="chapter" data-level="34.1.4" data-path="stat-learning.html"><a href="stat-learning.html#statl-steps"><i class="fa fa-check"></i><b>34.1.4</b> 一般步骤</a></li>
</ul></li>
<li class="chapter" data-level="34.2" data-path="stat-learning.html"><a href="stat-learning.html#statl-hitters"><i class="fa fa-check"></i><b>34.2</b> Hitters数据分析</a><ul>
<li class="chapter" data-level="34.2.1" data-path="stat-learning.html"><a href="stat-learning.html#statl-hitters-subset"><i class="fa fa-check"></i><b>34.2.1</b> 回归自变量选择</a></li>
<li class="chapter" data-level="34.2.2" data-path="stat-learning.html"><a href="stat-learning.html#statl-hitters-ridge"><i class="fa fa-check"></i><b>34.2.2</b> 岭回归</a></li>
<li class="chapter" data-level="34.2.3" data-path="stat-learning.html"><a href="stat-learning.html#statl-hitters-lasso"><i class="fa fa-check"></i><b>34.2.3</b> Lasso回归</a></li>
<li class="chapter" data-level="34.2.4" data-path="stat-learning.html"><a href="stat-learning.html#statl-hitters-simpt"><i class="fa fa-check"></i><b>34.2.4</b> 树回归的简单演示</a></li>
<li class="chapter" data-level="34.2.5" data-path="stat-learning.html"><a href="stat-learning.html#statl-hitters-tree"><i class="fa fa-check"></i><b>34.2.5</b> 树回归</a></li>
<li class="chapter" data-level="34.2.6" data-path="stat-learning.html"><a href="stat-learning.html#statl-hitters-bag"><i class="fa fa-check"></i><b>34.2.6</b> 装袋法</a></li>
<li class="chapter" data-level="34.2.7" data-path="stat-learning.html"><a href="stat-learning.html#statl-hitters-rf"><i class="fa fa-check"></i><b>34.2.7</b> 随机森林</a></li>
</ul></li>
<li class="chapter" data-level="34.3" data-path="stat-learning.html"><a href="stat-learning.html#statl-heart"><i class="fa fa-check"></i><b>34.3</b> Heart数据分析</a><ul>
<li class="chapter" data-level="34.3.1" data-path="stat-learning.html"><a href="stat-learning.html#statl-heart-tree"><i class="fa fa-check"></i><b>34.3.1</b> 树回归</a></li>
<li class="chapter" data-level="34.3.2" data-path="stat-learning.html"><a href="stat-learning.html#statl-heart-bag"><i class="fa fa-check"></i><b>34.3.2</b> 用装袋法</a></li>
<li class="chapter" data-level="34.3.3" data-path="stat-learning.html"><a href="stat-learning.html#statl-heart-rf"><i class="fa fa-check"></i><b>34.3.3</b> 用随机森林</a></li>
</ul></li>
<li class="chapter" data-level="34.4" data-path="stat-learning.html"><a href="stat-learning.html#statl-car"><i class="fa fa-check"></i><b>34.4</b> 汽车销量数据分析</a><ul>
<li class="chapter" data-level="34.4.1" data-path="stat-learning.html"><a href="stat-learning.html#statl-car-tree"><i class="fa fa-check"></i><b>34.4.1</b> 判别树</a></li>
<li class="chapter" data-level="34.4.2" data-path="stat-learning.html"><a href="stat-learning.html#statl-car-rf"><i class="fa fa-check"></i><b>34.4.2</b> 随机森林</a></li>
</ul></li>
<li class="chapter" data-level="34.5" data-path="stat-learning.html"><a href="stat-learning.html#statl-boston"><i class="fa fa-check"></i><b>34.5</b> 波士顿郊区房价数据</a><ul>
<li class="chapter" data-level="34.5.1" data-path="stat-learning.html"><a href="stat-learning.html#statl-boston-tree"><i class="fa fa-check"></i><b>34.5.1</b> 回归树</a></li>
<li class="chapter" data-level="34.5.2" data-path="stat-learning.html"><a href="stat-learning.html#statl-boston-bag"><i class="fa fa-check"></i><b>34.5.2</b> 装袋法</a></li>
<li class="chapter" data-level="34.5.3" data-path="stat-learning.html"><a href="stat-learning.html#statl-boston-rf"><i class="fa fa-check"></i><b>34.5.3</b> 随机森林</a></li>
<li class="chapter" data-level="34.5.4" data-path="stat-learning.html"><a href="stat-learning.html#statl-boston-boost"><i class="fa fa-check"></i><b>34.5.4</b> 提升法</a></li>
</ul></li>
<li class="chapter" data-level="34.6" data-path="stat-learning.html"><a href="stat-learning.html#statl-svm"><i class="fa fa-check"></i><b>34.6</b> 支持向量机方法</a><ul>
<li class="chapter" data-level="34.6.1" data-path="stat-learning.html"><a href="stat-learning.html#statl-svm-heart"><i class="fa fa-check"></i><b>34.6.1</b> 支持向量机用于Heart数据</a></li>
</ul></li>
<li class="chapter" data-level="34.7" data-path="stat-learning.html"><a href="stat-learning.html#statl-app"><i class="fa fa-check"></i><b>34.7</b> 附录</a><ul>
<li class="chapter" data-level="34.7.1" data-path="stat-learning.html"><a href="stat-learning.html#statl-app-hitters"><i class="fa fa-check"></i><b>34.7.1</b> Hitters数据</a></li>
<li class="chapter" data-level="34.7.2" data-path="stat-learning.html"><a href="stat-learning.html#statl-app-heart"><i class="fa fa-check"></i><b>34.7.2</b> Heart数据</a></li>
<li class="chapter" data-level="34.7.3" data-path="stat-learning.html"><a href="stat-learning.html#statl-app-car"><i class="fa fa-check"></i><b>34.7.3</b> CarSeats数据</a></li>
<li class="chapter" data-level="34.7.4" data-path="stat-learning.html"><a href="stat-learning.html#statl-app-boston"><i class="fa fa-check"></i><b>34.7.4</b> Boston数据</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="35" data-path="simulation.html"><a href="simulation.html"><i class="fa fa-check"></i><b>35</b> 随机模拟</a><ul>
<li class="chapter" data-level="35.1" data-path="simulation.html"><a href="simulation.html#simint"><i class="fa fa-check"></i><b>35.1</b> 随机数</a></li>
<li class="chapter" data-level="35.2" data-path="simulation.html"><a href="simulation.html#simsamp"><i class="fa fa-check"></i><b>35.2</b> <code>sample()</code>函数</a></li>
<li class="chapter" data-level="35.3" data-path="simulation.html"><a href="simulation.html#simexamp"><i class="fa fa-check"></i><b>35.3</b> 随机模拟示例</a><ul>
<li class="chapter" data-level="35.3.1" data-path="simulation.html"><a href="simulation.html#simexamp-expect"><i class="fa fa-check"></i><b>35.3.1</b> 估计期望值</a></li>
<li class="chapter" data-level="35.3.2" data-path="simulation.html"><a href="simulation.html#simexamp-lm"><i class="fa fa-check"></i><b>35.3.2</b> 线性回归模拟</a></li>
<li class="chapter" data-level="35.3.3" data-path="simulation.html"><a href="simulation.html#simexamp-kde"><i class="fa fa-check"></i><b>35.3.3</b> 核密度的bootstrap置信区间</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>VIII 特殊应用</b></span></li>
<li class="chapter" data-level="36" data-path="text.html"><a href="text.html"><i class="fa fa-check"></i><b>36</b> R语言的文本处理</a><ul>
<li class="chapter" data-level="36.1" data-path="text.html"><a href="text.html#text-simple"><i class="fa fa-check"></i><b>36.1</b> 简单的文本处理</a><ul>
<li class="chapter" data-level="36.1.1" data-path="text.html"><a href="text.html#text-simple-const"><i class="fa fa-check"></i><b>36.1.1</b> 字符型常量与字符型向量</a></li>
<li class="chapter" data-level="36.1.2" data-path="text.html"><a href="text.html#text-paste"><i class="fa fa-check"></i><b>36.1.2</b> 字符串连接、重复</a></li>
<li class="chapter" data-level="36.1.3" data-path="text.html"><a href="text.html#text-formatout"><i class="fa fa-check"></i><b>36.1.3</b> 格式化输出</a></li>
<li class="chapter" data-level="36.1.4" data-path="text.html"><a href="text.html#text-length"><i class="fa fa-check"></i><b>36.1.4</b> 字符串长度</a></li>
<li class="chapter" data-level="36.1.5" data-path="text.html"><a href="text.html#text-substring"><i class="fa fa-check"></i><b>36.1.5</b> 取子串</a></li>
<li class="chapter" data-level="36.1.6" data-path="text.html"><a href="text.html#text-convert"><i class="fa fa-check"></i><b>36.1.6</b> 字符串变换</a></li>
<li class="chapter" data-level="36.1.7" data-path="text.html"><a href="text.html#text-simp-find"><i class="fa fa-check"></i><b>36.1.7</b> 简单匹配与查找</a></li>
<li class="chapter" data-level="36.1.8" data-path="text.html"><a href="text.html#text-simple-gsub"><i class="fa fa-check"></i><b>36.1.8</b> 字符串替换</a></li>
<li class="chapter" data-level="36.1.9" data-path="text.html"><a href="text.html#text-simple-strsplit"><i class="fa fa-check"></i><b>36.1.9</b> 字符串拆分</a></li>
</ul></li>
<li class="chapter" data-level="36.2" data-path="text.html"><a href="text.html#text-file"><i class="fa fa-check"></i><b>36.2</b> 文本文件读写</a></li>
<li class="chapter" data-level="36.3" data-path="text.html"><a href="text.html#text-regex"><i class="fa fa-check"></i><b>36.3</b> 正则表达式</a><ul>
<li class="chapter" data-level="36.3.1" data-path="text.html"><a href="text.html#text-regex-strview"><i class="fa fa-check"></i><b>36.3.1</b> 字面匹配与匹配显示</a></li>
<li class="chapter" data-level="36.3.2" data-path="text.html"><a href="text.html#text-regex-ignore"><i class="fa fa-check"></i><b>36.3.2</b> 不区分大小写匹配和<code>regex</code>函数</a></li>
<li class="chapter" data-level="36.3.3" data-path="text.html"><a href="text.html#text-regex-dot"><i class="fa fa-check"></i><b>36.3.3</b> 用句点匹配单个字符</a></li>
<li class="chapter" data-level="36.3.4" data-path="text.html"><a href="text.html#text-regex-set"><i class="fa fa-check"></i><b>36.3.4</b> 匹配一组字符中的某一个</a></li>
<li class="chapter" data-level="36.3.5" data-path="text.html"><a href="text.html#text-regex-metalit"><i class="fa fa-check"></i><b>36.3.5</b> 原样匹配元字符</a></li>
<li class="chapter" data-level="36.3.6" data-path="text.html"><a href="text.html#text-regex-space"><i class="fa fa-check"></i><b>36.3.6</b> 匹配空白</a></li>
<li class="chapter" data-level="36.3.7" data-path="text.html"><a href="text.html#text-regex-digit"><i class="fa fa-check"></i><b>36.3.7</b> 匹配数字</a></li>
<li class="chapter" data-level="36.3.8" data-path="text.html"><a href="text.html#text-regex-alnum"><i class="fa fa-check"></i><b>36.3.8</b> 匹配字母、数字、下划线</a></li>
<li class="chapter" data-level="36.3.9" data-path="text.html"><a href="text.html#text-regex-hex"><i class="fa fa-check"></i><b>36.3.9</b> 十六进制和八进制数</a></li>
<li class="chapter" data-level="36.3.10" data-path="text.html"><a href="text.html#text-regex-posix"><i class="fa fa-check"></i><b>36.3.10</b> POSIX字符类</a></li>
<li class="chapter" data-level="36.3.11" data-path="text.html"><a href="text.html#text-regex-start"><i class="fa fa-check"></i><b>36.3.11</b> 匹配开头和末尾</a></li>
<li class="chapter" data-level="36.3.12" data-path="text.html"><a href="text.html#text-regex-wordb"><i class="fa fa-check"></i><b>36.3.12</b> 单词边界</a></li>
<li class="chapter" data-level="36.3.13" data-path="text.html"><a href="text.html#text-regex-repeat"><i class="fa fa-check"></i><b>36.3.13</b> 重复匹配</a></li>
<li class="chapter" data-level="36.3.14" data-path="text.html"><a href="text.html#text-regex-lazy"><i class="fa fa-check"></i><b>36.3.14</b> 贪婪匹配和懒惰匹配</a></li>
<li class="chapter" data-level="36.3.15" data-path="text.html"><a href="text.html#text-regex-smlines"><i class="fa fa-check"></i><b>36.3.15</b> 句点全匹配与多行模式</a></li>
<li class="chapter" data-level="36.3.16" data-path="text.html"><a href="text.html#text-regex-alt"><i class="fa fa-check"></i><b>36.3.16</b> 备择模式</a></li>
<li class="chapter" data-level="36.3.17" data-path="text.html"><a href="text.html#text-regex-group"><i class="fa fa-check"></i><b>36.3.17</b> 分组与捕获</a></li>
</ul></li>
<li class="chapter" data-level="36.4" data-path="text.html"><a href="text.html#text-stringr-funcs"><i class="fa fa-check"></i><b>36.4</b> stringr包的正则表达式函数</a><ul>
<li class="chapter" data-level="36.4.1" data-path="text.html"><a href="text.html#text-stringr-funcs-strview"><i class="fa fa-check"></i><b>36.4.1</b> <code>str_view()</code>函数</a></li>
<li class="chapter" data-level="36.4.2" data-path="text.html"><a href="text.html#text-stringr-funcs-regex"><i class="fa fa-check"></i><b>36.4.2</b> <code>regex()</code>函数</a></li>
<li class="chapter" data-level="36.4.3" data-path="text.html"><a href="text.html#text-stringr-funcs-detect"><i class="fa fa-check"></i><b>36.4.3</b> 检查那些元素能够匹配</a></li>
<li class="chapter" data-level="36.4.4" data-path="text.html"><a href="text.html#text-stringr-funcs-replace"><i class="fa fa-check"></i><b>36.4.4</b> 替换</a></li>
<li class="chapter" data-level="36.4.5" data-path="text.html"><a href="text.html#text-stringr-funcs-subset"><i class="fa fa-check"></i><b>36.4.5</b> 返回匹配的元素</a></li>
<li class="chapter" data-level="36.4.6" data-path="text.html"><a href="text.html#text-stringr-funcs-extract"><i class="fa fa-check"></i><b>36.4.6</b> 提取匹配内容</a></li>
<li class="chapter" data-level="36.4.7" data-path="text.html"><a href="text.html#text-stringr-funcs-match"><i class="fa fa-check"></i><b>36.4.7</b> 提取分组捕获内容</a></li>
<li class="chapter" data-level="36.4.8" data-path="text.html"><a href="text.html#text-stringr-funcs-locate"><i class="fa fa-check"></i><b>36.4.8</b> 定位匹配位置</a></li>
</ul></li>
<li class="chapter" data-level="36.5" data-path="text.html"><a href="text.html#text-regex-bfuncs"><i class="fa fa-check"></i><b>36.5</b> 利用基本R函数进行正则表达式处理</a><ul>
<li class="chapter" data-level="36.5.1" data-path="text.html"><a href="text.html#text-regex-bfuncs-igcase"><i class="fa fa-check"></i><b>36.5.1</b> 不区分大小写匹配</a></li>
<li class="chapter" data-level="36.5.2" data-path="text.html"><a href="text.html#text-regex-bfuncs-dotp"><i class="fa fa-check"></i><b>36.5.2</b> 匹配单个字符</a></li>
<li class="chapter" data-level="36.5.3" data-path="text.html"><a href="text.html#text-regex-bfuncs-setp"><i class="fa fa-check"></i><b>36.5.3</b> 匹配一组字符中的某一个</a></li>
<li class="chapter" data-level="36.5.4" data-path="text.html"><a href="text.html#text-regex-bfuncs-metalit"><i class="fa fa-check"></i><b>36.5.4</b> 原样匹配元字符</a></li>
<li class="chapter" data-level="36.5.5" data-path="text.html"><a href="text.html#text-regex-bfuncs-digit"><i class="fa fa-check"></i><b>36.5.5</b> 匹配数字</a></li>
<li class="chapter" data-level="36.5.6" data-path="text.html"><a href="text.html#text-regex-bfuncs-start"><i class="fa fa-check"></i><b>36.5.6</b> 匹配开头和末尾</a></li>
<li class="chapter" data-level="36.5.7" data-path="text.html"><a href="text.html#text-regex-bfuncs-alnum"><i class="fa fa-check"></i><b>36.5.7</b> 匹配字母、数字、下划线</a></li>
<li class="chapter" data-level="36.5.8" data-path="text.html"><a href="text.html#text-regex-bfuncs-hex"><i class="fa fa-check"></i><b>36.5.8</b> 十六进制和八进制数</a></li>
<li class="chapter" data-level="36.5.9" data-path="text.html"><a href="text.html#text-regex-bfuncs-posix"><i class="fa fa-check"></i><b>36.5.9</b> POSIX字符类</a></li>
<li class="chapter" data-level="36.5.10" data-path="text.html"><a href="text.html#text-regex-bfuncs-plus"><i class="fa fa-check"></i><b>36.5.10</b> 加号重复匹配</a></li>
<li class="chapter" data-level="36.5.11" data-path="text.html"><a href="text.html#text-regex-bfuncs-ast"><i class="fa fa-check"></i><b>36.5.11</b> 星号和问号重复匹配</a></li>
<li class="chapter" data-level="36.5.12" data-path="text.html"><a href="text.html#text-regex-bfuncs-repnum"><i class="fa fa-check"></i><b>36.5.12</b> 计数重复</a></li>
<li class="chapter" data-level="36.5.13" data-path="text.html"><a href="text.html#text-regex-bfuncs-lazy"><i class="fa fa-check"></i><b>36.5.13</b> 贪婪匹配和懒惰匹配</a></li>
<li class="chapter" data-level="36.5.14" data-path="text.html"><a href="text.html#text-regex-bfuncs-wordb"><i class="fa fa-check"></i><b>36.5.14</b> 单词边界</a></li>
<li class="chapter" data-level="36.5.15" data-path="text.html"><a href="text.html#text-regex-bfuncs-sm"><i class="fa fa-check"></i><b>36.5.15</b> 句点全匹配与多行模式</a></li>
<li class="chapter" data-level="36.5.16" data-path="text.html"><a href="text.html#text-regex-bfuncs-alt"><i class="fa fa-check"></i><b>36.5.16</b> 备择模式</a></li>
<li class="chapter" data-level="36.5.17" data-path="text.html"><a href="text.html#text-regex-bfuncs-group"><i class="fa fa-check"></i><b>36.5.17</b> 分组与捕获</a></li>
</ul></li>
<li class="chapter" data-level="36.6" data-path="text.html"><a href="text.html#text-regexex"><i class="fa fa-check"></i><b>36.6</b> 正则表达式应用例子</a><ul>
<li class="chapter" data-level="36.6.1" data-path="text.html"><a href="text.html#text-regexex-pre"><i class="fa fa-check"></i><b>36.6.1</b> 数据预处理</a></li>
<li class="chapter" data-level="36.6.2" data-path="text.html"><a href="text.html#text-regexex-excelmore"><i class="fa fa-check"></i><b>36.6.2</b> 不规则Excel文件处理</a></li>
<li class="chapter" data-level="36.6.3" data-path="text.html"><a href="text.html#text-regexex-wordfreq"><i class="fa fa-check"></i><b>36.6.3</b> 字频统计</a></li>
<li class="chapter" data-level="36.6.4" data-path="text.html"><a href="text.html#text-regexex-digits"><i class="fa fa-check"></i><b>36.6.4</b> 数字验证</a></li>
<li class="chapter" data-level="36.6.5" data-path="text.html"><a href="text.html#text-regexex-digfn"><i class="fa fa-check"></i><b>36.6.5</b> 文件名中的数字提取</a></li>
</ul></li>
<li class="chapter" data-level="36.7" data-path="text.html"><a href="text.html#text-webscape"><i class="fa fa-check"></i><b>36.7</b> 网站数据获取</a></li>
<li class="chapter" data-level="36.8" data-path="text.html"><a href="text.html#text-jiebaR"><i class="fa fa-check"></i><b>36.8</b> 中文分词与词频</a></li>
</ul></li>
<li class="part"><span><b>IX 用Rcpp访问C++代码</b></span></li>
<li class="chapter" data-level="37" data-path="rcpp.html"><a href="rcpp.html"><i class="fa fa-check"></i><b>37</b> Rcpp介绍</a><ul>
<li class="chapter" data-level="37.1" data-path="rcpp.html"><a href="rcpp.html#rcpp-intro-use"><i class="fa fa-check"></i><b>37.1</b> Rcpp的用途</a></li>
<li class="chapter" data-level="37.2" data-path="rcpp.html"><a href="rcpp.html#rcpp-intro-examp"><i class="fa fa-check"></i><b>37.2</b> Rcpp入门样例</a><ul>
<li class="chapter" data-level="37.2.1" data-path="rcpp.html"><a href="rcpp.html#rcpp-intro-examp-ex1"><i class="fa fa-check"></i><b>37.2.1</b> 用<code>cppFunction()</code>转换简单的C++函数—Fibnacci例子</a></li>
<li class="chapter" data-level="37.2.2" data-path="rcpp.html"><a href="rcpp.html#rcpp-intro-examp-ex2"><i class="fa fa-check"></i><b>37.2.2</b> 用<code>sourceCpp()</code>转换C++程序—正负交替迭代例子</a></li>
<li class="chapter" data-level="37.2.3" data-path="rcpp.html"><a href="rcpp.html#rcpp-intro-examp-ex3"><i class="fa fa-check"></i><b>37.2.3</b> 用<code>sourceCpp()</code>转换C++源文件中的程序—正负交替迭代例子</a></li>
<li class="chapter" data-level="37.2.4" data-path="rcpp.html"><a href="rcpp.html#rcpp-intro-examp-ex4"><i class="fa fa-check"></i><b>37.2.4</b> 用<code>sourceCpp()</code>转换C++源程序文件—卷积例子</a></li>
<li class="chapter" data-level="37.2.5" data-path="rcpp.html"><a href="rcpp.html#rcpp-intro-examp-rmdconv"><i class="fa fa-check"></i><b>37.2.5</b> 在Rmd文件中使用C++源程序文件</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="38" data-path="rcpp-typeconv.html"><a href="rcpp-typeconv.html"><i class="fa fa-check"></i><b>38</b> R与C++的类型转换</a><ul>
<li class="chapter" data-level="38.1" data-path="rcpp-typeconv.html"><a href="rcpp-typeconv.html#rcpp-typeconv-wrap"><i class="fa fa-check"></i><b>38.1</b> 用<code>wrap()</code>把C++变量返回到R中</a></li>
<li class="chapter" data-level="38.2" data-path="rcpp-typeconv.html"><a href="rcpp-typeconv.html#rcpp-typeconv-as"><i class="fa fa-check"></i><b>38.2</b> 用<code>as()</code>函数把R变量转换为C++类型</a></li>
<li class="chapter" data-level="38.3" data-path="rcpp-typeconv.html"><a href="rcpp-typeconv.html#rcpp-typeconv-implicit"><i class="fa fa-check"></i><b>38.3</b> <code>as()</code>和<code>wrap()</code>的隐含调用</a></li>
</ul></li>
<li class="chapter" data-level="39" data-path="rcpp-attr.html"><a href="rcpp-attr.html"><i class="fa fa-check"></i><b>39</b> Rcpp 属性</a><ul>
<li class="chapter" data-level="39.1" data-path="rcpp-attr.html"><a href="rcpp-attr.html#rcpp-attr-intro"><i class="fa fa-check"></i><b>39.1</b> Rcpp属性介绍</a></li>
<li class="chapter" data-level="39.2" data-path="rcpp-attr.html"><a href="rcpp-attr.html#rcpp-attr-export"><i class="fa fa-check"></i><b>39.2</b> 在C++源程序中指定要导出的C++函数</a></li>
<li class="chapter" data-level="39.3" data-path="rcpp-attr.html"><a href="rcpp-attr.html#rcpp-attr-sourcecpp"><i class="fa fa-check"></i><b>39.3</b> 在R中编译链接C++代码</a></li>
<li class="chapter" data-level="39.4" data-path="rcpp-attr.html"><a href="rcpp-attr.html#rcpp-attr-misc"><i class="fa fa-check"></i><b>39.4</b> Rcpp属性的其它功能</a><ul>
<li class="chapter" data-level="39.4.1" data-path="rcpp-attr.html"><a href="rcpp-attr.html#rcpp-attr-misc-default"><i class="fa fa-check"></i><b>39.4.1</b> 自变量有缺省值的函数</a></li>
<li class="chapter" data-level="39.4.2" data-path="rcpp-attr.html"><a href="rcpp-attr.html#rcpp-attr-misc-interrupt"><i class="fa fa-check"></i><b>39.4.2</b> 允许用户中断</a></li>
<li class="chapter" data-level="39.4.3" data-path="rcpp-attr.html"><a href="rcpp-attr.html#rcpp-attr-misc-rinclude"><i class="fa fa-check"></i><b>39.4.3</b> 把R代码写在C++源文件中</a></li>
<li class="chapter" data-level="39.4.4" data-path="rcpp-attr.html"><a href="rcpp-attr.html#rcpp-attr-misc-rand"><i class="fa fa-check"></i><b>39.4.4</b> 在C++中调用R的随机数发生器</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="40" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html"><i class="fa fa-check"></i><b>40</b> Rcpp提供的C++数据类型</a><ul>
<li class="chapter" data-level="40.1" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-vectype-robject"><i class="fa fa-check"></i><b>40.1</b> RObject类</a></li>
<li class="chapter" data-level="40.2" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-vectype-ivec"><i class="fa fa-check"></i><b>40.2</b> IntegerVector类</a><ul>
<li class="chapter" data-level="40.2.1" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-vectype-ivec-ex1"><i class="fa fa-check"></i><b>40.2.1</b> IntegerVector示例1：返回完全数</a></li>
<li class="chapter" data-level="40.2.2" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-vectype-ivec-ex2"><i class="fa fa-check"></i><b>40.2.2</b> IntegerVector示例2：输入整数向量</a></li>
</ul></li>
<li class="chapter" data-level="40.3" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-vectype-num"><i class="fa fa-check"></i><b>40.3</b> NumericVector类</a><ul>
<li class="chapter" data-level="40.3.1" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-vectype-num-ex1"><i class="fa fa-check"></i><b>40.3.1</b> 示例1：计算元素<span class="math inline">\(p\)</span>次方的和</a></li>
<li class="chapter" data-level="40.3.2" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-vectype-num-ex2"><i class="fa fa-check"></i><b>40.3.2</b> 示例2：<code>clone</code>函数</a></li>
<li class="chapter" data-level="40.3.3" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-vectype-num-ex3"><i class="fa fa-check"></i><b>40.3.3</b> 示例3：向量子集</a></li>
</ul></li>
<li class="chapter" data-level="40.4" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-vectype-mat"><i class="fa fa-check"></i><b>40.4</b> NumericMatrix类</a><ul>
<li class="chapter" data-level="40.4.1" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-vectype-mat-ex1"><i class="fa fa-check"></i><b>40.4.1</b> 示例1：计算矩阵各列模的最大值</a></li>
<li class="chapter" data-level="40.4.2" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-vectype-mat-ex2"><i class="fa fa-check"></i><b>40.4.2</b> 示例2：把输入矩阵制作副本计算元素平方根</a></li>
<li class="chapter" data-level="40.4.3" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-vectype-mat-ex3"><i class="fa fa-check"></i><b>40.4.3</b> 示例3：访问列子集</a></li>
</ul></li>
<li class="chapter" data-level="40.5" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-vectype-other"><i class="fa fa-check"></i><b>40.5</b> Rcpp的其它向量类</a><ul>
<li class="chapter" data-level="40.5.1" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-vectype-logic"><i class="fa fa-check"></i><b>40.5.1</b> Rcpp的LogicalVector类</a></li>
<li class="chapter" data-level="40.5.2" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-vectype-char"><i class="fa fa-check"></i><b>40.5.2</b> Rcpp的CharacterVector类型</a></li>
</ul></li>
<li class="chapter" data-level="40.6" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-types"><i class="fa fa-check"></i><b>40.6</b> Rcpp提供的其它数据类型</a><ul>
<li class="chapter" data-level="40.6.1" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-types-named"><i class="fa fa-check"></i><b>40.6.1</b> Named类型</a></li>
<li class="chapter" data-level="40.6.2" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-types-list"><i class="fa fa-check"></i><b>40.6.2</b> List类型</a></li>
<li class="chapter" data-level="40.6.3" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-types-df"><i class="fa fa-check"></i><b>40.6.3</b> Rcpp的DataFrame类</a></li>
<li class="chapter" data-level="40.6.4" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-types-func"><i class="fa fa-check"></i><b>40.6.4</b> Rcpp的Function类</a></li>
<li class="chapter" data-level="40.6.5" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-types-environ"><i class="fa fa-check"></i><b>40.6.5</b> Rcpp的Environment类</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="41" data-path="rcpp-sugar.html"><a href="rcpp-sugar.html"><i class="fa fa-check"></i><b>41</b> Rcpp糖</a><ul>
<li class="chapter" data-level="41.1" data-path="rcpp-sugar.html"><a href="rcpp-sugar.html#rcpp-sugar-examp"><i class="fa fa-check"></i><b>41.1</b> 简单示例</a></li>
<li class="chapter" data-level="41.2" data-path="rcpp-sugar.html"><a href="rcpp-sugar.html#rcpp-sugar-vecop"><i class="fa fa-check"></i><b>41.2</b> 向量化的运算符</a><ul>
<li class="chapter" data-level="41.2.1" data-path="rcpp-sugar.html"><a href="rcpp-sugar.html#rcpp-sugar-vecop-arith"><i class="fa fa-check"></i><b>41.2.1</b> 向量化的四则运算</a></li>
<li class="chapter" data-level="41.2.2" data-path="rcpp-sugar.html"><a href="rcpp-sugar.html#rcpp-sugar-vecop-binop"><i class="fa fa-check"></i><b>41.2.2</b> 向量化的二元逻辑运算</a></li>
<li class="chapter" data-level="41.2.3" data-path="rcpp-sugar.html"><a href="rcpp-sugar.html#rcpp-sugar-vecop-uop"><i class="fa fa-check"></i><b>41.2.3</b> 向量化的一元运算符</a></li>
</ul></li>
<li class="chapter" data-level="41.3" data-path="rcpp-sugar.html"><a href="rcpp-sugar.html#rcpp-sugar-mathfunc"><i class="fa fa-check"></i><b>41.3</b> 用Rcpp访问数学函数</a></li>
<li class="chapter" data-level="41.4" data-path="rcpp-sugar.html"><a href="rcpp-sugar.html#rcpp-sugar-any"><i class="fa fa-check"></i><b>41.4</b> 返回单一逻辑值的函数</a></li>
<li class="chapter" data-level="41.5" data-path="rcpp-sugar.html"><a href="rcpp-sugar.html#rcpp-sugar-expfunc"><i class="fa fa-check"></i><b>41.5</b> 返回糖表达式的函数</a></li>
<li class="chapter" data-level="41.6" data-path="rcpp-sugar.html"><a href="rcpp-sugar.html#rcpp-sugar-diff"><i class="fa fa-check"></i><b>41.6</b> R与Rcpp不同语法示例</a></li>
</ul></li>
<li class="chapter" data-level="42" data-path="rcpp-package.html"><a href="rcpp-package.html"><i class="fa fa-check"></i><b>42</b> 用Rcpp帮助制作R扩展包</a><ul>
<li class="chapter" data-level="42.1" data-path="rcpp-package.html"><a href="rcpp-package.html#rcpp-package-wo"><i class="fa fa-check"></i><b>42.1</b> 不用扩展包共享C++代码的方法</a></li>
<li class="chapter" data-level="42.2" data-path="rcpp-package.html"><a href="rcpp-package.html#rcpp-package-gen"><i class="fa fa-check"></i><b>42.2</b> 生成扩展包</a><ul>
<li class="chapter" data-level="42.2.1" data-path="rcpp-package.html"><a href="rcpp-package.html#rcpp-package-gen-exist"><i class="fa fa-check"></i><b>42.2.1</b> 利用已有基于Rcpp属性的源程序制作扩展包</a></li>
<li class="chapter" data-level="42.2.2" data-path="rcpp-package.html"><a href="rcpp-package.html#rcpp-package-gen-desc"><i class="fa fa-check"></i><b>42.2.2</b> DESCRIPTION文件</a></li>
<li class="chapter" data-level="42.2.3" data-path="rcpp-package.html"><a href="rcpp-package.html#rcpp-package-gen-namespace"><i class="fa fa-check"></i><b>42.2.3</b> NAMESPACE文件</a></li>
</ul></li>
<li class="chapter" data-level="42.3" data-path="rcpp-package.html"><a href="rcpp-package.html#rcpp-package-recomp"><i class="fa fa-check"></i><b>42.3</b> 重新编译</a></li>
<li class="chapter" data-level="42.4" data-path="rcpp-package.html"><a href="rcpp-package.html#rcpp-package-interface"><i class="fa fa-check"></i><b>42.4</b> 建立C++用的接口界面</a></li>
</ul></li>
<li class="part"><span><b>X 编程例子</b></span></li>
<li class="chapter" data-level="43" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>43</b> R编程例子</a><ul>
<li class="chapter" data-level="43.1" data-path="examples.html"><a href="examples.html#examples-rlang"><i class="fa fa-check"></i><b>43.1</b> R语言</a><ul>
<li class="chapter" data-level="43.1.1" data-path="examples.html"><a href="examples.html#examples-rlang-inverse"><i class="fa fa-check"></i><b>43.1.1</b> 用向量作逆变换</a></li>
<li class="chapter" data-level="43.1.2" data-path="examples.html"><a href="examples.html#examples-rlang-fibonacci"><i class="fa fa-check"></i><b>43.1.2</b> 斐波那契数列计算</a></li>
<li class="chapter" data-level="43.1.3" data-path="examples.html"><a href="examples.html#examples-rlang-permutation"><i class="fa fa-check"></i><b>43.1.3</b> 穷举所有排列</a></li>
<li class="chapter" data-level="43.1.4" data-path="examples.html"><a href="examples.html#examples-rlang-repgroup"><i class="fa fa-check"></i><b>43.1.4</b> 可重复分组方式穷举</a></li>
<li class="chapter" data-level="43.1.5" data-path="examples.html"><a href="examples.html#examples-rlang-runs"><i class="fa fa-check"></i><b>43.1.5</b> 升降连计数</a></li>
</ul></li>
<li class="chapter" data-level="43.2" data-path="examples.html"><a href="examples.html#examples-prob"><i class="fa fa-check"></i><b>43.2</b> 概率</a><ul>
<li class="chapter" data-level="43.2.1" data-path="examples.html"><a href="examples.html#examples-prob-thsage"><i class="fa fa-check"></i><b>43.2.1</b> 智者千虑必有一失</a></li>
<li class="chapter" data-level="43.2.2" data-path="examples.html"><a href="examples.html#examples-prob-coupleseats"><i class="fa fa-check"></i><b>43.2.2</b> 圆桌夫妇座位问题</a></li>
</ul></li>
<li class="chapter" data-level="43.3" data-path="examples.html"><a href="examples.html#examples-scicomp"><i class="fa fa-check"></i><b>43.3</b> 科学计算</a><ul>
<li class="chapter" data-level="43.3.1" data-path="examples.html"><a href="examples.html#examples-scicomp-citylink"><i class="fa fa-check"></i><b>43.3.1</b> 城市间最短路径</a></li>
<li class="chapter" data-level="43.3.2" data-path="examples.html"><a href="examples.html#examples-scicomp-daub"><i class="fa fa-check"></i><b>43.3.2</b> Daubechies小波函数计算</a></li>
<li class="chapter" data-level="43.3.3" data-path="examples.html"><a href="examples.html#examples-scicomp-heating"><i class="fa fa-check"></i><b>43.3.3</b> 房间加热温度变化</a></li>
</ul></li>
<li class="chapter" data-level="43.4" data-path="examples.html"><a href="examples.html#examples-statcomp"><i class="fa fa-check"></i><b>43.4</b> 统计计算</a><ul>
<li class="chapter" data-level="43.4.1" data-path="examples.html"><a href="examples.html#examples-statcomp-kernden"><i class="fa fa-check"></i><b>43.4.1</b> 核回归与核密度估计</a></li>
<li class="chapter" data-level="43.4.2" data-path="examples.html"><a href="examples.html#examples-statcomp-mcquad2d"><i class="fa fa-check"></i><b>43.4.2</b> 二维随机模拟积分</a></li>
<li class="chapter" data-level="43.4.3" data-path="examples.html"><a href="examples.html#examples-statcomp-hidfreq"><i class="fa fa-check"></i><b>43.4.3</b> 潜周期估计</a></li>
<li class="chapter" data-level="43.4.4" data-path="examples.html"><a href="examples.html#examples-statcomp-armaest"><i class="fa fa-check"></i><b>43.4.4</b> ARMA(1,1)模型估计</a></li>
<li class="chapter" data-level="43.4.5" data-path="examples.html"><a href="examples.html#examples-statcomp-varprop"><i class="fa fa-check"></i><b>43.4.5</b> VAR模型平稳性</a></li>
<li class="chapter" data-level="43.4.6" data-path="examples.html"><a href="examples.html#examples-statcomp-storereliab"><i class="fa fa-check"></i><b>43.4.6</b> 贮存可靠性评估</a></li>
</ul></li>
<li class="chapter" data-level="43.5" data-path="examples.html"><a href="examples.html#examples-datatreat"><i class="fa fa-check"></i><b>43.5</b> 数据处理</a><ul>
<li class="chapter" data-level="43.5.1" data-path="examples.html"><a href="examples.html#examples-datatreat-subscore"><i class="fa fa-check"></i><b>43.5.1</b> 小题分题型分数汇总</a></li>
<li class="chapter" data-level="43.5.2" data-path="examples.html"><a href="examples.html#examples-datatreat-cluslab"><i class="fa fa-check"></i><b>43.5.2</b> 类别编号重排</a></li>
</ul></li>
<li class="chapter" data-level="43.6" data-path="examples.html"><a href="examples.html#examples-texttr"><i class="fa fa-check"></i><b>43.6</b> 文本处理</a><ul>
<li class="chapter" data-level="43.6.1" data-path="examples.html"><a href="examples.html#examples-texttr-hongloument"><i class="fa fa-check"></i><b>43.6.1</b> 用R语言下载处理《红楼梦》htm文件</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="http://www.math.pku.edu.cn/teachers/lidf/" target="blank">编著：李东风</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R语言教程</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="stat-basics" class="section level1">
<h1><span class="header-section-number">31</span> R初等统计分析</h1>
<p>这一部分讲授如何用R进行统计分析，
包括基本概括统计和探索性数据分析，
置信区间和假设检验，
回归分析与各种回归方法，
广义线性模型，
非线性回归与平滑，
判别树和回归树，
等等。</p>
<p>主要参考书：</p>
<ul>
<li><span class="citation">(Venables and Ripley <a href="#ref-MASS4ed" role="doc-biblioref">2002</a>)</span></li>
<li><span class="citation">(Kabacoff <a href="#ref-R-in-action" role="doc-biblioref">2012</a>)</span></li>
</ul>
<div id="stat-base-distr" class="section level2">
<h2><span class="header-section-number">31.1</span> 概率分布</h2>
<p>R中与<code>xxx</code>分布有关的函数包括：</p>
<ul>
<li><code>dxxx(x)</code>，
即<code>xxx</code>分布的分布密度函数(PDF)或概率函数(PMF)<span class="math inline">\(p(x)\)</span>。</li>
<li><code>pxxx(q)</code>，
即<code>xxx</code>分布的分布函数(CDF)<span class="math inline">\(F(q)=P(X \leq q)\)</span>。</li>
<li><code>qxxx(p)</code>，
即<code>xxx</code>分布的分位数函数<span class="math inline">\(q(p)\)</span>, <span class="math inline">\(p \in (0,1)\)</span>，
对连续型分布，<span class="math inline">\(q(p) = F^{-1}(p)\)</span>，
即<span class="math inline">\(F(x)=p\)</span>的解<span class="math inline">\(x\)</span>。</li>
<li><code>rxxx(n)</code>，
即<code>xxx</code>的随机数函数，可以生成<span class="math inline">\(n\)</span>个<code>xxx</code>的随机数。</li>
</ul>
<p><code>dxxx(x)</code>函数可以加选项<code>log=TRUE</code>，
用来计算<code>\ln p(x)</code>，
这在计算对数似然函数时有用，
比<code>log(dxxx(x))</code>更精确。</p>
<p><code>pxxx(q)</code>可以加选项<code>lower.tail=FALSE</code>，
变成计算<span class="math inline">\(P(X&gt;q) = 1 - F(q)\)</span>。</p>
<p><code>qxxx(p)</code>可以加选项<code>lower.tail=TRUE</code>，
表示求<span class="math inline">\(P(X&gt;x)=p\)</span>的解<span class="math inline">\(x\)</span>；
可以加选项<code>log.p=TRUE</code>，
表示输入的<span class="math inline">\(p\)</span>实际是<span class="math inline">\(\ln p\)</span>。</p>
<p>这些函数都可以带有自己的分布参数，
有些分布参数有缺省值，
比如正态分布的缺省参数值为零均值单位标准差。</p>
<p>具体的分布类型可以在R命令行用<code>?Distributions</code>查看列表。
常用的分布密度有：</p>
<ul>
<li>离散分布有<code>dbinom</code>二项分布,
<code>dpois</code>泊松分布，
<code>dgeom</code>几何分布，
<code>dnbinom</code>负二项分布，
<code>dmultinom</code>多项分布，
<code>dhyper</code>超几何分布。</li>
<li>连续分布有
<code>dunif</code>均匀分布，
<code>dnorm</code>正态分布，
<code>dchisq</code>卡方分布，
<code>dt</code> t分布(包括非中心t)，
<code>df</code> F分布，
<code>dexp</code>指数分布，
<code>dweibull</code> 威布尔分布，
<code>dgamma</code> 伽马分布，
<code>dbeta</code> 贝塔分布，
<code>dlnorm</code> 对数正态分布，
<code>dcauchy</code> 柯西分布,
<code>dlogis</code> 逻辑斯谛分布。</li>
</ul>
<p>R的扩展包提供了更多的分布，
参见R网站的如下链接：</p>
<ul>
<li><a href="https://cran.r-project.org/web/views/Distributions.html" class="uri">https://cran.r-project.org/web/views/Distributions.html</a></li>
</ul>
</div>
<div id="stat-base-mle" class="section level2">
<h2><span class="header-section-number">31.2</span> 最大似然估计</h2>
<p>R函数<code>optim()</code>、<code>nlm()</code>、<code>optimize()</code>可以用来求函数极值，
因此可以用来计算最大似然估计。
<code>optimize()</code>只能求一元函数极值。</p>
<div id="stat-base-mle-norm1" class="section level3">
<h3><span class="header-section-number">31.2.1</span> 一元正态分布参数最大似然估计</h3>
<p>正态分布最大似然估计有解析表达式。
作为示例，
用R函数进行数值优化求解。</p>
<p>对数似然函数为：</p>
<p><span class="math display">\[
\ln L(\mu,\sigma^2) = -\frac{n}{2}\ln(2\pi)
 -\frac{n}{2}\ln\sigma^2
 - \frac{1}{2\sigma^2} \sum(X_i - \mu)^2
\]</span></p>
<p>定义R的优化目标函数为上述对数似然函数去掉常数项以后乘以<span class="math inline">\(-2\)</span>，
求其最小值点。
目标函数为：</p>
<div class="sourceCode" id="cb2051"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2051-1"><a href="stat-basics.html#cb2051-1"></a>objf.norm1 &lt;-<span class="st"> </span><span class="cf">function</span>(theta, x){</span>
<span id="cb2051-2"><a href="stat-basics.html#cb2051-2"></a>  mu &lt;-<span class="st"> </span>theta[<span class="dv">1</span>]</span>
<span id="cb2051-3"><a href="stat-basics.html#cb2051-3"></a>  s2 &lt;-<span class="st"> </span><span class="kw">exp</span>(theta[<span class="dv">2</span>])</span>
<span id="cb2051-4"><a href="stat-basics.html#cb2051-4"></a>  n &lt;-<span class="st"> </span><span class="kw">length</span>(x)</span>
<span id="cb2051-5"><a href="stat-basics.html#cb2051-5"></a>  res &lt;-<span class="st"> </span>n<span class="op">*</span><span class="kw">log</span>(s2) <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>s2<span class="op">*</span><span class="kw">sum</span>((x <span class="op">-</span><span class="st"> </span>mu)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb2051-6"><a href="stat-basics.html#cb2051-6"></a>  res</span>
<span id="cb2051-7"><a href="stat-basics.html#cb2051-7"></a>}</span></code></pre></div>
<p>其中<span class="math inline">\(\theta_1\)</span>为均值参数<span class="math inline">\(\mu\)</span>，
<span class="math inline">\(\theta_2\)</span>为方差参数<span class="math inline">\(\sigma^2\)</span>的对数值。
<code>x</code>是样本数值组成的R向量。</p>
<p>可以用<code>optim</code>函数来求极小值点。下面是一个模拟演示:</p>
<div class="sourceCode" id="cb2052"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2052-1"><a href="stat-basics.html#cb2052-1"></a>norm1d.mledemo1 &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">n=</span><span class="dv">30</span>){</span>
<span id="cb2052-2"><a href="stat-basics.html#cb2052-2"></a>  mu0 &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb2052-3"><a href="stat-basics.html#cb2052-3"></a>  sigma0 &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb2052-4"><a href="stat-basics.html#cb2052-4"></a>  <span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb2052-5"><a href="stat-basics.html#cb2052-5"></a>  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, mu0, sigma0)</span>
<span id="cb2052-6"><a href="stat-basics.html#cb2052-6"></a></span>
<span id="cb2052-7"><a href="stat-basics.html#cb2052-7"></a>  theta0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb2052-8"><a href="stat-basics.html#cb2052-8"></a>  ores &lt;-<span class="st"> </span><span class="kw">optim</span>(theta0, objf.norm1, <span class="dt">x=</span>x)</span>
<span id="cb2052-9"><a href="stat-basics.html#cb2052-9"></a>  <span class="kw">print</span>(ores)</span>
<span id="cb2052-10"><a href="stat-basics.html#cb2052-10"></a>  theta &lt;-<span class="st"> </span>ores<span class="op">$</span>par</span>
<span id="cb2052-11"><a href="stat-basics.html#cb2052-11"></a>  mu &lt;-<span class="st"> </span>theta[<span class="dv">1</span>]</span>
<span id="cb2052-12"><a href="stat-basics.html#cb2052-12"></a>  sigma &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="fl">0.5</span><span class="op">*</span>theta[<span class="dv">2</span>])</span>
<span id="cb2052-13"><a href="stat-basics.html#cb2052-13"></a>  <span class="kw">cat</span>(<span class="st">&#39;真实mu=&#39;</span>, mu0, <span class="st">&#39; 公式估计mu=&#39;</span>, <span class="kw">mean</span>(x), </span>
<span id="cb2052-14"><a href="stat-basics.html#cb2052-14"></a>      <span class="st">&#39; 数值优化估计mu=&#39;</span>, mu, <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</span>
<span id="cb2052-15"><a href="stat-basics.html#cb2052-15"></a>  <span class="kw">cat</span>(<span class="st">&#39;真实sigma=&#39;</span>, sigma0, </span>
<span id="cb2052-16"><a href="stat-basics.html#cb2052-16"></a>      <span class="st">&#39;公式估计sigma=&#39;</span>, <span class="kw">sqrt</span>(<span class="kw">var</span>(x)<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n), </span>
<span id="cb2052-17"><a href="stat-basics.html#cb2052-17"></a>      <span class="st">&#39; 数值优化估计sigma=&#39;</span>, sigma, <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</span>
<span id="cb2052-18"><a href="stat-basics.html#cb2052-18"></a>}</span>
<span id="cb2052-19"><a href="stat-basics.html#cb2052-19"></a><span class="kw">norm1d.mledemo1</span>()</span></code></pre></div>
<pre><code>## $par
## [1] 20.166892  1.193593
## 
## $value
## [1] 65.83709
## 
## $counts
## function gradient 
##      115       NA 
## 
## $convergence
## [1] 0
## 
## $message
## NULL
## 
## 真实mu= 20  公式估计mu= 20.16492  数值优化估计mu= 20.16689 
## 真实sigma= 2 公式估计sigma= 1.817177  数值优化估计sigma= 1.816291</code></pre>
<p>也可以用<code>nlm()</code>函数求最小值点，
下面是正态分布最大似然估计的另一个演示：</p>
<div class="sourceCode" id="cb2054"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2054-1"><a href="stat-basics.html#cb2054-1"></a>norm1d.mledemo2 &lt;-<span class="st"> </span><span class="cf">function</span>(){</span>
<span id="cb2054-2"><a href="stat-basics.html#cb2054-2"></a>  <span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb2054-3"><a href="stat-basics.html#cb2054-3"></a>  n &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb2054-4"><a href="stat-basics.html#cb2054-4"></a>  mu &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb2054-5"><a href="stat-basics.html#cb2054-5"></a>  sig &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb2054-6"><a href="stat-basics.html#cb2054-6"></a>  z &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dt">mean=</span>mu, <span class="dt">sd=</span>sig)</span>
<span id="cb2054-7"><a href="stat-basics.html#cb2054-7"></a>  neglogL &lt;-<span class="st"> </span><span class="cf">function</span>(parm) {</span>
<span id="cb2054-8"><a href="stat-basics.html#cb2054-8"></a>      <span class="op">-</span><span class="kw">sum</span>( <span class="kw">dnorm</span>(z, <span class="dt">mean=</span>parm[<span class="dv">1</span>],</span>
<span id="cb2054-9"><a href="stat-basics.html#cb2054-9"></a>                  <span class="dt">sd=</span><span class="kw">exp</span>(parm[<span class="dv">2</span>]), <span class="dt">log=</span><span class="ot">TRUE</span>) )</span>
<span id="cb2054-10"><a href="stat-basics.html#cb2054-10"></a>  }</span>
<span id="cb2054-11"><a href="stat-basics.html#cb2054-11"></a></span>
<span id="cb2054-12"><a href="stat-basics.html#cb2054-12"></a>  res &lt;-<span class="st"> </span><span class="kw">nlm</span>(neglogL, <span class="kw">c</span>(<span class="dv">10</span>, <span class="kw">log</span>(<span class="dv">10</span>)))</span>
<span id="cb2054-13"><a href="stat-basics.html#cb2054-13"></a>  <span class="kw">print</span>(res)</span>
<span id="cb2054-14"><a href="stat-basics.html#cb2054-14"></a>  sig2 &lt;-<span class="st"> </span><span class="kw">exp</span>(res<span class="op">$</span>estimate[<span class="dv">2</span>])</span>
<span id="cb2054-15"><a href="stat-basics.html#cb2054-15"></a>  <span class="kw">cat</span>(<span class="st">&#39;真实mu=&#39;</span>, mu, <span class="st">&#39; 公式估计mu=&#39;</span>, <span class="kw">mean</span>(z), </span>
<span id="cb2054-16"><a href="stat-basics.html#cb2054-16"></a>      <span class="st">&#39; 数值优化估计mu=&#39;</span>, res<span class="op">$</span>estimate[<span class="dv">1</span>], <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</span>
<span id="cb2054-17"><a href="stat-basics.html#cb2054-17"></a>  <span class="kw">cat</span>(<span class="st">&#39;真实sigma=&#39;</span>, sig, </span>
<span id="cb2054-18"><a href="stat-basics.html#cb2054-18"></a>      <span class="st">&#39;公式估计sigma=&#39;</span>, <span class="kw">sqrt</span>(<span class="kw">var</span>(z)<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n), </span>
<span id="cb2054-19"><a href="stat-basics.html#cb2054-19"></a>      <span class="st">&#39; 数值优化估计sigma=&#39;</span>, sig2, <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</span>
<span id="cb2054-20"><a href="stat-basics.html#cb2054-20"></a>  <span class="kw">invisible</span>()</span>
<span id="cb2054-21"><a href="stat-basics.html#cb2054-21"></a>}</span>
<span id="cb2054-22"><a href="stat-basics.html#cb2054-22"></a><span class="kw">norm1d.mledemo2</span>()</span></code></pre></div>
<pre><code>## $minimum
## [1] 60.48667
## 
## $estimate
## [1] 20.1649179  0.5972841
## 
## $gradient
## [1] 1.444576e-05 9.094805e-06
## 
## $code
## [1] 2
## 
## $iterations
## [1] 28
## 
## 真实mu= 20  公式估计mu= 20.16492  数值优化估计mu= 20.16492 
## 真实sigma= 2 公式估计sigma= 1.817177  数值优化估计sigma= 1.817177</code></pre>
<p>函数<code>optim()</code>缺省使用Nelder-Mead单纯型搜索算法，
此算法不要求计算梯度和海色阵，
算法稳定性好，
但是收敛速度比较慢。
可以用选项<code>method="BFGS"</code>指定BFGS拟牛顿法。
这时可以用<code>gr=</code>选项输入梯度函数，
缺省使用数值微分计算梯度。
如：</p>
<div class="sourceCode" id="cb2056"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2056-1"><a href="stat-basics.html#cb2056-1"></a>norm1d.mledemo1b &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">n=</span><span class="dv">30</span>){</span>
<span id="cb2056-2"><a href="stat-basics.html#cb2056-2"></a>  mu0 &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb2056-3"><a href="stat-basics.html#cb2056-3"></a>  sigma0 &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb2056-4"><a href="stat-basics.html#cb2056-4"></a>  <span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb2056-5"><a href="stat-basics.html#cb2056-5"></a>  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, mu0, sigma0)</span>
<span id="cb2056-6"><a href="stat-basics.html#cb2056-6"></a></span>
<span id="cb2056-7"><a href="stat-basics.html#cb2056-7"></a>  theta0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb2056-8"><a href="stat-basics.html#cb2056-8"></a>  ores &lt;-<span class="st"> </span><span class="kw">optim</span>(theta0, objf.norm1, <span class="dt">x=</span>x, <span class="dt">method=</span><span class="st">&quot;BFGS&quot;</span>)</span>
<span id="cb2056-9"><a href="stat-basics.html#cb2056-9"></a>  <span class="kw">print</span>(ores)</span>
<span id="cb2056-10"><a href="stat-basics.html#cb2056-10"></a>  theta &lt;-<span class="st"> </span>ores<span class="op">$</span>par</span>
<span id="cb2056-11"><a href="stat-basics.html#cb2056-11"></a>  mu &lt;-<span class="st"> </span>theta[<span class="dv">1</span>]</span>
<span id="cb2056-12"><a href="stat-basics.html#cb2056-12"></a>  sigma &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="fl">0.5</span><span class="op">*</span>theta[<span class="dv">2</span>])</span>
<span id="cb2056-13"><a href="stat-basics.html#cb2056-13"></a>  <span class="kw">cat</span>(<span class="st">&#39;真实mu=&#39;</span>, mu0, <span class="st">&#39; 公式估计mu=&#39;</span>, <span class="kw">mean</span>(x), </span>
<span id="cb2056-14"><a href="stat-basics.html#cb2056-14"></a>      <span class="st">&#39; 数值优化估计mu=&#39;</span>, mu, <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</span>
<span id="cb2056-15"><a href="stat-basics.html#cb2056-15"></a>  <span class="kw">cat</span>(<span class="st">&#39;真实sigma=&#39;</span>, sigma0, </span>
<span id="cb2056-16"><a href="stat-basics.html#cb2056-16"></a>      <span class="st">&#39;公式估计sigma=&#39;</span>, <span class="kw">sqrt</span>(<span class="kw">var</span>(x)<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n), </span>
<span id="cb2056-17"><a href="stat-basics.html#cb2056-17"></a>      <span class="st">&#39; 数值优化估计sigma=&#39;</span>, sigma, <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</span>
<span id="cb2056-18"><a href="stat-basics.html#cb2056-18"></a>}</span>
<span id="cb2056-19"><a href="stat-basics.html#cb2056-19"></a><span class="kw">norm1d.mledemo1b</span>()</span></code></pre></div>
<pre><code>## $par
## [1] 20.164916  1.194568
## 
## $value
## [1] 65.83704
## 
## $counts
## function gradient 
##       41       17 
## 
## $convergence
## [1] 0
## 
## $message
## NULL
## 
## 真实mu= 20  公式估计mu= 20.16492  数值优化估计mu= 20.16492 
## 真实sigma= 2 公式估计sigma= 1.817177  数值优化估计sigma= 1.817177</code></pre>
<p>注意使用数值微分时，
参数的初值的数量级应该与最终结果相差不大，
否则可能不收敛，
比如上面程序取初值<span class="math inline">\((0,0)\)</span>就会不收敛。</p>
<p><code>optim()</code>函数支持的方法还有<code>"CG"</code>是一种共轭梯度法，
此方法不如BFGS稳健，
但是可以减少存储量使用，
对大规模问题可能更适用。
<code>"L-BFGS-B"</code>是一种区间约束的BFGS优化方法。
<code>"SANN"</code>是模拟退火算法，
有利于求得全局最小值点，
速度比其它方法慢得多。</p>
<p>函数<code>optimize()</code>进行一元函数数值优化计算。
例如，在一元正态分布最大似然估计中，
在对数似然函数中代入<span class="math inline">\(\mu = \bar x\)</span>，目标函数（负2倍对数似然函数）为
<span class="math display">\[
h(\sigma^2) = \ln(\sigma^2) + \frac{1}{\sigma^2} \sum (X_i - \bar X)^2
\]</span>
下面的例子模拟计算<span class="math inline">\(\sigma^2\)</span>的最大似然估计：</p>
<div class="sourceCode" id="cb2058"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2058-1"><a href="stat-basics.html#cb2058-1"></a>norm1d.mledemo3 &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">n=</span><span class="dv">30</span>){</span>
<span id="cb2058-2"><a href="stat-basics.html#cb2058-2"></a>  mu0 &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb2058-3"><a href="stat-basics.html#cb2058-3"></a>  sigma0 &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb2058-4"><a href="stat-basics.html#cb2058-4"></a>  <span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb2058-5"><a href="stat-basics.html#cb2058-5"></a>  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, mu0, sigma0)</span>
<span id="cb2058-6"><a href="stat-basics.html#cb2058-6"></a></span>
<span id="cb2058-7"><a href="stat-basics.html#cb2058-7"></a>  mu &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb2058-8"><a href="stat-basics.html#cb2058-8"></a>  ss &lt;-<span class="st"> </span><span class="kw">sum</span>((x <span class="op">-</span><span class="st"> </span>mu)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">length</span>(x)</span>
<span id="cb2058-9"><a href="stat-basics.html#cb2058-9"></a>  objf &lt;-<span class="st"> </span><span class="cf">function</span>(delta, ss) <span class="kw">log</span>(delta) <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>delta<span class="op">*</span>ss</span>
<span id="cb2058-10"><a href="stat-basics.html#cb2058-10"></a>  ores &lt;-<span class="st"> </span><span class="kw">optimize</span>(objf, <span class="dt">lower=</span><span class="fl">0.0001</span>,</span>
<span id="cb2058-11"><a href="stat-basics.html#cb2058-11"></a>                   <span class="dt">upper=</span><span class="dv">1000</span>, <span class="dt">ss=</span>ss)</span>
<span id="cb2058-12"><a href="stat-basics.html#cb2058-12"></a>  delta &lt;-<span class="st"> </span>ores<span class="op">$</span>minimum</span>
<span id="cb2058-13"><a href="stat-basics.html#cb2058-13"></a>  sigma &lt;-<span class="st"> </span><span class="kw">sqrt</span>(delta)</span>
<span id="cb2058-14"><a href="stat-basics.html#cb2058-14"></a></span>
<span id="cb2058-15"><a href="stat-basics.html#cb2058-15"></a>  <span class="kw">print</span>(ores)</span>
<span id="cb2058-16"><a href="stat-basics.html#cb2058-16"></a>  <span class="kw">cat</span>(<span class="st">&#39;真实sigma=&#39;</span>, sigma0, </span>
<span id="cb2058-17"><a href="stat-basics.html#cb2058-17"></a>      <span class="st">&#39;公式估计sigma=&#39;</span>, <span class="kw">sqrt</span>(<span class="kw">var</span>(x)<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n), </span>
<span id="cb2058-18"><a href="stat-basics.html#cb2058-18"></a>      <span class="st">&#39; 数值优化估计sigma=&#39;</span>, sigma, <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</span>
<span id="cb2058-19"><a href="stat-basics.html#cb2058-19"></a>}</span>
<span id="cb2058-20"><a href="stat-basics.html#cb2058-20"></a><span class="kw">norm1d.mledemo3</span>()</span></code></pre></div>
<pre><code>## $minimum
## [1] 3.30214
## 
## $objective
## [1] 2.194568
## 
## 真实sigma= 2 公式估计sigma= 1.817177  数值优化估计sigma= 1.817179</code></pre>
</div>
</div>
<div id="stat-base-hyptest" class="section level2">
<h2><span class="header-section-number">31.3</span> 假设检验和置信区间</h2>
<div id="stat-base-hyptest-mu" class="section level3">
<h3><span class="header-section-number">31.3.1</span> 均值的假设检验和置信区间</h3>
<div id="stat-base-hyptest-mu1d" class="section level4">
<h4><span class="header-section-number">31.3.1.1</span> 单样本均值</h4>
<div id="stat-base-hyptest-mu1d-large" class="section level5">
<h5><span class="header-section-number">31.3.1.1.1</span> 大样本情形</h5>
<p>设总体<span class="math inline">\(X\)</span>期望为<span class="math inline">\(\mu\)</span>，方差为<span class="math inline">\(\sigma^2\)</span>。
<span class="math inline">\(X_1, X_2, \dots, X_n\)</span>是一组样本。</p>
<p>在大样本时，令
<span class="math display">\[
  Z = \frac{\bar x - \mu}{S / \sqrt{n}} \stackrel{\bullet}{\sim} \text{N}(0,1)
\]</span>
其中<span class="math inline">\(\stackrel{\bullet}{\sim}\)</span>表示近似服从某分布。
<span class="math inline">\(\bar x\)</span>为样本均值，<span class="math inline">\(S\)</span>为样本标准差。
<span class="math inline">\(\sigma\)</span>未知且大样本时，
<span class="math inline">\(\mu\)</span>近似<span class="math inline">\(1-\alpha\)</span>置信区间为
<span class="math display">\[
\bar x \pm \text{qnorm}(1-\alpha/2) S / \sqrt{n}
\]</span></p>
<p>用<code>BSDA::z.test(x, sigma.x=sd(x), conf.level=1-alpha)</code>可以计算如上的近似置信区间。</p>
<p>对于假设检验问题
<span class="math display">\[\begin{aligned}
&amp; H_0: \mu = \mu_0 \longleftrightarrow H_a: \mu \neq \mu_0 \\
&amp; H_0: \mu \leq \mu_0 \longleftrightarrow H_a: \mu &gt; \mu_0 \\
&amp; H_0: \mu \geq \mu_0 \longleftrightarrow H_a: \mu &lt; \mu_0
\end{aligned}\]</span>
定义检验统计量
<span class="math display">\[
Z = \frac{\bar x - \mu_0}{S / \sqrt{n}}
\]</span>
当<span class="math inline">\(\mu=\mu_0\)</span>时<span class="math inline">\(Z\)</span>近似服从N(0,1)分布。
可以用<code>BSDA::z.test(x, mu=mu0, sigma.x=sd(x))</code>进行双侧Z检验。
加选项<code>alternative="greater"</code>作右侧检验，
加选项<code>alternative="less"</code>作左侧检验。</p>
<p>如果上述问题中标准差<span class="math inline">\(\sigma\)</span>为已知，
应该在<span class="math inline">\(Z\)</span>的公式用<span class="math inline">\(\sigma\)</span>替换<span class="math inline">\(S\)</span>，即
<span class="math display">\[
Z = \frac{\bar x - \mu_0}{\sigma / \sqrt{n}}
\]</span>
计算<span class="math inline">\(\mu\)</span>的置信区间程序为<code>BSDA::z.test(x, sigma.x=sigma0)</code>，
计算<span class="math inline">\(Z\)</span>检验的程序为<code>BSDA::z.test(x, mu=mu0, sigma.x=sigma0)</code>，
仍可用选项<code>alternative=</code>指定双侧、右侧、左侧。</p>
</div>
<div id="stat-base-hyptest-mu1d-small" class="section level5">
<h5><span class="header-section-number">31.3.1.1.2</span> 小样本正态情形</h5>
<p>如果样本量较小（小于30），
则需要假定总体服从正态分布N(<span class="math inline">\(\mu, \sigma^2\)</span>)。</p>
<p>当<span class="math inline">\(\sigma\)</span>已知时，
有
<span class="math display">\[
Z = \frac{\bar x - \mu_0}{\sigma / \sqrt{n}} \sim \text{N}(0,1)
\]</span>
计算<span class="math inline">\(\mu\)</span>的置信区间程序为<code>BSDA::z.test(x, sigma.x=sigma0)</code>，
计算<span class="math inline">\(Z\)</span>检验的程序为<code>BSDA::z.test(x, mu=mu0, sigma.x=sigma0)</code>。</p>
<p>可以自己写一个计算Z检验的较通用的R函数：</p>
<div class="sourceCode" id="cb2060"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2060-1"><a href="stat-basics.html#cb2060-1"></a>z.test<span class="fl">.1</span>s &lt;-<span class="st"> </span><span class="cf">function</span>(</span>
<span id="cb2060-2"><a href="stat-basics.html#cb2060-2"></a>  x, <span class="dt">n=</span><span class="kw">length</span>(x), <span class="dt">mu=</span><span class="dv">0</span>, <span class="dt">sigma=</span><span class="kw">sd</span>(x), <span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>){</span>
<span id="cb2060-3"><a href="stat-basics.html#cb2060-3"></a>  z &lt;-<span class="st"> </span>(<span class="kw">mean</span>(x) <span class="op">-</span><span class="st"> </span>mu) <span class="op">/</span><span class="st"> </span>(sigma <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n))</span>
<span id="cb2060-4"><a href="stat-basics.html#cb2060-4"></a>  <span class="cf">if</span>(alternative<span class="op">==</span><span class="st">&quot;two.sided&quot;</span>){   <span class="co"># 双侧检验</span></span>
<span id="cb2060-5"><a href="stat-basics.html#cb2060-5"></a>    pvalue &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(<span class="kw">abs</span>(z)))</span>
<span id="cb2060-6"><a href="stat-basics.html#cb2060-6"></a>  } <span class="cf">else</span> <span class="cf">if</span>(alternative<span class="op">==</span><span class="st">&quot;less&quot;</span>){ <span class="co"># 左侧检验</span></span>
<span id="cb2060-7"><a href="stat-basics.html#cb2060-7"></a>    pvalue &lt;-<span class="st"> </span><span class="kw">pnorm</span>(z)</span>
<span id="cb2060-8"><a href="stat-basics.html#cb2060-8"></a>  } <span class="cf">else</span> <span class="cf">if</span>(alternative<span class="op">==</span><span class="st">&quot;greater&quot;</span>){ <span class="co"># 右侧检验</span></span>
<span id="cb2060-9"><a href="stat-basics.html#cb2060-9"></a>    pvalue &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(z)</span>
<span id="cb2060-10"><a href="stat-basics.html#cb2060-10"></a>  } <span class="cf">else</span> {</span>
<span id="cb2060-11"><a href="stat-basics.html#cb2060-11"></a>    <span class="kw">stop</span>(<span class="st">&quot;alternative unknown!&quot;</span>)</span>
<span id="cb2060-12"><a href="stat-basics.html#cb2060-12"></a>  }</span>
<span id="cb2060-13"><a href="stat-basics.html#cb2060-13"></a>  </span>
<span id="cb2060-14"><a href="stat-basics.html#cb2060-14"></a>  <span class="kw">c</span>(<span class="dt">stat=</span>z, <span class="dt">pvalue=</span>pvalue)</span>
<span id="cb2060-15"><a href="stat-basics.html#cb2060-15"></a>}</span></code></pre></div>
<p>这个函数输入样本<code>x</code>和<span class="math inline">\(\sigma=\sigma_0\)</span>，
或者输入<span class="math inline">\(\bar x\)</span>为<code>x</code>和<span class="math inline">\(\sigma=\sigma_0\)</span>，
输出检验统计量值和p值。</p>
<p>如果<span class="math inline">\(\sigma\)</span>未知，应使用t统计量检验
<span class="math display">\[
T = \frac{\bar x - \mu}{S / \sqrt{n}}
\]</span>
当<span class="math inline">\(\mu=\mu_0\)</span>时<span class="math inline">\(T \sim t(n-1)\)</span>。
如果<code>x</code>保存了样本，
用<code>t.test(x, conf.level=1-alpha)</code>计算<span class="math inline">\(\mu\)</span>的置信区间；
用<code>t.test(x, mu=mu0, alternative="two.side")</code>计算<span class="math inline">\(H_0: \mu=\mu_0\)</span>的双侧检验，
称为单样本t检验。</p>
<p>如果已知的<span class="math inline">\(\bar x\)</span>和<span class="math inline">\(S\)</span>而非具体样本数据，
可以自己写一个R函数计算t检验：</p>
<div class="sourceCode" id="cb2061"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2061-1"><a href="stat-basics.html#cb2061-1"></a>t.test<span class="fl">.1</span>s &lt;-<span class="st"> </span><span class="cf">function</span>(</span>
<span id="cb2061-2"><a href="stat-basics.html#cb2061-2"></a>  x, <span class="dt">n=</span><span class="kw">length</span>(x), <span class="dt">sigma=</span><span class="kw">sd</span>(x), <span class="dt">mu=</span><span class="dv">0</span>, </span>
<span id="cb2061-3"><a href="stat-basics.html#cb2061-3"></a>  <span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>){</span>
<span id="cb2061-4"><a href="stat-basics.html#cb2061-4"></a>  tstat &lt;-<span class="st"> </span>(<span class="kw">mean</span>(x) <span class="op">-</span><span class="st"> </span>mu) <span class="op">/</span><span class="st"> </span>(sigma <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n))</span>
<span id="cb2061-5"><a href="stat-basics.html#cb2061-5"></a>  <span class="cf">if</span>(alternative<span class="op">==</span><span class="st">&quot;two.sided&quot;</span>){   <span class="co"># 双侧检验</span></span>
<span id="cb2061-6"><a href="stat-basics.html#cb2061-6"></a>    pvalue &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pt</span>(<span class="kw">abs</span>(tstat), n<span class="dv">-1</span>))</span>
<span id="cb2061-7"><a href="stat-basics.html#cb2061-7"></a>  } <span class="cf">else</span> <span class="cf">if</span>(alternative<span class="op">==</span><span class="st">&quot;less&quot;</span>){ <span class="co"># 左侧检验</span></span>
<span id="cb2061-8"><a href="stat-basics.html#cb2061-8"></a>    pvalue &lt;-<span class="st"> </span><span class="kw">pt</span>(tstat, n<span class="dv">-1</span>)</span>
<span id="cb2061-9"><a href="stat-basics.html#cb2061-9"></a>  } <span class="cf">else</span> <span class="cf">if</span>(alternative<span class="op">==</span><span class="st">&quot;greater&quot;</span>){ <span class="co"># 右侧检验</span></span>
<span id="cb2061-10"><a href="stat-basics.html#cb2061-10"></a>    pvalue &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pt</span>(tstat, n<span class="dv">-1</span>)</span>
<span id="cb2061-11"><a href="stat-basics.html#cb2061-11"></a>  } <span class="cf">else</span> {</span>
<span id="cb2061-12"><a href="stat-basics.html#cb2061-12"></a>    <span class="kw">stop</span>(<span class="st">&quot;alternative unknown!&quot;</span>)</span>
<span id="cb2061-13"><a href="stat-basics.html#cb2061-13"></a>  }</span>
<span id="cb2061-14"><a href="stat-basics.html#cb2061-14"></a>  </span>
<span id="cb2061-15"><a href="stat-basics.html#cb2061-15"></a>  <span class="kw">c</span>(<span class="dt">stat=</span>tstat, <span class="dt">pvalue=</span>pvalue)</span>
<span id="cb2061-16"><a href="stat-basics.html#cb2061-16"></a>}</span></code></pre></div>
<p>这个函数允许输入<span class="math inline">\(\bar x\)</span>到<code>x</code>中，输入<span class="math inline">\(n\)</span>，输入<span class="math inline">\(S\)</span>到<code>sigma</code>中，
然后计算t检验。</p>
</div>
<div id="stat-base-hyptest-mu1d-sigmean" class="section level5">
<h5><span class="header-section-number">31.3.1.1.3</span> 统计假设检验显著性的解释</h5>
<p>统计假设检验如果拒绝了<span class="math inline">\(H_0\)</span>，
也称“结果显著”、“有显著差异”等。
这只代表样本与零假设的差距足够大，
可以以比较小的代价（第一类错误概率）
排除这样的差距是由于随机样本的随机性引起的，
但是并不表明这样的差距是有科学意义或者有现实意义的。</p>
<p>尤其是超大样本时，
完全没有实际意义的差距也会检验出来是统计显著的。</p>
<p>这时，可以设定一个“有实际意义的差距”<span class="math inline">\(\delta\)</span>，
当差距超过<span class="math inline">\(\delta\)</span>时才认为有实际差距，如：
<span class="math display">\[ 
H_0: |\mu - \mu_0| \leq \delta
\longleftrightarrow |\mu - \mu_0| &gt; \delta
\]</span></p>
<p>统计假设检验如果不拒绝<span class="math inline">\(H_0\)</span>，
也称为“结果不显著”、“没有显著差异”，
通常不认为<span class="math inline">\(H_0\)</span>就是对的，
看法是没有充分理由推翻<span class="math inline">\(H_0\)</span>。</p>
<p>进一步收集更多的数据，
有可能就会发现显著差异。</p>
<p>例如，<span class="math inline">\(H_0\)</span>是嫌疑人无罪，
最后不拒绝<span class="math inline">\(H_0\)</span>，
只能是没有充分证据证明有罪，
如果后来收集到了关键的罪证，
就还可以再判决嫌疑人有罪。</p>
</div>
<div id="stat-base-hyptest-mu1d-citest" class="section level5">
<h5><span class="header-section-number">31.3.1.1.4</span> 置信区间与双侧检验的关系</h5>
<p>设总体为正态分布<span class="math inline">\(\text{N}(\mu, \sigma^2)\)</span>,
<span class="math inline">\(\sigma\)</span>已知。
随机抽取了<span class="math inline">\(n\)</span>个样品，计算得<span class="math inline">\(\bar x\)</span>。
<span class="math inline">\(\mu\)</span>的<span class="math inline">\(1-\alpha\)</span>置信区间为
<span class="math display">\[ \bar x \pm z_{\alpha/2} \sigma/\sqrt{n} \]</span></p>
<p>置信区间理论依据：
<span class="math display">\[
P\left(\frac{|\bar x - \mu|}{\sigma/\sqrt{n}} 
  \leq z_{\alpha/2} \right) = 1 - \alpha \tag{*}
\]</span></p>
<p>对双侧检验
<span class="math display">\[ H_0: \mu = \mu_0 \longleftrightarrow H_a: \mu \neq \mu_0 \]</span>
当
<span class="math display">\[ \frac{|\bar x - \mu_0|}{\sigma/\sqrt{n}} \leq z_{\alpha/2}\]</span>
时接受<span class="math inline">\(H_0\)</span>。</p>
<p>接受<span class="math inline">\(H_0\)</span>的条件，就是<span class="math inline">\(\mu_0\)</span>满足(*)式的大括号中的条件，
即当且仅当<span class="math inline">\(\mu_0\)</span>落入<span class="math inline">\(\mu\)</span>的<span class="math inline">\(1-\alpha\)</span>置信区间时接受<span class="math inline">\(H_0\)</span>。</p>
<p>其它检验也与置信区间有类似关系，
但是单侧检验对应于单侧置信区间。</p>
</div>
<div id="stat-base-hyptest-mu1d-examples" class="section level5">
<h5><span class="header-section-number">31.3.1.1.5</span> 单样本均值比较例子</h5>
<p>载入假设检验部分示例程序所用数据：</p>
<div class="sourceCode" id="cb2062"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2062-1"><a href="stat-basics.html#cb2062-1"></a><span class="kw">load</span>(<span class="st">&quot;hyptest-data.RData&quot;</span>)</span></code></pre></div>
<div id="咖啡标重的单侧检验" class="section level6">
<h6><span class="header-section-number">31.3.1.1.5.1</span> 咖啡标重的单侧检验</h6>
<p>美国联邦贸易委员会定期检查商品标签是否与实际相符。
Hiltop Coffee大罐咖啡标签注明含量为3磅。
每罐具体多一些或少一些并不要紧，
只要总体平均值不少于3磅，
消费者利益就未受侵害。</p>
<p>只有在有充分证据时才应该做出分量不够的判决进而对厂家进行处罚。
所以零假设是<span class="math inline">\(H_0: \mu \geq 3\)</span>，
对立假设是<span class="math inline">\(H_a: \mu &lt; 3\)</span>。</p>
<p>收集数据进行统计判决后，
如果不拒绝<span class="math inline">\(H_0\)</span>，
就不需要采取行动；
如果拒绝了<span class="math inline">\(H_0\)</span>，
就说明有足够证据认为厂商灌装分量不足，
应进行处罚。</p>
<p>随机抽取了36件样品，
计算平均净重<span class="math inline">\(\bar x\)</span>作为总体均值<span class="math inline">\(\mu\)</span>的估计。</p>
<p>如果<span class="math inline">\(\bar x &lt; 3\)</span>，
则<span class="math inline">\(H_0\)</span>有理由被怀疑。</p>
<p><span class="math inline">\(\bar x\)</span>比<span class="math inline">\(\mu_0 = 3\)</span>少多少，
才让我们愿意拒绝<span class="math inline">\(H_0\)</span>?
做出拒绝<span class="math inline">\(H_0\)</span>的决定可能会犯第一类错误，
如果差距很小，
这样的差距很可能是随机抽样的随机性引起的，
拒绝<span class="math inline">\(H_0\)</span>有很大的机会犯错。</p>
<p>必须先确定一个能够容忍的第一类错误概率。
调查员认为，可以容忍1%的错误拒绝<span class="math inline">\(H_0\)</span>的机会
（不该处罚时给出了处罚）
以换得能够在厂商分量不足时正确地做出处罚决定的机会。
即选检验水平<span class="math inline">\(\alpha=0.01\)</span>。</p>
<p>当<span class="math inline">\(H_0\)</span>实际成立时，
边界<span class="math inline">\(\mu=\mu_0=3\)</span>处犯第一类错误的概率最大
（这里最不容易区分），
所以计算第一类错误概率只要在边界处计算。</p>
<p>统计假设检验第一步是确定零假设与对立假设，
第二步是确定检验水平<span class="math inline">\(\alpha\)</span>。
第三步是抽取随机样本，计算检验统计量。</p>
<p>以往经验证明净重的标准差是<span class="math inline">\(\sigma=0.18\)</span>，
且净重的分布为正态分布。</p>
<p>则<span class="math inline">\(\bar x\)</span>的抽样分布为<span class="math inline">\(\text{N}(\mu, \sigma^2/n)\)</span>，
<span class="math inline">\(\bar x\)</span>的标准误差为<span class="math inline">\(\text{SE}(\bar x) = 0.18 / \sqrt{36} = 0.03\)</span>。</p>
<p>令
<span class="math display">\[ z = \frac{\bar x - \mu_0}{\text{SE}(\bar x)} \]</span>
则<span class="math inline">\(H_0\)</span>成立且<span class="math inline">\(\mu\)</span>取边界处的<span class="math inline">\(\mu_0\)</span>时<span class="math inline">\(z \sim \text{N}(0,1)\)</span>。</p>
<p>当<span class="math inline">\(\bar x\)</span>比<span class="math inline">\(\mu_0=3\)</span>小很多时应拒绝<span class="math inline">\(H_0\)</span>。
即检验统计量<span class="math inline">\(z\)</span>很小时拒绝<span class="math inline">\(H_0\)</span>。</p>
<p>如果<span class="math inline">\(z = -1\)</span>，
标准正态分布取-1或比-1更小的值的概率是0.1586
(用R程序<code>pnorm(-1)</code>计算)，
这个概率不小，
不小于<span class="math inline">\(\alpha=0.01\)</span>，
这时不应该拒绝<span class="math inline">\(H_0\)</span>。</p>
<p>如果<span class="math inline">\(z = -2\)</span>，
标准正态分布取-2或比-2更小的值的概率是0.0228，
(用R程序<code>pnorm(-2)</code>计算)，
这个概率已经比较小了，
但还不小于预先确定的第一类错误概率<span class="math inline">\(\alpha=0.01\)</span>，
这时不应该拒绝<span class="math inline">\(H_0\)</span>。</p>
<p>如果<span class="math inline">\(z = -3\)</span>，
标准正态分布取-3或比-3更小的值的概率是0.0013，
(用R程序<code>pnorm(-3)</code>计算)，
这个概率已经很小了，
也小于预先确定的第一类错误概率<span class="math inline">\(\alpha=0.01\)</span>，
这时应该拒绝<span class="math inline">\(H_0\)</span>。</p>
<p>对左侧检验问题<span class="math inline">\(H_0: \mu \geq \mu_0 \longleftrightarrow H_a: \mu &lt; \mu_0\)</span>,
若<span class="math inline">\(Z\)</span>表示标准正态分布随机变量，
<span class="math inline">\(z\)</span>是检验统计量的值，在<span class="math inline">\(\mu=\mu_0\)</span>时<span class="math inline">\(z\)</span>的抽样分布是标准正态分布，
可以计算抽样分布中取到等于<span class="math inline">\(z\)</span>以及比<span class="math inline">\(z\)</span>更小的值的概率<span class="math inline">\(P(Z \leq z)\)</span>，
称为检验的p值。</p>
<p>p值越小，说明<span class="math inline">\(\bar x\)</span>比<span class="math inline">\(\mu_0\)</span>小得越多，
拒绝<span class="math inline">\(H_0\)</span>也越有充分证据。
当且仅当p值小于检验水平<span class="math inline">\(\alpha\)</span>时拒绝<span class="math inline">\(H_0\)</span>。</p>
<p>p值小于<span class="math inline">\(\alpha\)</span>，说明如果<span class="math inline">\(H_0\)</span>真的成立，
出现<span class="math inline">\(\bar x\)</span>那么小的检验统计量值的概率也很小，
小于<span class="math inline">\(\alpha\)</span>，所以第一类错误概率小于等于<span class="math inline">\(\alpha\)</span>。</p>
<p>一般地，p值是从样本计算的一个在假定零假设成立情况下，
检验统计量取值更倾向于对立假设成立的概率。
p值越小，拒绝<span class="math inline">\(H_0\)</span>越有依据。</p>
<p>设咖啡标称重量问题中抽取了36件样品，测得<span class="math inline">\(\bar x = 2.92\)</span>磅，
计算得
<span class="math display">\[ z = \frac{\bar x - \mu_0}{\sigma/\sqrt{n}}
= \frac{2.92 - 3}{0.18/\sqrt{36}} = -2.67 \]</span></p>
<p>p值为<span class="math inline">\(P(Z \leq -2.67)\)</span>(<span class="math inline">\(Z\)</span>是标准正态分布随机变量)，
用R计算得<code>pnorm(-2.67)</code><span class="math inline">\(=0.0038 \leq \alpha=0.01\)</span>，
拒绝<span class="math inline">\(H_0\)</span>，
应对该厂商进行处罚。</p>
<p>已经预先确定了检验水平<span class="math inline">\(\alpha=0.01\)</span>就不能在看到检验结果后更改检验水平。
但是，
报告出p值后，
其他的人可以利用这样的信息，
不同的人或利益方可能有不同的检验水平的选择，
这通过同一个p值都可以给出需要的结果。</p>
<p>p值也称为“<strong>观测显著性水平</strong>”，
因为它是能够拒绝<span class="math inline">\(H_0\)</span>的最小的可选检验水平，
选取比p值更小的检验水平就不能拒绝<span class="math inline">\(H_0\)</span>了。</p>
<p>用自定义的<code>z.test.1s()</code>计算：</p>
<div class="sourceCode" id="cb2063"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2063-1"><a href="stat-basics.html#cb2063-1"></a><span class="kw">z.test.1s</span>(<span class="dt">x=</span><span class="fl">2.92</span>, <span class="dt">mu=</span><span class="dv">3</span>, <span class="dt">n=</span><span class="dv">36</span>, <span class="dt">sigma=</span><span class="fl">0.18</span>, <span class="dt">alternative=</span><span class="st">&quot;less&quot;</span>)</span></code></pre></div>
<pre><code>##         stat       pvalue 
## -2.666666667  0.003830381</code></pre>
<p>p值为0.004，在0.01水平下拒绝原假设，
认为咖啡平均重量显著地低于标称的3磅。</p>
<p>设<code>Coffee</code>数据框的<code>Weight</code>是这36个样本值，
也可以将程序写成：</p>
<div class="sourceCode" id="cb2065"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2065-1"><a href="stat-basics.html#cb2065-1"></a><span class="kw">z.test.1s</span>(Coffee[[<span class="st">&quot;Weight&quot;</span>]], <span class="dt">mu=</span><span class="dv">3</span>, <span class="dt">sigma=</span><span class="fl">0.18</span>, <span class="dt">alternative=</span><span class="st">&quot;less&quot;</span>)</span></code></pre></div>
<pre><code>##         stat       pvalue 
## -2.666666667  0.003830381</code></pre>
<p>或</p>
<div class="sourceCode" id="cb2067"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2067-1"><a href="stat-basics.html#cb2067-1"></a>BSDA<span class="op">::</span><span class="kw">z.test</span>(Coffee[[<span class="st">&quot;Weight&quot;</span>]], <span class="dt">mu=</span><span class="dv">3</span>, <span class="dt">sigma.x=</span><span class="fl">0.18</span>, <span class="dt">alternative=</span><span class="st">&quot;less&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  One-sample z-Test
## 
## data:  Coffee[[&quot;Weight&quot;]]
## z = -2.6667, p-value = 0.00383
## alternative hypothesis: true mean is less than 3
## 95 percent confidence interval:
##        NA 2.969346
## sample estimates:
## mean of x 
##      2.92</code></pre>
</div>
<div id="例高尔夫球性能的双侧检验" class="section level6">
<h6><span class="header-section-number">31.3.1.1.5.2</span> 例：高尔夫球性能的双侧检验</h6>
<p>美国高尔夫协会对高尔夫运动器械有一系列的规定。
MaxFlight生产高品质的高尔夫球，
平均的飞行距离是295码。</p>
<p>生产线有时会有波动，
当生产的球平均飞行距离不足295码时，
用户会感觉不好用；
当生产的球平均飞行距离超过295码时，
美国高尔夫协会禁止使用这样的球。</p>
<p>该厂商定期抽检生产线上下来的产品，
每次抽取50只。</p>
<p>当平均飞行距离与295码没有显著差距时，
不需要采取措施；
如果有显著差距，就需要调整生产线。</p>
<p>所以取<span class="math inline">\(H_0: \mu = 295\)</span>,
<span class="math inline">\(H_a: \mu \neq 295\)</span>。
选检验水平<span class="math inline">\(\alpha=0.05\)</span>。</p>
<p>随机抽取<span class="math inline">\(n\)</span>个样品，
在可控条件下测试出每个的飞行距离，
计算出平均值<span class="math inline">\(\bar x\)</span>。</p>
<p>当<span class="math inline">\(\bar x\)</span>比<span class="math inline">\(\mu_0\)</span>(这里是295)小很多或者
<span class="math inline">\(\bar x\)</span>比<span class="math inline">\(\mu_0\)</span>大很多时拒绝<span class="math inline">\(H_0\)</span>，
否则不拒绝<span class="math inline">\(H_0\)</span>。</p>
<p>设已知总体标准差<span class="math inline">\(\sigma=12\)</span>,
且飞行距离服从正态分布。</p>
<p>取统计量
<span class="math display">\[z = \frac{\bar x - \mu_0}{\sigma/\sqrt{n}}\]</span>
在<span class="math inline">\(H_0\)</span>成立时，
<span class="math inline">\(z\)</span>的抽样分布为标准正态分布。</p>
<ul>
<li>设测得<span class="math inline">\(\bar x = 297.6\)</span>，超过了<span class="math inline">\(\mu_0=295\)</span>。</li>
</ul>
<p><span class="math display">\[
z = = \frac{\bar x - \mu_0}{\sigma/\sqrt{n}}
= \frac{297.6 - 295}{12/\sqrt{50}} = 1.53 
\]</span></p>
<p><span class="math inline">\(H_0\)</span>成立时<span class="math inline">\(z\)</span>抽样分布为标准正态分布，
设<span class="math inline">\(Z\)</span>是标准正态分布随机变量，
<span class="math inline">\(Z\)</span>取到1.53或者比1.53更倾向于反对<span class="math inline">\(H_0\)</span>的值概率？
这包括<span class="math inline">\(P(Z \geq 1.53)\)</span>，
还应包括<span class="math inline">\(P(Z \leq -1.53)\)</span>。</p>
<p>所以p值是<span class="math inline">\(P(|Z| \geq |z|)\)</span>，
R中计算为<code>2*(1 - pnorm(abs(z)))</code>。
p值等于0.1260，
超过检验水平，
不拒绝<span class="math inline">\(H_0\)</span>，
不需要调整生产线。</p>
<p>用自定义的<code>z.test.1s()</code>检验：</p>
<div class="sourceCode" id="cb2069"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2069-1"><a href="stat-basics.html#cb2069-1"></a><span class="kw">z.test.1s</span>(GolfTest[[<span class="st">&#39;Yards&#39;</span>]], <span class="dt">mu=</span><span class="dv">295</span>, <span class="dt">sigma=</span><span class="dv">12</span>, <span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<pre><code>##      stat    pvalue 
## 1.5320647 0.1255065</code></pre>
<p>或用<code>BSDA::z.test()</code>:</p>
<div class="sourceCode" id="cb2071"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2071-1"><a href="stat-basics.html#cb2071-1"></a>BSDA<span class="op">::</span><span class="kw">z.test</span>(GolfTest[[<span class="st">&#39;Yards&#39;</span>]], <span class="dt">mu=</span><span class="dv">295</span>, <span class="dt">sigma.x=</span><span class="dv">12</span>, <span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  One-sample z-Test
## 
## data:  GolfTest[[&quot;Yards&quot;]]
## z = 1.5321, p-value = 0.1255
## alternative hypothesis: true mean is not equal to 295
## 95 percent confidence interval:
##  294.2738 300.9262
## sample estimates:
## mean of x 
##     297.6</code></pre>
<p>p值为0.13，在0.05水平下不拒绝<span class="math inline">\(H_0\)</span>，
生产的球的平均飞行距离与标准的295码之间没有显著差异。</p>
</div>
<div id="heathrow机场打分的检验" class="section level6">
<h6><span class="header-section-number">31.3.1.1.5.3</span> Heathrow机场打分的检验</h6>
<p>某旅行杂志希望根据乘机进行商务旅行的意见给跨大西洋门户机场评分。
乘客评分取0到10分，超过7分算作是服务一流的机场。
在每个机场随机选取60位商务旅行乘客打分评价。
英国Heathrow机场的打分样本<span class="math inline">\(\bar x = 7.25\)</span>, <span class="math inline">\(S = 1.052\)</span>。
英国Heathrow机场可以算是服务一流吗？</p>
<p>由于随机样本的随机性，
要判断的是<span class="math inline">\(\mu &gt; 7\)</span>是否成立，
这里<span class="math inline">\(\bar x = 7.25\)</span>并不能很确定第说<span class="math inline">\(\mu &gt; 7\)</span>成立。</p>
<p>因为将机场评为一流需要有充分证据，
所以将对立假设<span class="math inline">\(H_a\)</span>设为<span class="math inline">\(\mu &gt; 7\)</span>，
然后取<span class="math inline">\(H_0: \mu \leq 7\)</span>。</p>
<p>取检验水平<span class="math inline">\(\alpha=0.05\)</span>。</p>
<p>计算检验统计量
<span class="math display">\[
t = \frac{\bar x - \mu_0}{S / \sqrt{n}} 
  = \frac{7.25 - 7}{1.052/\sqrt{60}} = 1.84
\]</span>
设<span class="math inline">\(T\)</span>是服从<span class="math inline">\(t(n-1)\)</span>分布的随机变量，
p值为<span class="math inline">\(P(T \geq 1.84)\)</span>。
用R软件计算为<code>1 - pt(1.84, 60-1)</code><span class="math inline">\(=0.0354\)</span>。
p值小于<span class="math inline">\(\alpha\)</span>，拒绝<span class="math inline">\(H_0\)</span>，
认为平均评分显著高于7，
可以认为Heathrow机场是服务一流。</p>
<p>从原始样本数据用<code>t.test()</code>检验：</p>
<div class="sourceCode" id="cb2073"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2073-1"><a href="stat-basics.html#cb2073-1"></a><span class="kw">t.test</span>(AirRating[[<span class="st">&quot;Rating&quot;</span>]], <span class="dt">mu=</span><span class="dv">7</span>, <span class="dt">alternative=</span><span class="st">&quot;greater&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  AirRating[[&quot;Rating&quot;]]
## t = 1.8414, df = 59, p-value = 0.03529
## alternative hypothesis: true mean is greater than 7
## 95 percent confidence interval:
##  7.023124      Inf
## sample estimates:
## mean of x 
##      7.25</code></pre>
<p>用自定义的<code>t.test.1s()</code>和样本统计量计算：</p>
<div class="sourceCode" id="cb2075"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2075-1"><a href="stat-basics.html#cb2075-1"></a><span class="kw">t.test.1s</span>(<span class="dt">x=</span><span class="fl">7.25</span>, <span class="dt">sigma=</span><span class="fl">1.052</span>, <span class="dt">n=</span><span class="dv">60</span>, <span class="dt">mu=</span><span class="dv">7</span>, <span class="dt">alternative=</span><span class="st">&quot;greater&quot;</span>)</span></code></pre></div>
<pre><code>##       stat     pvalue 
## 1.84077155 0.03534255</code></pre>
</div>
<div id="玩具厂商订货量的假设检验" class="section level6">
<h6><span class="header-section-number">31.3.1.1.5.4</span> 玩具厂商订货量的假设检验</h6>
<p>玩具厂商Holiday Toys通过超过1000家玩具商店售货。
为了准备即将到来的冬季销售季节，
销售主管需要确定今年某新款玩具的生产量。
凭经验判断平均每家商店需要40件。</p>
<p>为了确定，随机抽取了25家商店，
提供了新款玩具的特点、进货价和建议销售价，
让他们给出订货量估计。
目的是判断按每家40件来生产是否合适。</p>
<p>因为多生产或少生产都不合适，
所以取零假设为<span class="math inline">\(H_0: \mu=40\)</span>。
对立假设为<span class="math inline">\(H_a: \mu \neq 40\)</span>。
只有拒绝<span class="math inline">\(H_0\)</span>时才需要更改生产计划。</p>
<p>取检验水平<span class="math inline">\(\alpha=0.05\)</span>。
样本计算得<span class="math inline">\(n=25\)</span>，<span class="math inline">\(\bar x = 37.4\)</span>, <span class="math inline">\(S = 11.79\)</span>。</p>
<p>检验统计量
<span class="math display">\[ 
t = \frac{\bar x - \mu_0}{S / \sqrt{n}} 
  = \frac{37.4 - 40}{11.79 / \sqrt{25}} = -1.10
\]</span></p>
<p>设<span class="math inline">\(T\)</span>为服从t<span class="math inline">\((n-1)\)</span>分布的随机变量，
p值为<span class="math inline">\(2 P(|T| &gt; |-1.10|)\)</span>，
用R计算为<code>2*(1 - pt(abs(-1.10), 25-1))</code><span class="math inline">\(=0.2822\)</span>。</p>
<p>不拒绝<span class="math inline">\(H_0\)</span>，所以不需要更改生产计划。</p>
<p>从原始样本数据用<code>t.test()</code>检验：</p>
<div class="sourceCode" id="cb2077"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2077-1"><a href="stat-basics.html#cb2077-1"></a><span class="kw">t.test</span>(Orders[[<span class="st">&quot;Units&quot;</span>]], <span class="dt">mu=</span><span class="dv">40</span>, <span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  Orders[[&quot;Units&quot;]]
## t = -1.1026, df = 24, p-value = 0.2811
## alternative hypothesis: true mean is not equal to 40
## 95 percent confidence interval:
##  32.5334 42.2666
## sample estimates:
## mean of x 
##      37.4</code></pre>
<p>用自定义的<code>t.test.1s()</code>和样本统计量计算：</p>
<div class="sourceCode" id="cb2079"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2079-1"><a href="stat-basics.html#cb2079-1"></a><span class="kw">t.test.1s</span>(<span class="dt">x=</span><span class="fl">37.4</span>, <span class="dt">sigma=</span><span class="fl">11.79</span>, <span class="dt">n=</span><span class="dv">25</span>, <span class="dt">mu=</span><span class="dv">40</span>, <span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<pre><code>##       stat     pvalue 
## -1.1026293  0.2811226</code></pre>
</div>
</div>
</div>
<div id="stat-base-hyptest-mu2d" class="section level4">
<h4><span class="header-section-number">31.3.1.2</span> 均值比较</h4>
<div id="独立两样本z检验" class="section level5">
<h5><span class="header-section-number">31.3.1.2.1</span> 独立两样本Z检验</h5>
<p>假设有两个独立的总体<span class="math inline">\(X, Y\)</span>，例如，男性与女性的寿命。
要比较两个总体的期望<span class="math inline">\(\mu_1=EX\)</span>和<span class="math inline">\(\mu_2=EY\)</span>。
设两个总体的方差分别为<span class="math inline">\(\sigma_1^2\)</span>和<span class="math inline">\(\sigma_2^2\)</span>。
可以对均值作双侧、左侧、右侧检验。
比如，双侧检验为
<span class="math display">\[
H_0: \mu_1 = \mu_2 \longleftrightarrow H_a: \mu_1 \neq \mu_2
\]</span></p>
<p>如果两个总体都服从正态分布，
而且分别的方差<span class="math inline">\(\sigma_1^2\)</span>和<span class="math inline">\(\sigma_2^2\)</span>已知，
设<span class="math inline">\(X\)</span>的样本量为<span class="math inline">\(n_1\)</span>的样本得到样本均值<span class="math inline">\(\bar x\)</span>，
设<span class="math inline">\(Y\)</span>的样本量为<span class="math inline">\(n_2\)</span>的样本得到样本均值<span class="math inline">\(\bar y\)</span>，
取统计量
<span class="math display">\[
Z = \frac{\bar x - \bar y}
{\sqrt{\frac{\sigma_1^2}{n_1} + \frac{\sigma_2^2}{n_2}}}
\]</span>
其中分母是分子的标准误差。
当<span class="math inline">\(\mu_1 = \mu_2\)</span>时<span class="math inline">\(Z \sim \text{N}(0,1)\)</span>。</p>
<p>如果分布不一定是正态分布但是样本量足够大，
可以令
<span class="math display">\[
Z = \frac{\bar x - \bar y}
{\sqrt{\frac{S_x^2}{n_1} + \frac{S_y^2}{n_2}}}
\]</span>
当<span class="math inline">\(\mu_1 = \mu_2\)</span>时<span class="math inline">\(Z\)</span>近似服从<span class="math inline">\(\text{N}(0,1)\)</span>。</p>
<p>检验问题还可以变成<span class="math inline">\(\mu_1 - \mu_2\)</span>与某个<span class="math inline">\(\delta\)</span>的比较，如
<span class="math display">\[
H_0: \mu_1 \leq \mu_2 - \delta \longleftrightarrow H_a: \mu_1 &gt; \mu_2 - \delta
\]</span>
这个对立假设是“不次于”的结论。</p>
<p>可以写一个大样本方差未知或已知，
小样本独立两正态总体方差已知情况做Z检验的R函数：</p>
<div class="sourceCode" id="cb2081"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2081-1"><a href="stat-basics.html#cb2081-1"></a>z.test<span class="fl">.2</span>s &lt;-<span class="st"> </span><span class="cf">function</span>(</span>
<span id="cb2081-2"><a href="stat-basics.html#cb2081-2"></a>  x, y, <span class="dt">n1=</span><span class="kw">length</span>(x), <span class="dt">n2=</span><span class="kw">length</span>(y), <span class="dt">delta=</span><span class="dv">0</span>,</span>
<span id="cb2081-3"><a href="stat-basics.html#cb2081-3"></a>  <span class="dt">sigma1=</span><span class="kw">sd</span>(x), <span class="dt">sigma2=</span><span class="kw">sd</span>(y), <span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>){</span>
<span id="cb2081-4"><a href="stat-basics.html#cb2081-4"></a>  z &lt;-<span class="st"> </span>(<span class="kw">mean</span>(x) <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y) <span class="op">-</span><span class="st"> </span>delta) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(sigma1<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>sigma2<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>n2)</span>
<span id="cb2081-5"><a href="stat-basics.html#cb2081-5"></a>  <span class="cf">if</span>(alternative<span class="op">==</span><span class="st">&quot;two.sided&quot;</span>){   <span class="co"># 双侧检验</span></span>
<span id="cb2081-6"><a href="stat-basics.html#cb2081-6"></a>    pvalue &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(<span class="kw">abs</span>(z)))</span>
<span id="cb2081-7"><a href="stat-basics.html#cb2081-7"></a>  } <span class="cf">else</span> <span class="cf">if</span>(alternative<span class="op">==</span><span class="st">&quot;less&quot;</span>){ <span class="co"># 左侧检验</span></span>
<span id="cb2081-8"><a href="stat-basics.html#cb2081-8"></a>    pvalue &lt;-<span class="st"> </span><span class="kw">pnorm</span>(z)</span>
<span id="cb2081-9"><a href="stat-basics.html#cb2081-9"></a>  } <span class="cf">else</span> <span class="cf">if</span>(alternative<span class="op">==</span><span class="st">&quot;greater&quot;</span>){ <span class="co"># 右侧检验</span></span>
<span id="cb2081-10"><a href="stat-basics.html#cb2081-10"></a>    pvalue &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(z)</span>
<span id="cb2081-11"><a href="stat-basics.html#cb2081-11"></a>  } <span class="cf">else</span> {</span>
<span id="cb2081-12"><a href="stat-basics.html#cb2081-12"></a>    <span class="kw">stop</span>(<span class="st">&quot;alternative unknown!&quot;</span>)</span>
<span id="cb2081-13"><a href="stat-basics.html#cb2081-13"></a>  }</span>
<span id="cb2081-14"><a href="stat-basics.html#cb2081-14"></a>  </span>
<span id="cb2081-15"><a href="stat-basics.html#cb2081-15"></a>  <span class="kw">c</span>(<span class="dt">stat=</span>z, <span class="dt">pvalue=</span>pvalue)</span>
<span id="cb2081-16"><a href="stat-basics.html#cb2081-16"></a>}</span></code></pre></div>
<p>函数允许输入两组样本到<code>x</code>和<code>y</code>中，
输入<span class="math inline">\(\sigma_1\)</span>和<span class="math inline">\(\sigma_2\)</span>到<code>sigma1</code>和<code>sigma2</code>中，
这时不输入<code>sigma1</code>和<code>sigma2</code>则从样本中计算样本统计量代替。
也允许输入<span class="math inline">\(\bar x\)</span>和<span class="math inline">\(\bar y\)</span>到<code>x</code>和<code>y</code>中，
输入<span class="math inline">\(\sigma_1\)</span>和<span class="math inline">\(\sigma_2\)</span>到<code>sigma1</code>和<code>sigma2</code>中，
或者输入<code>S_x$和$S_y$到</code>sigma1<code>和</code>sigma2<code>中， 输入$n_1$到</code>n1<code>中， 输入$n_2$到</code>n2`中，
计算独立两样本均值比较的<span class="math inline">\(Z\)</span>检验。</p>
</div>
<div id="独立两样本t检验" class="section level5">
<h5><span class="header-section-number">31.3.1.2.2</span> 独立两样本t检验</h5>
<p>如果样本是小样本，但两个总体分别服从正态分布，
两个总体的方差未知，
但已知<span class="math inline">\(\sigma_1^2 = \sigma_2^2\)</span>。
这时<span class="math inline">\(\sigma_1^2 = \sigma_2^2\)</span>可以统一估计为
<span class="math display">\[
S_p^2 = \frac{1}{n_1 + n_2 - 2}\left( (n_1 - 1)S_x^2 + (n_2 - 1)S_y^2 \right)
\]</span>
取检验统计量
<span class="math display">\[
T = \frac{\bar x - \bar y}{S_p \sqrt{\frac{1}{n_1} + \frac{1}{n_2}}}
\]</span>
当<span class="math inline">\(\mu_1 = \mu_2\)</span>时<span class="math inline">\(T \sim \text{t}(n_1 + n_2 - 2)\)</span>。</p>
<p>当<code>x</code>和<code>y</code>存放了两组独立样本时，
可以用<code>t.test(x, y, var.equal=TRUE)</code>计算两样本t检验，
用<code>alternative=</code>选项指定双侧、右侧、左侧检验。</p>
<p>可以自己写一个这样的R函数作两样本t检验，
允许只输入统计量而非具体样本值：</p>
<div class="sourceCode" id="cb2082"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2082-1"><a href="stat-basics.html#cb2082-1"></a>t.test<span class="fl">.2</span>s &lt;-<span class="st"> </span><span class="cf">function</span>(</span>
<span id="cb2082-2"><a href="stat-basics.html#cb2082-2"></a>  x, y, <span class="dt">n1=</span><span class="kw">length</span>(x), <span class="dt">n2=</span><span class="kw">length</span>(y),</span>
<span id="cb2082-3"><a href="stat-basics.html#cb2082-3"></a>  <span class="dt">sigma1=</span><span class="kw">sd</span>(x), <span class="dt">sigma2=</span><span class="kw">sd</span>(y), <span class="dt">delta=</span><span class="dv">0</span>,</span>
<span id="cb2082-4"><a href="stat-basics.html#cb2082-4"></a>  <span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>){</span>
<span id="cb2082-5"><a href="stat-basics.html#cb2082-5"></a>  sp &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">/</span>(n1<span class="op">+</span>n2<span class="dv">-2</span>) <span class="op">*</span><span class="st"> </span>((n1<span class="dv">-1</span>)<span class="op">*</span>sigma1<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>(n2<span class="dv">-1</span>)<span class="op">*</span>sigma2<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb2082-6"><a href="stat-basics.html#cb2082-6"></a>  t &lt;-<span class="st"> </span>(<span class="kw">mean</span>(x) <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y) <span class="op">-</span><span class="st"> </span>delta) <span class="op">/</span><span class="st"> </span>(sp <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>n2))</span>
<span id="cb2082-7"><a href="stat-basics.html#cb2082-7"></a>  <span class="cf">if</span>(alternative<span class="op">==</span><span class="st">&quot;two.sided&quot;</span>){   <span class="co"># 双侧检验</span></span>
<span id="cb2082-8"><a href="stat-basics.html#cb2082-8"></a>    pvalue &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pt</span>(<span class="kw">abs</span>(t), n1<span class="op">+</span>n2<span class="dv">-2</span>))</span>
<span id="cb2082-9"><a href="stat-basics.html#cb2082-9"></a>  } <span class="cf">else</span> <span class="cf">if</span>(alternative<span class="op">==</span><span class="st">&quot;less&quot;</span>){ <span class="co"># 左侧检验</span></span>
<span id="cb2082-10"><a href="stat-basics.html#cb2082-10"></a>    pvalue &lt;-<span class="st"> </span><span class="kw">pt</span>(t, n1<span class="op">+</span>n2<span class="dv">-2</span>)</span>
<span id="cb2082-11"><a href="stat-basics.html#cb2082-11"></a>  } <span class="cf">else</span> <span class="cf">if</span>(alternative<span class="op">==</span><span class="st">&quot;greater&quot;</span>){ <span class="co"># 右侧检验</span></span>
<span id="cb2082-12"><a href="stat-basics.html#cb2082-12"></a>    pvalue &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pt</span>(t, n1<span class="op">+</span>n2<span class="dv">-2</span>)</span>
<span id="cb2082-13"><a href="stat-basics.html#cb2082-13"></a>  } <span class="cf">else</span> {</span>
<span id="cb2082-14"><a href="stat-basics.html#cb2082-14"></a>    <span class="kw">stop</span>(<span class="st">&quot;alternative unknown!&quot;</span>)</span>
<span id="cb2082-15"><a href="stat-basics.html#cb2082-15"></a>  }</span>
<span id="cb2082-16"><a href="stat-basics.html#cb2082-16"></a>  </span>
<span id="cb2082-17"><a href="stat-basics.html#cb2082-17"></a>  <span class="kw">c</span>(<span class="dt">stat=</span>t, <span class="dt">pvalue=</span>pvalue)</span>
<span id="cb2082-18"><a href="stat-basics.html#cb2082-18"></a>}</span></code></pre></div>
<p>如果两个独立正态总体的方差不相等，样本量不够大，
可以用如下的在<span class="math inline">\(H_0\)</span>下近似服从t分布的检验统计量：
<span class="math display">\[
T = \frac{\bar x - \bar y}{\sqrt{ \frac{S_x^2}{n_1} + \frac{S_y^2}{n_2} }}
\]</span>
自由度为
<span class="math display">\[
m = \frac{\left( S_x^2 / n_1 + S_y^2 / n_2 \right)^2}
  { \frac{\left( S_x^2 / n_1\right)^2}{n_1 - 1} 
  + \frac{\left(S_y^2 / n_2 \right)^2}{n_2 - 1} }
\]</span>
这个检验称为Welch两样本t检验，或Satterthwaite 两样本t检验
当<code>x</code>和<code>y</code>存放了两组独立样本时，
可以用<code>t.test(x, y, var.equal=FALSE)</code>计算Welch两样本t检验。</p>
<p>如果方差是否相等不易判断，
可以直接选用Welch检验。</p>
<p>因为大样本时t分布与标准正态分布基本相同，
所以非正态总体大样本Z检验也可以用<code>t.test()</code>计算。</p>
</div>
<div id="成对均值比较问题" class="section level5">
<h5><span class="header-section-number">31.3.1.2.3</span> 成对均值比较问题</h5>
<p>设总体包含两个<span class="math inline">\(X, Y\)</span>分量，
比如，
一组病人的服药前血压与服药后血压。
这两个变量是相关的，
不能用独立两总体的均值比较方法比较<span class="math inline">\(\mu_1=EX\)</span>与<span class="math inline">\(\mu_2=EY\)</span>。</p>
<p>若<span class="math inline">\(\xi = X - Y\)</span>服从正态分布，
则可以对<span class="math inline">\(\xi\)</span>进行均值为零的单样本t检验。
这样的检验称为成对均值的t检验。</p>
<p>若<code>x</code>和<code>y</code>分别为<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>的样本值，
可以用<code>t.test(x, y, paired=TRUE)</code>计算计算成对均值t检验。</p>
</div>
<div id="均值比较的例子" class="section level5">
<h5><span class="header-section-number">31.3.1.2.4</span> 均值比较的例子</h5>
<div id="顾客平均年龄差别比较" class="section level6">
<h6><span class="header-section-number">31.3.1.2.4.1</span> 顾客平均年龄差别比较</h6>
<p>HomeStyle是一个连锁家具店，
两家分店一个在城区，一个在郊区。
经理发现同一种家具有可能在一个分店卖的很好，
另一个分店则不好。
怀疑是顾客人群的人口学差异（年龄、性别、种族等）。</p>
<p>独立地抽取两个分店的顾客样本，比较平均年龄。
设城内的分店顾客年龄<span class="math inline">\(\sigma_1=9\)</span>已知，
郊区的分店顾客年龄<span class="math inline">\(\sigma_2=10\)</span>已知。</p>
<p>城内调查了<span class="math inline">\(n_1=36\)</span>位顾客，年龄的样本平均值<span class="math inline">\(\bar x=40\)</span>;
郊区调查了<span class="math inline">\(n_2=49\)</span>位顾客，年龄的样本平均值<span class="math inline">\(\bar y=35\)</span>。
<span class="math inline">\(\bar x - \bar y = 5\)</span>。</p>
<p>作双侧检验，水平<span class="math inline">\(\alpha=0.05\)</span>。</p>
<p>计算<span class="math inline">\(Z\)</span>统计量：
<span class="math display">\[
Z = \frac{40 - 35}{\sqrt{ \frac{9^2}{36} + \frac{10^2}{49} }} = 2.4138 
\]</span></p>
<p>p值为<span class="math inline">\(P(|V| \geq |2.4138|)\)</span>，其中<span class="math inline">\(V\)</span>为标准正态分布随机变量。
用R计算为<code>2*(1 - pnorm(abs(2.4138)))</code>=0.016，
两个分店的顾客年龄有显著差异，
城里的顾客平均年龄显著地高。</p>
<p>基于样本统计量用自定义的<code>z.test.2s()</code>计算：</p>
<div class="sourceCode" id="cb2083"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2083-1"><a href="stat-basics.html#cb2083-1"></a><span class="kw">z.test.2s</span>(<span class="dt">n1=</span><span class="dv">36</span>, <span class="dt">x=</span><span class="dv">40</span>, <span class="dt">sigma1=</span><span class="dv">9</span>, </span>
<span id="cb2083-2"><a href="stat-basics.html#cb2083-2"></a>          <span class="dt">n2=</span><span class="dv">49</span>, <span class="dt">y=</span><span class="dv">35</span>, <span class="dt">sigma2=</span><span class="dv">10</span>,</span>
<span id="cb2083-3"><a href="stat-basics.html#cb2083-3"></a>          <span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<pre><code>##       stat     pvalue 
## 2.41379310 0.01578742</code></pre>
</div>
<div id="两个银行营业所顾客平均存款比较" class="section level6">
<h6><span class="header-section-number">31.3.1.2.4.2</span> 两个银行营业所顾客平均存款比较</h6>
<p>某银行要比较两个营业所的支票账户的平均存款额。
作双侧检验，水平0.05。没有方差信息时可以直接选用Welch检验。</p>
<p>设第一个营业所随机抽查了<span class="math inline">\(n_1=28\)</span>个支票账户，
均值为<span class="math inline">\(\bar x=1025\)</span>(美元)，样本标准差为<span class="math inline">\(S_1=150\)</span>，
第二个营业所随机抽查了<span class="math inline">\(n_2=22\)</span>个支票账户，
均值为<span class="math inline">\(\bar y=910\)</span>,
样本标准差为<span class="math inline">\(S_2=125\)</span>。</p>
<p>从原始数据出发计算检验：</p>
<div class="sourceCode" id="cb2085"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2085-1"><a href="stat-basics.html#cb2085-1"></a><span class="kw">t.test</span>(CheckAcct[[<span class="dv">1</span>]], CheckAcct[[<span class="dv">2</span>]], <span class="dt">var.equal =</span> <span class="ot">FALSE</span>, <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  CheckAcct[[1]] and CheckAcct[[2]]
## t = 2.956, df = 47.805, p-value = 0.004828
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##   36.77503 193.25224
## sample estimates:
## mean of x mean of y 
## 1025.0000  909.9864</code></pre>
<p>p值为0.005，在0.05水平下显著，
两个营业所的账户平均余额有显著差异。</p>
</div>
<div id="两种工具软件的比较" class="section level6">
<h6><span class="header-section-number">31.3.1.2.4.3</span> 两种工具软件的比较</h6>
<p>考虑开发信息系统的两种工具软件的比较。
新的软件声称比旧的软件能加快进度。
设使用旧软件时平均项目完成时间为<span class="math inline">\(\mu_1\)</span>，
使用新软件时为<span class="math inline">\(\mu_2\)</span>。</p>
<p>检验：
<span class="math display">\[ 
H_0: \mu_1 \leq \mu_2 \longleftrightarrow
H_a: \mu_1 &gt; \mu_2 
\]</span>
(对立假设是新软件的工期更短)
取0.05水平。</p>
<div class="sourceCode" id="cb2087"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2087-1"><a href="stat-basics.html#cb2087-1"></a><span class="kw">t.test</span>(SoftwareTest[[<span class="st">&#39;Current&#39;</span>]], SoftwareTest[[<span class="st">&#39;New&#39;</span>]],</span>
<span id="cb2087-2"><a href="stat-basics.html#cb2087-2"></a>       <span class="dt">var.equal =</span> <span class="ot">FALSE</span>, <span class="dt">alternative =</span> <span class="st">&#39;greater&#39;</span>)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  SoftwareTest[[&quot;Current&quot;]] and SoftwareTest[[&quot;New&quot;]]
## t = 2.2721, df = 21.803, p-value = 0.01665
## alternative hypothesis: true difference in means is greater than 0
## 95 percent confidence interval:
##  9.514309      Inf
## sample estimates:
## mean of x mean of y 
##       325       286</code></pre>
<p>p值为0.017, 使用新的工具软件的平均项目完成时间显著地少于使用旧工具软件。</p>
</div>
<div id="两种工艺所需时间的比较" class="section level6">
<h6><span class="header-section-number">31.3.1.2.4.4</span> 两种工艺所需时间的比较</h6>
<p>工厂希望比较同一生产问题两种工艺各自需要的时间，
将选用时间较短的工艺。
可以一组工人用工艺1，一组工人用工艺2，
随机分组。
两组之间工人的个体差异会使得差异的比较误差较大。</p>
<p>所以，让同一个工人分别采用两种工艺，
次序先后随机。
这样不会引入个体差异的影响，
精度较高。
使用成对检验。
用双侧检验，水平0.05。</p>
<div class="sourceCode" id="cb2089"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2089-1"><a href="stat-basics.html#cb2089-1"></a><span class="kw">t.test</span>(Matched[[<span class="st">&quot;Method 1&quot;</span>]], Matched[[<span class="st">&quot;Method 2&quot;</span>]], </span>
<span id="cb2089-2"><a href="stat-basics.html#cb2089-2"></a>       <span class="dt">paired=</span><span class="ot">TRUE</span>, <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  Matched[[&quot;Method 1&quot;]] and Matched[[&quot;Method 2&quot;]]
## t = 2.1958, df = 5, p-value = 0.07952
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.05120834  0.65120834
## sample estimates:
## mean of the differences 
##                     0.3</code></pre>
</div>
</div>
</div>
<div id="stat-base-hyptest-mumd" class="section level4">
<h4><span class="header-section-number">31.3.1.3</span> 多元均值置信域</h4>
<p>待补充。</p>
</div>
</div>
<div id="stat-base-hyptest-prop" class="section level3">
<h3><span class="header-section-number">31.3.2</span> 比例的假设检验和置信区间</h3>
<div id="stat-base-hyptest-prop1s" class="section level4">
<h4><span class="header-section-number">31.3.2.1</span> 单个比例的问题</h4>
<p>设要比较的是总体的某个比例，
如选民中对候选人甲的支持率。
这时总体是两点分布总体，
支持为1， 不支持为0，参数为<span class="math inline">\(p=P(X=1)\)</span>。
其它的比例问题类似，
<span class="math inline">\(p\)</span>是“成功概率”。</p>
<p>关于单总体的比例，也有双侧、右侧、左侧检验问题：
<span class="math display">\[\begin{aligned}
&amp; H_0: p=p_0 \longleftrightarrow H_a: p \neq p_0 \\
&amp; H_0: p \leq p_0 \longleftrightarrow H_a: p &gt; p_0 \\
&amp; H_0: p \geq p_0 \longleftrightarrow H_a: p &lt; p_0 
\end{aligned}\]</span></p>
<p>在R中，
大样本情况下可以用<code>prop.test(x, n, p=p0)</code>作单个比例的检验，
<code>n</code>是样本量，<code>x</code>是样本中符合条件（如支持）的个数，
检验使用近似卡方统计量，
用<code>alternative</code>选项选择双侧、右侧、左侧检验。
这个函数也给出比例<span class="math inline">\(p\)</span>的近似<span class="math inline">\(1-\alpha\)</span>置信区间，
用<code>conf.level</code>选项指定置信度。</p>
<p>大样本时还有
<span class="math display">\[
\frac{\hat p - p}{\sqrt{p(1-p)/n}}
\]</span>
近似服从标准正态分布，
可以据此计算Z检验。
自定义的R函数如下：</p>
<div class="sourceCode" id="cb2091"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2091-1"><a href="stat-basics.html#cb2091-1"></a>prop.test<span class="fl">.1</span>s &lt;-<span class="st"> </span><span class="cf">function</span>(x, n, <span class="dt">p=</span><span class="fl">0.5</span>, <span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>){</span>
<span id="cb2091-2"><a href="stat-basics.html#cb2091-2"></a>  phat &lt;-<span class="st"> </span>x<span class="op">/</span>n</span>
<span id="cb2091-3"><a href="stat-basics.html#cb2091-3"></a>  zstat &lt;-<span class="st"> </span>(phat <span class="op">-</span><span class="st"> </span>p)<span class="op">/</span><span class="kw">sqrt</span>(p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p)<span class="op">/</span>n)</span>
<span id="cb2091-4"><a href="stat-basics.html#cb2091-4"></a>  <span class="cf">if</span>(alternative<span class="op">==</span><span class="st">&quot;two.sided&quot;</span>){   <span class="co"># 双侧检验</span></span>
<span id="cb2091-5"><a href="stat-basics.html#cb2091-5"></a>    pvalue &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(<span class="kw">abs</span>(zstat)))</span>
<span id="cb2091-6"><a href="stat-basics.html#cb2091-6"></a>  } <span class="cf">else</span> <span class="cf">if</span>(alternative<span class="op">==</span><span class="st">&quot;less&quot;</span>){ <span class="co"># 左侧检验</span></span>
<span id="cb2091-7"><a href="stat-basics.html#cb2091-7"></a>    pvalue &lt;-<span class="st"> </span><span class="kw">pnorm</span>(zstat)</span>
<span id="cb2091-8"><a href="stat-basics.html#cb2091-8"></a>  } <span class="cf">else</span> <span class="cf">if</span>(alternative<span class="op">==</span><span class="st">&quot;greater&quot;</span>){ <span class="co"># 右侧检验</span></span>
<span id="cb2091-9"><a href="stat-basics.html#cb2091-9"></a>    pvalue &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(zstat)</span>
<span id="cb2091-10"><a href="stat-basics.html#cb2091-10"></a>  } <span class="cf">else</span> {</span>
<span id="cb2091-11"><a href="stat-basics.html#cb2091-11"></a>    <span class="kw">stop</span>(<span class="st">&quot;alternative unknown!&quot;</span>)</span>
<span id="cb2091-12"><a href="stat-basics.html#cb2091-12"></a>  }</span>
<span id="cb2091-13"><a href="stat-basics.html#cb2091-13"></a>  </span>
<span id="cb2091-14"><a href="stat-basics.html#cb2091-14"></a>  <span class="kw">c</span>(<span class="dt">stat=</span>zstat, <span class="dt">pvalue=</span>pvalue)</span>
<span id="cb2091-15"><a href="stat-basics.html#cb2091-15"></a>}</span></code></pre></div>
<p>因为比例问题本质上是一个二项分布推断问题，
所以R还提供了<code>binom.test(x, n, p=p0)</code>函数进行精确检验并计算精确置信区间，
但其结果略保守。
用法与<code>prop.test()</code>类似。</p>
</div>
<div id="stat-base-hyptest-prop2s" class="section level4">
<h4><span class="header-section-number">31.3.2.2</span> 两个比例的比较</h4>
<p>设有<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>两个独立的总体，
如男性和女性，
比较<span class="math inline">\(p_1 = P(X=1)\)</span>和<span class="math inline">\(p_2 = P(Y=1)\)</span>。</p>
<p>检验问题包括：
<span class="math display">\[\begin{aligned}
H_0: p_1 = p_2 &amp; \longleftrightarrow H_\text{a}: p_1 \neq p_2 \\
H_0: p_1 \leq p_2 &amp; \longleftrightarrow H_\text{a}: p_1 &gt; p_2 \\
H_0: p_1 \geq p_2 &amp; \longleftrightarrow H_\text{a}: p_1 &lt; p_2
\end{aligned}\]</span></p>
<p>在大样本情况下，
可以用R函数
<code>prop.test(c(nsucc1, nsucc2), c(n1,n2), alternative=...)</code>
进行独立两样本比例的比较检验，
其中<code>n1</code>和<code>n2</code>是两个样本量，
<code>nsucc1</code>和<code>nsucc2</code>是两个样本中符合特征的个数（个数除以样本量即样本中的比例），
<code>alternative</code>的选择也是<code>"two.sided"</code>、<code>"less"</code>、<code>"greater"</code>。</p>
<p>还可以比较<span class="math inline">\(p_1 - p_2\)</span>与某个<span class="math inline">\(\delta\)</span>。
设两个总体中分别抽取了<span class="math inline">\(n_1\)</span>和<span class="math inline">\(n_2\)</span>个样本点，
样本比例分别为<span class="math inline">\(\hat p_1\)</span>和<span class="math inline">\(\hat p_2\)</span>。
估计共同的样本比例
<span class="math display">\[
\hat p = \frac{n_1 \hat p_1 + n_2 \hat p_2}{n_1 + n_2} 
\]</span>
当<span class="math inline">\(\delta=0\)</span>时取统计量
<span class="math display">\[
Z = \frac{\hat p_1 - \hat p_2}
{\sqrt{\hat p (1 - \hat p) 
  \left( \frac{1}{n_1} + \frac{1}{n_2} \right)}} 
\]</span>
当<span class="math inline">\(p_1 = p_2\)</span>时<span class="math inline">\(Z\)</span>在大样本情况下近似服从标准正态分布。
当<span class="math inline">\(\delta\neq 0\)</span>时取统计量
<span class="math display">\[
Z = \frac{\hat p_1 - \hat p_2 - \delta}
{\sqrt{\frac{\hat p_1(1 - \hat p_1)}{n_1} + \frac{\hat p_2(1 - \hat p_2)}{n_2}}}
\]</span>
当<span class="math inline">\(p_1 - p_2 = \delta\)</span>时<span class="math inline">\(Z\)</span>在大样本情况下近似服从N(0,1)分布。</p>
<p>可以定义Z检验R函数为：</p>
<div class="sourceCode" id="cb2092"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2092-1"><a href="stat-basics.html#cb2092-1"></a>prop.test<span class="fl">.2</span>s &lt;-<span class="st"> </span><span class="cf">function</span>(x, n, <span class="dt">delta=</span><span class="fl">0.0</span>, <span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>){</span>
<span id="cb2092-2"><a href="stat-basics.html#cb2092-2"></a>  phat &lt;-<span class="st"> </span><span class="kw">sum</span>(x)<span class="op">/</span><span class="kw">sum</span>(n)</span>
<span id="cb2092-3"><a href="stat-basics.html#cb2092-3"></a>  p &lt;-<span class="st"> </span>x <span class="op">/</span><span class="st"> </span>n</span>
<span id="cb2092-4"><a href="stat-basics.html#cb2092-4"></a>  <span class="cf">if</span>(delta<span class="op">==</span><span class="fl">0.0</span>){</span>
<span id="cb2092-5"><a href="stat-basics.html#cb2092-5"></a>    zstat &lt;-<span class="st"> </span>(p[<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>p[<span class="dv">2</span>])<span class="op">/</span><span class="kw">sqrt</span>(phat<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>phat)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>n[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>n[<span class="dv">2</span>]))</span>
<span id="cb2092-6"><a href="stat-basics.html#cb2092-6"></a>  } <span class="cf">else</span> {</span>
<span id="cb2092-7"><a href="stat-basics.html#cb2092-7"></a>    zstat &lt;-<span class="st"> </span>(p[<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>p[<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span>delta)<span class="op">/</span><span class="kw">sqrt</span>(p[<span class="dv">1</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p[<span class="dv">1</span>])<span class="op">/</span>n[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>p[<span class="dv">2</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p[<span class="dv">2</span>])<span class="op">/</span>n[<span class="dv">2</span>])</span>
<span id="cb2092-8"><a href="stat-basics.html#cb2092-8"></a>  }</span>
<span id="cb2092-9"><a href="stat-basics.html#cb2092-9"></a>  <span class="cf">if</span>(alternative<span class="op">==</span><span class="st">&quot;two.sided&quot;</span>){   <span class="co"># 双侧检验</span></span>
<span id="cb2092-10"><a href="stat-basics.html#cb2092-10"></a>    pvalue &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(<span class="kw">abs</span>(zstat)))</span>
<span id="cb2092-11"><a href="stat-basics.html#cb2092-11"></a>  } <span class="cf">else</span> <span class="cf">if</span>(alternative<span class="op">==</span><span class="st">&quot;less&quot;</span>){ <span class="co"># 左侧检验</span></span>
<span id="cb2092-12"><a href="stat-basics.html#cb2092-12"></a>    pvalue &lt;-<span class="st"> </span><span class="kw">pnorm</span>(zstat)</span>
<span id="cb2092-13"><a href="stat-basics.html#cb2092-13"></a>  } <span class="cf">else</span> <span class="cf">if</span>(alternative<span class="op">==</span><span class="st">&quot;greater&quot;</span>){ <span class="co"># 右侧检验</span></span>
<span id="cb2092-14"><a href="stat-basics.html#cb2092-14"></a>    pvalue &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(zstat)</span>
<span id="cb2092-15"><a href="stat-basics.html#cb2092-15"></a>  } <span class="cf">else</span> {</span>
<span id="cb2092-16"><a href="stat-basics.html#cb2092-16"></a>    <span class="kw">stop</span>(<span class="st">&quot;alternative unknown!&quot;</span>)</span>
<span id="cb2092-17"><a href="stat-basics.html#cb2092-17"></a>  }</span>
<span id="cb2092-18"><a href="stat-basics.html#cb2092-18"></a>  </span>
<span id="cb2092-19"><a href="stat-basics.html#cb2092-19"></a>  <span class="kw">c</span>(<span class="dt">stat=</span>zstat, <span class="dt">pvalue=</span>pvalue)</span>
<span id="cb2092-20"><a href="stat-basics.html#cb2092-20"></a>}</span></code></pre></div>
<p>独立两总体比例比较的小样本情形意义不大，
可考虑使用Fisher精确检验，
R函数为<code>fisher.test()</code>。</p>
</div>
<div id="stat-base-hyptest-prop-example" class="section level4">
<h4><span class="header-section-number">31.3.2.3</span> 比例检验的例子</h4>
<div id="高尔夫培训女生比例检验例子" class="section level5">
<h5><span class="header-section-number">31.3.2.3.1</span> 高尔夫培训女生比例检验例子</h5>
<p>橡树溪高尔夫培训机构的女性学员比例较少，只有20%。
为了增加女性学员，设计了促销措施。一个月后调查，
希望证明女性学员比例增加了。</p>
<p>设女性学员比例为<span class="math inline">\(p\)</span>，
<span class="math display">\[ H_0: p \leq 0.20 \longleftrightarrow H_a: p &gt; 0.20 \]</span></p>
<p>取检验水平0.05。
抽查了400名学员，其中100名是女性学员，<span class="math inline">\(\hat p = 0.25\)</span>。</p>
<p>用<code>prop.test()</code>检验：</p>
<div class="sourceCode" id="cb2093"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2093-1"><a href="stat-basics.html#cb2093-1"></a><span class="kw">prop.test</span>(<span class="dv">100</span>, <span class="dv">400</span>, <span class="dt">p=</span><span class="fl">0.20</span>, <span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  1-sample proportions test with continuity correction
## 
## data:  100 out of 400, null probability 0.2
## X-squared = 5.9414, df = 1, p-value = 0.007395
## alternative hypothesis: true p is greater than 0.2
## 95 percent confidence interval:
##  0.2149649 1.0000000
## sample estimates:
##    p 
## 0.25</code></pre>
<p>检验p值为0.0074，小于检验水平0.05，
所以女性学员比例已经显著地高于过去的20%了。</p>
<p>用自定义的大样本Z检验函数<code>prop.test.1s()</code>:</p>
<div class="sourceCode" id="cb2095"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2095-1"><a href="stat-basics.html#cb2095-1"></a><span class="kw">prop.test.1s</span>(<span class="dv">100</span>, <span class="dv">400</span>, <span class="dt">p=</span><span class="fl">0.20</span>, <span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>)</span></code></pre></div>
<pre><code>##        stat      pvalue 
## 2.500000000 0.006209665</code></pre>
<p>检验p值为0.0062，与基于卡方检验的<code>prop.test()</code>结果略有差别。</p>
<p>用基于二项分布的<code>binom.test()</code>检验:</p>
<div class="sourceCode" id="cb2097"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2097-1"><a href="stat-basics.html#cb2097-1"></a><span class="kw">binom.test</span>(<span class="dv">100</span>, <span class="dv">400</span>, <span class="dt">p=</span><span class="fl">0.20</span>, <span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Exact binomial test
## 
## data:  100 and 400
## number of successes = 100, number of trials = 400, p-value = 0.008595
## alternative hypothesis: true probability of success is greater than 0.2
## 95 percent confidence interval:
##  0.2146019 1.0000000
## sample estimates:
## probability of success 
##                   0.25</code></pre>
<p>p值为0.0086。</p>
</div>
<div id="报税代理分理处的错误率比较" class="section level5">
<h5><span class="header-section-number">31.3.2.3.2</span> 报税代理分理处的错误率比较</h5>
<p>某个代理报税的机构希望比较下属的两个分理处申报纳税返还的出错率。
各自随机选取取了<span class="math inline">\(n_1=250\)</span>和<span class="math inline">\(n_2=300\)</span>件申报，
第一个分理处错了35件，错误率<span class="math inline">\(\hat p_1 = 0.14\)</span>;
第二个分理处错了27件，错误率<span class="math inline">\(\hat p_2 = 0.09\)</span>。</p>
<p>作双侧检验，水平0.10。</p>
<p>用<code>prop.test()</code>:</p>
<div class="sourceCode" id="cb2099"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2099-1"><a href="stat-basics.html#cb2099-1"></a><span class="kw">prop.test</span>(<span class="kw">c</span>(<span class="dv">35</span>,<span class="dv">27</span>), <span class="kw">c</span>(<span class="dv">250</span>,<span class="dv">300</span>), <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  2-sample test for equality of proportions with continuity correction
## 
## data:  c(35, 27) out of c(250, 300)
## X-squared = 2.9268, df = 1, p-value = 0.08712
## alternative hypothesis: two.sided
## 95 percent confidence interval:
##  -0.007506845  0.107506845
## sample estimates:
## prop 1 prop 2 
##   0.14   0.09</code></pre>
<p>p值0.087，有显著差异，第一处的错误率高。
因为比例需要较大样本量，
所以样本量不太大时，
有人用0.10这样的检验水平。</p>
<p>用自定义的<code>prop.test.2s()</code>:</p>
<div class="sourceCode" id="cb2101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2101-1"><a href="stat-basics.html#cb2101-1"></a><span class="kw">prop.test.2s</span>(<span class="kw">c</span>(<span class="dv">35</span>,<span class="dv">27</span>), <span class="kw">c</span>(<span class="dv">250</span>,<span class="dv">300</span>), <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<pre><code>##       stat     pvalue 
## 1.84618928 0.06486473</code></pre>
</div>
</div>
</div>
<div id="stat-base-hyptest-sigma" class="section level3">
<h3><span class="header-section-number">31.3.3</span> 方差的假设检验和置信区间</h3>
<div id="stat-base-hyptest-sigma1s" class="section level4">
<h4><span class="header-section-number">31.3.3.1</span> 单总体方差的假设检验和置信区间</h4>
<p>方差和标准差是总体的重要数字特征，
在金融应用中标准差代表波动率，
在工业生产中标准差也是重要的质量指标，
如机床加工精度可以用标准差表示。</p>
<p>对总体方差<span class="math inline">\(\sigma^2\)</span>可以做双侧、左侧、右侧检验，
与某个<span class="math inline">\(\sigma_0^2\)</span>比较。</p>
<p>设总体为正态总体，检验问题：
<span class="math display">\[\begin{aligned}
H_0:&amp; \sigma^2 = \sigma_0^2 \longleftrightarrow 
H_\text{a}: \sigma^2 \neq \sigma_0^2 \\
H_0:&amp; \sigma^2 \geq \sigma_0^2 \longleftrightarrow 
H_\text{a}: \sigma^2 &lt; \sigma_0^2 \\
H_0:&amp; \sigma^2 \leq \sigma_0^2 \longleftrightarrow 
H_\text{a}: \sigma^2 &gt; \sigma_0^2
\end{aligned}\]</span></p>
<p>可以用如下的自定义函数计算单正态总体方差的检验：</p>
<div class="sourceCode" id="cb2103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2103-1"><a href="stat-basics.html#cb2103-1"></a>var.test<span class="fl">.1</span>s &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">n=</span><span class="kw">length</span>(x), var0, <span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>){</span>
<span id="cb2103-2"><a href="stat-basics.html#cb2103-2"></a>  <span class="cf">if</span>(<span class="kw">length</span>(x)<span class="op">==</span><span class="dv">1</span>){ <span class="co"># 输入的是方差</span></span>
<span id="cb2103-3"><a href="stat-basics.html#cb2103-3"></a>    varx &lt;-<span class="st"> </span>x</span>
<span id="cb2103-4"><a href="stat-basics.html#cb2103-4"></a>  } <span class="cf">else</span> {</span>
<span id="cb2103-5"><a href="stat-basics.html#cb2103-5"></a>    varx &lt;-<span class="st"> </span><span class="kw">var</span>(x)</span>
<span id="cb2103-6"><a href="stat-basics.html#cb2103-6"></a>  }</span>
<span id="cb2103-7"><a href="stat-basics.html#cb2103-7"></a>  xi &lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span>varx<span class="op">/</span>var0</span>
<span id="cb2103-8"><a href="stat-basics.html#cb2103-8"></a>  </span>
<span id="cb2103-9"><a href="stat-basics.html#cb2103-9"></a>  <span class="cf">if</span>(alternative<span class="op">==</span><span class="st">&quot;less&quot;</span>){</span>
<span id="cb2103-10"><a href="stat-basics.html#cb2103-10"></a>    pvalue &lt;-<span class="st"> </span><span class="kw">pchisq</span>(xi, n<span class="dv">-1</span>)</span>
<span id="cb2103-11"><a href="stat-basics.html#cb2103-11"></a>  } <span class="cf">else</span> <span class="cf">if</span> (alternative<span class="op">==</span><span class="st">&quot;right&quot;</span>){</span>
<span id="cb2103-12"><a href="stat-basics.html#cb2103-12"></a>    pvalue &lt;-<span class="st"> </span><span class="kw">pchisq</span>(xi, n<span class="dv">-1</span>, <span class="dt">lower.tail=</span><span class="ot">FALSE</span>)</span>
<span id="cb2103-13"><a href="stat-basics.html#cb2103-13"></a>  } <span class="cf">else</span> <span class="cf">if</span>(alternative<span class="op">==</span><span class="st">&quot;two.sided&quot;</span>){</span>
<span id="cb2103-14"><a href="stat-basics.html#cb2103-14"></a>    pvalue &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">min</span>(<span class="kw">pchisq</span>(xi, n<span class="dv">-1</span>), <span class="kw">pchisq</span>(xi, n<span class="dv">-1</span>, <span class="dt">lower.tail=</span><span class="ot">FALSE</span>))</span>
<span id="cb2103-15"><a href="stat-basics.html#cb2103-15"></a>  }</span>
<span id="cb2103-16"><a href="stat-basics.html#cb2103-16"></a>  </span>
<span id="cb2103-17"><a href="stat-basics.html#cb2103-17"></a>  <span class="kw">c</span>(<span class="dt">statistic=</span>xi, <span class="dt">pvalue=</span>pvalue)</span>
<span id="cb2103-18"><a href="stat-basics.html#cb2103-18"></a>}</span></code></pre></div>
<p>可以输入样本数据到<code>x</code>中，
输入<span class="math inline">\(sigma_0^2\)</span>到<code>var0</code>中，
进行检验；
也可以输入<span class="math inline">\(S^2\)</span>到<code>x</code>中，输入样本量<span class="math inline">\(n\)</span>到<code>n</code>中，
输入<span class="math inline">\(sigma_0^2\)</span>到<code>var0</code>中，
进行检验。</p>
</div>
<div id="stat-base-hyptest-sigma2s" class="section level4">
<h4><span class="header-section-number">31.3.3.2</span> 独立两总体方差的比较</h4>
<p>设两个独立的正态总体的方差分别为<span class="math inline">\(\sigma_1^2\)</span>, <span class="math inline">\(\sigma_2^2\)</span>，
有双侧、左侧、右侧检验：
<span class="math display">\[\begin{aligned}
H_0:&amp; \sigma_1^2 = \sigma_2^2 \longleftrightarrow 
H_\text{a}: \sigma_1^2 \neq \sigma_2^2 \\
H_0:&amp; \sigma_1^2 \geq \sigma_2^2 \longleftrightarrow 
H_\text{a}: \sigma_1^2 &lt; \sigma_2^2 \\
H_0:&amp; \sigma_1^2 \leq \sigma_2^2 \longleftrightarrow 
H_\text{a}: \sigma_1^2 &gt; \sigma_2^2
\end{aligned}\]</span></p>
<p>设两个总体分别抽取<span class="math inline">\(n_1\)</span>和<span class="math inline">\(n_2\)</span>个样本点，
样本方差分别为<span class="math inline">\(S_x^2\)</span>和<span class="math inline">\(S_y^2\)</span>。</p>
<p>检验统计量
<span class="math display">\[
F = \frac{S_x^2}{S_y^2} 
\]</span>
在<span class="math inline">\(\sigma_1^2 = \sigma_2^2\)</span>时<span class="math inline">\(F\)</span>服从<span class="math inline">\(F(n_1 - 1, n_2 - 1)\)</span>分布。</p>
<p>如果输入<code>x</code>, <code>y</code>为两个样本的具体值，
可以用<code>var.test(x, y, alternative=...)</code>检验，
其中<code>alternative</code>的选择是<code>"two.sided"</code>、<code>"less"</code>、<code>"greater"</code>。</p>
<p><code>var.test()</code>假定总体都服从正态分布。
R中<code>mood.test()</code>是一种不要求正态分布假定的检验方法。
<code>bartlett.test()</code>检验多个独立正态总体方差是否全相等。</p>
</div>
<div id="stat-base-hyptest-sigma-example" class="section level4">
<h4><span class="header-section-number">31.3.3.3</span> 方差检验例子</h4>
<p>(待补充)</p>
</div>
</div>
<div id="stat-base-hyptest-gof" class="section level3">
<h3><span class="header-section-number">31.3.4</span> 拟合优度检验</h3>
<div id="各类比例相等的检验" class="section level4">
<h4><span class="header-section-number">31.3.4.1</span> 各类比例相等的检验</h4>
<p>设类别变量<span class="math inline">\(X\)</span>有<span class="math inline">\(m\)</span>个不同类别，
抽取<span class="math inline">\(n\)</span>个样本点后，
各类的频数分别为<span class="math inline">\(f_1, f_2, \dots, f_m\)</span>。</p>
<p>零假设为所有类的比例相同；
对立假设为各类比例不完全相同。</p>
<p>在零假设下，每个类的期望频数为<span class="math inline">\(n/m\)</span>。</p>
<p>检验统计量为
<span class="math display">\[
\chi^2 = \sum_{i=1}^m \frac{(f_i - \frac{n}{m})^2}{\frac{n}{m}} 
\]</span>
当<span class="math inline">\(\chi^2\)</span>超过某一临界值时拒绝零假设。
在<span class="math inline">\(H_0\)</span>成立且大样本情况下<span class="math inline">\(\chi^2\)</span>统计量近似服从<span class="math inline">\(\chi^2(m-1)\)</span>分布
（自由度为组数减1）。</p>
<p>设<code>x</code>中包含各类的频数，
R函数<code>chisq.test(x)</code>作各类的总体比例相等的拟合优度卡方检验。</p>
</div>
<div id="各类比例为指定值的检验" class="section level4">
<h4><span class="header-section-number">31.3.4.2</span> 各类比例为指定值的检验</h4>
<p>设分类变量<span class="math inline">\(X\)</span>的各类每类有一个总体比例的假设，
希望作为零假设检验。</p>
<p>设共有<span class="math inline">\(m\)</span>个类，在零假设中，
各类的比例分别为<span class="math inline">\(p_1, p_2, \dots, p_m\)</span>。</p>
<p>取了<span class="math inline">\(n\)</span>个样本点组成的样本，
各类的频数分别为<span class="math inline">\(f_1, f_2, \dots, f_m\)</span>，
期望频数分别为<span class="math inline">\(np_1, np_2, \dots, np_m\)</span>。</p>
<p>检验统计量为
<span class="math display">\[
\chi^2 = \sum_{i=1}^m \frac{(f_i - n p_i)^2}{n p_i}
\]</span>
在<span class="math inline">\(H_0\)</span>下成立且大样本情况下<span class="math inline">\(\chi^2\)</span>近似服从<span class="math inline">\(\chi^2(m-1)\)</span>，
自由度为组数减1。
因为是大样本检验法，
每个组的期望频数不能低于5，
否则可以合并较小的类。</p>
<p>设<code>x</code>中包含各类的频数，
<code>p</code>中包含<span class="math inline">\(H_0\)</span>假定的各类的概率，
R函数<code>chisq.test(x, p)</code>作各类的总体比例为指定概率的拟合优度卡方检验。</p>
<p><strong>例</strong>: 市场占有率的检验例子</p>
<p>某类产品中公司A占30%, 公司B占50%，公司C占20%。
近期C公司推出了新产品代替本公司的老产品。
Scott Marketing Research是一个调查公司，
公司C委托Scott Marketing Research调查分析新产品是否导致了市场占有率的变动。</p>
<p>设<span class="math inline">\(p_1, p_2, p_3\)</span>分别为三个公司现在的市场占有率，零假设为:
<span class="math display">\[ H_0: p_1 = 0.30, p_2 = 0.50, p_3 = 0.20 \]</span>
取检验水平0.05。
抽查了200位消费者，
购买三个公司的产品的人数分配为：
<span class="math display">\[(48, 98, 54)\]</span></p>
<p>卡方统计量</p>
<p><span class="math display">\[
\chi^2 = \frac{(48 - 200\times 0.3)^2}{200\times 0.3}
+ \frac{(98 - 200\times 0.5)^2}{200\times 0.5}
+ \frac{(54 - 200\times 0.2)^2}{200\times 0.2} = 7.34
\]</span></p>
<p>p值<span class="math inline">\(=P(\chi^2(3-1) &gt; 7.34) = 0.02548\)</span>，
拒绝零假设，
认为市场占有率有变化。</p>
<p>用<code>chisq.test()</code>计算：</p>
<div class="sourceCode" id="cb2104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2104-1"><a href="stat-basics.html#cb2104-1"></a><span class="kw">chisq.test</span>(<span class="kw">c</span>(<span class="dv">48</span>, <span class="dv">98</span>, <span class="dv">54</span>), <span class="dt">p=</span><span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.2</span>))</span></code></pre></div>
<pre><code>## 
##  Chi-squared test for given probabilities
## 
## data:  c(48, 98, 54)
## X-squared = 7.34, df = 2, p-value = 0.02548</code></pre>
</div>
<div id="带有未知参数的单分类变量的拟合优度假设检验" class="section level4">
<h4><span class="header-section-number">31.3.4.3</span> 带有未知参数的单分类变量的拟合优度假设检验</h4>
<p>如果<span class="math inline">\(H_0\)</span>下的概率有未知参数，
先用最大似然估计法估计未知参数，
然后将未知参数代入计算各类的概率，
从而计算期望频数，
计算卡方统计量。
求<span class="math inline">\(p\)</span>值时自由度要改为“组数减1减去未知参数个数”。</p>
<p><strong>例</strong>：
设某次选举有5位候选人，
其中呼声最高的是甲和乙。
问：甲、乙的支持率相等吗？</p>
<p>这不能用独立的两个比例的比较来解决，
因为这两个比例是互斥的，
不属于独立情况。</p>
<p>将类别简化为：甲，乙，其他。
零假设为“甲、乙的支持率都等于<span class="math inline">\(p\)</span>，
其他三位候选人的支持率为<span class="math inline">\(1-2p\)</span>，<span class="math inline">\(p\)</span>未知”；
对立假设是甲、乙的支持率不相等。</p>
<p>假设调查了1000位选民，
其中300名支持甲，200名支持乙，500名支持其他三位候选人。</p>
<p>在假定零假设成立的情况下先用最大似然估计法估计未知参数<span class="math inline">\(p\)</span>：
<span class="math inline">\(\hat p = (300 + 200)/1000/2 = 0.25\)</span>。
这样，三个类的概率估计为<span class="math inline">\((0.25, 0.25, 0.50)\)</span>。</p>
<p>然后，计算检验统计量：</p>
<div class="sourceCode" id="cb2106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2106-1"><a href="stat-basics.html#cb2106-1"></a><span class="kw">chisq.test</span>(<span class="kw">c</span>(<span class="dv">300</span>, <span class="dv">200</span>, <span class="dv">500</span>), <span class="kw">c</span>(<span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.50</span>))</span></code></pre></div>
<pre><code>## Warning in chisq.test(c(300, 200, 500), c(0.25, 0.25, 0.5)): Chi-squared
## approximation may be incorrect</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  c(300, 200, 500) and c(0.25, 0.25, 0.5)
## X-squared = 3, df = 2, p-value = 0.2231</code></pre>
<p>其中的<span class="math inline">\(p\)</span>值所用的自由度错误，我们需要自己计算p值：</p>
<div class="sourceCode" id="cb2109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2109-1"><a href="stat-basics.html#cb2109-1"></a>res &lt;-<span class="st"> </span><span class="kw">chisq.test</span>(<span class="kw">c</span>(<span class="dv">300</span>, <span class="dv">200</span>, <span class="dv">500</span>), <span class="kw">c</span>(<span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.50</span>))</span></code></pre></div>
<pre><code>## Warning in chisq.test(c(300, 200, 500), c(0.25, 0.25, 0.5)): Chi-squared
## approximation may be incorrect</code></pre>
<div class="sourceCode" id="cb2111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2111-1"><a href="stat-basics.html#cb2111-1"></a><span class="kw">c</span>(<span class="dt">statistic=</span>res<span class="op">$</span>statistic, <span class="dt">pvalue=</span><span class="kw">pchisq</span>(res<span class="op">$</span>statistic, res<span class="op">$</span>parameter <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">lower.tail=</span><span class="ot">FALSE</span>))</span></code></pre></div>
<pre><code>## statistic.X-squared    pvalue.X-squared 
##          3.00000000          0.08326452</code></pre>
<p>检验<span class="math inline">\(p\)</span>值为0.08而非原来的0.22。</p>
</div>
</div>
<div id="stat-base-hyptest-gof-vcd" class="section level3">
<h3><span class="header-section-number">31.3.5</span> 检验分布类型</h3>
<p>vcd包提供了一个goodfit函数，
可以用来拟合指定的某种理论分布(包括泊松、二项、负二项分布），
并检验服从该理论分布的零假设。</p>
<p>例如，我们生成一组速率参数为2的泊松随机数，
检验其分布是否泊松分布：</p>
<div class="sourceCode" id="cb2113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2113-1"><a href="stat-basics.html#cb2113-1"></a><span class="kw">library</span>(vcd)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;vcd&#39;是用R版本3.6.3 来建造的</code></pre>
<pre><code>## 载入需要的程辑包：grid</code></pre>
<div class="sourceCode" id="cb2116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2116-1"><a href="stat-basics.html#cb2116-1"></a><span class="kw">set.seed</span>(<span class="dv">101</span>)</span>
<span id="cb2116-2"><a href="stat-basics.html#cb2116-2"></a>datax &lt;-<span class="st"> </span><span class="kw">rpois</span>(<span class="dv">100</span>, <span class="dv">2</span>)</span>
<span id="cb2116-3"><a href="stat-basics.html#cb2116-3"></a><span class="kw">summary</span>(<span class="kw">goodfit</span>(datax, <span class="st">&quot;poisson&quot;</span>))</span></code></pre></div>
<pre><code>## 
##   Goodness-of-fit test for poisson distribution
## 
##                       X^2 df  P(&gt; X^2)
## Likelihood Ratio 4.289456  5 0.5085374</code></pre>
<p>检验其是否服从二项分布，取二项分布试验数为10：</p>
<div class="sourceCode" id="cb2118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2118-1"><a href="stat-basics.html#cb2118-1"></a><span class="kw">summary</span>(<span class="kw">goodfit</span>(datax, <span class="st">&quot;binomial&quot;</span>, <span class="dt">par =</span> <span class="kw">list</span>(<span class="dt">size =</span> <span class="dv">10</span>)))</span></code></pre></div>
<pre><code>## 
##   Goodness-of-fit test for binomial distribution
## 
##                       X^2 df  P(&gt; X^2)
## Likelihood Ratio 5.052451  5 0.4095126</code></pre>
<p>与二项分布也相容。
在检验分布类型时，
这种两种分布都不能拒绝的情况是常见的。</p>
</div>
<div id="stat-base-hyptest-indepcont" class="section level3">
<h3><span class="header-section-number">31.3.6</span> 列联表独立性卡方检验</h3>
<p>设分类变量<span class="math inline">\(X\)</span>有<span class="math inline">\(m\)</span>个类，
分类变量<span class="math inline">\(Y\)</span>有<span class="math inline">\(k\)</span>个类，
抽取了样本量为<span class="math inline">\(n\)</span>的样本，
设<span class="math inline">\(X\)</span>的第<span class="math inline">\(i\)</span>类与<span class="math inline">\(Y\)</span>的第<span class="math inline">\(j\)</span>类交叉的频数为<span class="math inline">\(f_{ij}\)</span>。</p>
<p>零假设为<span class="math inline">\(X\)</span>与<span class="math inline">\(Y\)</span>相互独立，
即行变量与列变量相互独立。</p>
<p>交叉频数列成列联表形式，第<span class="math inline">\(i\)</span>行第<span class="math inline">\(j\)</span>列为<span class="math inline">\(f_{ij}\)</span>。</p>
<p>第<span class="math inline">\(i\)</span>行的行和为<span class="math inline">\(f_{i\cdot}\)</span>,
<span class="math inline">\(X\)</span>的第<span class="math inline">\(i\)</span>类的百分比为<span class="math inline">\(r_{i} = f_{i\cdot}/n\)</span>;</p>
<p>第<span class="math inline">\(j\)</span>列的列和为<span class="math inline">\(f_{\cdot j}\)</span>,
<span class="math inline">\(Y\)</span>的第<span class="math inline">\(j\)</span>类的百分比为<span class="math inline">\(c_{j} = f_{\cdot j}/n\)</span>。</p>
<p>当<span class="math inline">\(X\)</span>, <span class="math inline">\(Y\)</span>独立时，
<span class="math inline">\((i,j)\)</span>格子的期望频数为
<span class="math inline">\(E_{ij} = n \times r_i \times c_j\)</span>。</p>
<p>列联表独立性检验统计量</p>
<p><span class="math display">\[
\chi^2 = \sum_{i=1}^m \sum_{j=1}^k \frac{(f_{ij} - E_{ij})^2}{E_{ij}}
\]</span></p>
<p>其中<span class="math inline">\(E_{ij} = n r_i c_j\)</span>，
<span class="math inline">\(r_i\)</span>为<span class="math inline">\(X\)</span>第<span class="math inline">\(i\)</span>类的百分比，
<span class="math inline">\(c_j\)</span>为<span class="math inline">\(Y\)</span>第<span class="math inline">\(j\)</span>类的百分比。</p>
<p>在<span class="math inline">\(H_0\)</span>下<span class="math inline">\(\chi^2\)</span>近似服从<span class="math inline">\((m-1)(k-1)\)</span>自由度的卡方分布。
设统计量值为<span class="math inline">\(c\)</span>，
p值为<span class="math inline">\(P(\chi^2((m-1)(k-1)) &gt; c)\)</span>。</p>
<p>如果<code>x</code>, <code>y</code>分别是两个变量的原始观测值，
<code>chisq.test(x, y)</code>可以做列联表独立性检验。
如果<code>x</code>保存了矩阵格式的列联表，
矩阵行名是<span class="math inline">\(X\)</span>各个类的名称，
矩阵列名是<span class="math inline">\(Y\)</span>各个类的名称，
则<code>chisq.test(x)</code>可以做列联表独立性检验。</p>
<p>列联表卡方检验法的检验统计量在零假设下的卡方分布是大样本情况的近似分布。
如果每个变量仅有两个类，每个类的期望频数不能少于5;
如果有多个单元格，期望频数少于5的单元格的个数不能超过20%，
否则应该合并较小的类。</p>
<div id="stat-base-hyptest-indepcont-example" class="section level4">
<h4><span class="header-section-number">31.3.6.1</span> 列联表独立性卡方检验例子</h4>
<div id="性别与啤酒种类的独立性检验" class="section level5">
<h5><span class="header-section-number">31.3.6.1.1</span> 性别与啤酒种类的独立性检验</h5>
<p>Alber’s Brewery of Tucson, Arizona是啤酒制造与销售商。
有三类啤酒产品：淡啤酒，普通啤酒，黑啤酒。</p>
<p>了解不同顾客喜好有利于制定更精准的销售策略。
希望了解男女顾客对不同类型的偏好有没有显著差异，
实际就是检验性别与啤酒类型偏好的独立性。</p>
<p>抽查了150位顾客，得到如下的列联表：</p>
<div class="sourceCode" id="cb2120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2120-1"><a href="stat-basics.html#cb2120-1"></a>ctab.beer &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">c</span>(</span>
<span id="cb2120-2"><a href="stat-basics.html#cb2120-2"></a>  <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">20</span>),</span>
<span id="cb2120-3"><a href="stat-basics.html#cb2120-3"></a>  <span class="kw">c</span>(<span class="dv">30</span>,<span class="dv">30</span>,<span class="dv">10</span>))</span>
<span id="cb2120-4"><a href="stat-basics.html#cb2120-4"></a><span class="kw">colnames</span>(ctab.beer) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Light&quot;</span>, <span class="st">&quot;Regular&quot;</span>, <span class="st">&quot;Dark&quot;</span>)</span>
<span id="cb2120-5"><a href="stat-basics.html#cb2120-5"></a><span class="kw">rownames</span>(ctab.beer) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>)</span>
<span id="cb2120-6"><a href="stat-basics.html#cb2120-6"></a><span class="kw">addmargins</span>(ctab.beer)</span></code></pre></div>
<pre><code>##        Light Regular Dark Sum
## Male      20      40   20  80
## Female    30      30   10  70
## Sum       50      70   30 150</code></pre>
<p>列联表独立性检验：</p>
<div class="sourceCode" id="cb2122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2122-1"><a href="stat-basics.html#cb2122-1"></a><span class="kw">chisq.test</span>(ctab.beer)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  ctab.beer
## X-squared = 6.1224, df = 2, p-value = 0.04683</code></pre>
<p>在0.05水平下认为啤酒类型偏好与性别有关。
男性组的偏好分布、女性组的偏好分布、所有人的偏好分布：</p>
<div class="sourceCode" id="cb2124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2124-1"><a href="stat-basics.html#cb2124-1"></a>tab2 &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">prop.table</span>(<span class="kw">addmargins</span>(ctab.beer, <span class="dv">1</span>), <span class="dv">1</span>), <span class="dv">3</span>)</span>
<span id="cb2124-2"><a href="stat-basics.html#cb2124-2"></a><span class="kw">rownames</span>(tab2)[<span class="dv">3</span>] &lt;-<span class="st"> &quot;All&quot;</span></span>
<span id="cb2124-3"><a href="stat-basics.html#cb2124-3"></a>tab2</span></code></pre></div>
<pre><code>##        Light Regular  Dark
## Male   0.250   0.500 0.250
## Female 0.429   0.429 0.143
## All    0.333   0.467 0.200</code></pre>
<p>可以看出男性中对淡啤酒偏好偏少，
女性中对淡啤酒偏好偏多。</p>
</div>
</div>
</div>
<div id="stat-base-hyptest-npar" class="section level3">
<h3><span class="header-section-number">31.3.7</span> 非参数检验</h3>
<p>待完成。</p>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-R-in-action">
<p>Kabacoff, Robert I. 2012. <em>R语言实战</em>. 人民邮电出版社.</p>
</div>
<div id="ref-MASS4ed">
<p>Venables, W. N., and B. D. Ripley. 2002. <em>Modern Applied Statistics with S</em>. 4th Ed. Springer.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ggplotvis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="stat-reg.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="static/js/app.min.js"></script>
<script src="static/js/lunr.js"></script>
<script src="static/js/clipboard.min.js"></script>
<script src="static/js/plugin-search.js"></script>
<script src="static/js/plugin-sharing.js"></script>
<script src="static/js/plugin-fontsettings.js"></script>
<script src="static/js/plugin-bookdown.js"></script>
<script src="static/js/jquery.highlight.js"></script>
<script src="static/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Rbook.pdf"],
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
