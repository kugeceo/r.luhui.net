<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>33 R时间序列分析 | R语言教程</title>
  <meta name="description" content="李东风在北京大学数学科学学院开设本科生《统计软件》教材。采用R的bookdown制作，输出格式为bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="33 R时间序列分析 | R语言教程" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="李东风在北京大学数学科学学院开设本科生《统计软件》教材。采用R的bookdown制作，输出格式为bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="33 R时间序列分析 | R语言教程" />
  
  <meta name="twitter:description" content="李东风在北京大学数学科学学院开设本科生《统计软件》教材。采用R的bookdown制作，输出格式为bookdown::gitbook." />
  

<meta name="author" content="李东风" />


<meta name="date" content="2020-12-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="stat-reg.html"/>
<link rel="next" href="stat-learning.html"/>
<script src="static/js/jquery.min.js"></script>
<link href="static/css/style.css" rel="stylesheet" />
<link href="static/css/plugin-table.css" rel="stylesheet" />
<link href="static/css/plugin-bookdown.css" rel="stylesheet" />
<link href="static/css/plugin-highlight.css" rel="stylesheet" />
<link href="static/css/plugin-search.css" rel="stylesheet" />
<link href="static/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="static/css/plugin-clipboard.css" rel="stylesheet" />





<div style="display:none">
    <script src="http://s11.cnzz.com/z_stat.php?id=610720&web_id=610720" language="JavaScript"></script>
</div>






<script src="static/js/empty-anchor.js"></script>
<script src="static/js/htmlwidgets.js"></script>
<link href="static/css/str_view.css" rel="stylesheet" />
<script src="static/js/str_view.js"></script>
<link href="static/css/wordcloud.css" rel="stylesheet" />
<script src="static/js/wordcloud2-all.js"></script>
<script src="static/js/hover.js"></script>
<script src="static/js/wordcloud2.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  jax: ["input/TeX","output/SVG"],
  extensions: ["tex2jax.js","MathMenu.js","MathZoom.js"],
  TeX: {
    extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
  }
});
</script>
<script type="text/javascript"
   src="static/js/mathjax.js">
</script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="http://www.math.pku.edu.cn/teachers/lidf/docs/Rbook/html/_Rbook/index.html">R语言教程</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>前言</a></li>
<li class="part"><span><b>I 介绍</b></span></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> R语言介绍</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#intro-hist-char"><i class="fa fa-check"></i><b>1.1</b> R的历史和特点</a><ul>
<li class="chapter" data-level="1.1.1" data-path="intro.html"><a href="intro.html#intro-hc-hist"><i class="fa fa-check"></i><b>1.1.1</b> R的历史</a></li>
<li class="chapter" data-level="1.1.2" data-path="intro.html"><a href="intro.html#intro-hc-char"><i class="fa fa-check"></i><b>1.1.2</b> R的特点</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#intro-install"><i class="fa fa-check"></i><b>1.2</b> R的下载与安装</a><ul>
<li class="chapter" data-level="1.2.1" data-path="intro.html"><a href="intro.html#intro-ins-down"><i class="fa fa-check"></i><b>1.2.1</b> R的下载</a></li>
<li class="chapter" data-level="1.2.2" data-path="intro.html"><a href="intro.html#intro-ins-install"><i class="fa fa-check"></i><b>1.2.2</b> R软件安装</a></li>
<li class="chapter" data-level="1.2.3" data-path="intro.html"><a href="intro.html#intro-ins-other-soft"><i class="fa fa-check"></i><b>1.2.3</b> 辅助软件</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#intro-ins-packages"><i class="fa fa-check"></i><b>1.3</b> R扩展软件包的安装与管理</a><ul>
<li class="chapter" data-level="1.3.1" data-path="intro.html"><a href="intro.html#intro-ins-pack-ins"><i class="fa fa-check"></i><b>1.3.1</b> 安装</a></li>
<li class="chapter" data-level="1.3.2" data-path="intro.html"><a href="intro.html#intro-ins-pack-gitbioc"><i class="fa fa-check"></i><b>1.3.2</b> Github和BioConductor的扩展包</a></li>
<li class="chapter" data-level="1.3.3" data-path="intro.html"><a href="intro.html#intro-ins-pack-upd"><i class="fa fa-check"></i><b>1.3.3</b> 更新扩展包</a></li>
<li class="chapter" data-level="1.3.4" data-path="intro.html"><a href="intro.html#intro-ins-pack-verup"><i class="fa fa-check"></i><b>1.3.4</b> 迁移扩展包</a></li>
<li class="chapter" data-level="1.3.5" data-path="intro.html"><a href="intro.html#intro-ins-pack-renv"><i class="fa fa-check"></i><b>1.3.5</b> 项目私有扩展包目录</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#intro-ruse"><i class="fa fa-check"></i><b>1.4</b> 基本R软件的用法</a><ul>
<li class="chapter" data-level="1.4.1" data-path="intro.html"><a href="intro.html#intro-ruse-run"><i class="fa fa-check"></i><b>1.4.1</b> 基本运行</a></li>
<li class="chapter" data-level="1.4.2" data-path="intro.html"><a href="intro.html#intro-ruse-proj"><i class="fa fa-check"></i><b>1.4.2</b> 项目目录</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#intro-rstudio"><i class="fa fa-check"></i><b>1.5</b> RStudio软件</a><ul>
<li class="chapter" data-level="1.5.1" data-path="intro.html"><a href="intro.html#intro-rstudio-intro"><i class="fa fa-check"></i><b>1.5.1</b> 介绍</a></li>
<li class="chapter" data-level="1.5.2" data-path="intro.html"><a href="intro.html#intro-rstudio-proj"><i class="fa fa-check"></i><b>1.5.2</b> 项目</a></li>
<li class="chapter" data-level="1.5.3" data-path="intro.html"><a href="intro.html#intro-rstudio-help"><i class="fa fa-check"></i><b>1.5.3</b> 帮助</a></li>
<li class="chapter" data-level="1.5.4" data-path="intro.html"><a href="intro.html#intro-rstudio-shortcuts"><i class="fa fa-check"></i><b>1.5.4</b> 使用技巧</a></li>
<li class="chapter" data-level="1.5.5" data-path="intro.html"><a href="intro.html#intro-rstudio-rmd"><i class="fa fa-check"></i><b>1.5.5</b> Rmd文件</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#intro-ins-ex"><i class="fa fa-check"></i><b>1.6</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro-example.html"><a href="intro-example.html"><i class="fa fa-check"></i><b>2</b> R语言入门运行样例</a><ul>
<li class="chapter" data-level="2.1" data-path="intro-example.html"><a href="intro-example.html#i-e-command-line"><i class="fa fa-check"></i><b>2.1</b> 命令行界面</a></li>
<li class="chapter" data-level="2.2" data-path="intro-example.html"><a href="intro-example.html#i-e-arith-op"><i class="fa fa-check"></i><b>2.2</b> 四则运算</a><ul>
<li class="chapter" data-level="2.2.1" data-path="intro-example.html"><a href="intro-example.html#i-e-arith-op-poker"><i class="fa fa-check"></i><b>2.2.1</b> 计算例子</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro-example.html"><a href="intro-example.html#i-e-a-o-ex"><i class="fa fa-check"></i><b>2.2.2</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intro-example.html"><a href="intro-example.html#i-e-math-func"><i class="fa fa-check"></i><b>2.3</b> 数学函数</a><ul>
<li class="chapter" data-level="2.3.1" data-path="intro-example.html"><a href="intro-example.html#i-e-m-f-sqrt"><i class="fa fa-check"></i><b>2.3.1</b> 数学函数——平方根、指数、对数</a></li>
<li class="chapter" data-level="2.3.2" data-path="intro-example.html"><a href="intro-example.html#i-e-m-f-round"><i class="fa fa-check"></i><b>2.3.2</b> 数学函数——取整</a></li>
<li class="chapter" data-level="2.3.3" data-path="intro-example.html"><a href="intro-example.html#i-e-m-f-sin"><i class="fa fa-check"></i><b>2.3.3</b> 数学函数——三角函数</a></li>
<li class="chapter" data-level="2.3.4" data-path="intro-example.html"><a href="intro-example.html#i-e-m-f-asin"><i class="fa fa-check"></i><b>2.3.4</b> 数学函数——反三角函数</a></li>
<li class="chapter" data-level="2.3.5" data-path="intro-example.html"><a href="intro-example.html#i-e-m-f-dist"><i class="fa fa-check"></i><b>2.3.5</b> 分布函数和分位数函数</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro-example.html"><a href="intro-example.html#i-e-output"><i class="fa fa-check"></i><b>2.4</b> 输出</a><ul>
<li class="chapter" data-level="2.4.1" data-path="intro-example.html"><a href="intro-example.html#i-e-o-simple"><i class="fa fa-check"></i><b>2.4.1</b> 简单输出</a></li>
<li class="chapter" data-level="2.4.2" data-path="intro-example.html"><a href="intro-example.html#i-e-o-sink"><i class="fa fa-check"></i><b>2.4.2</b> 用<code>sink()</code>函数作运行记录</a></li>
<li class="chapter" data-level="2.4.3" data-path="intro-example.html"><a href="intro-example.html#i-e-o-ex"><i class="fa fa-check"></i><b>2.4.3</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="intro-example.html"><a href="intro-example.html#i-e-vector"><i class="fa fa-check"></i><b>2.5</b> 向量计算与变量赋值</a></li>
<li class="chapter" data-level="2.6" data-path="intro-example.html"><a href="intro-example.html#i-e-workspace"><i class="fa fa-check"></i><b>2.6</b> 工作空间介绍</a><ul>
<li class="chapter" data-level="2.6.1" data-path="intro-example.html"><a href="intro-example.html#i-e-w-ex"><i class="fa fa-check"></i><b>2.6.1</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="intro-example.html"><a href="intro-example.html#i-e-graph"><i class="fa fa-check"></i><b>2.7</b> 绘图示例</a><ul>
<li class="chapter" data-level="2.7.1" data-path="intro-example.html"><a href="intro-example.html#i-e-g-curve"><i class="fa fa-check"></i><b>2.7.1</b> 函数曲线示例</a></li>
<li class="chapter" data-level="2.7.2" data-path="intro-example.html"><a href="intro-example.html#i-e-g-barplot"><i class="fa fa-check"></i><b>2.7.2</b> 条形图示例</a></li>
<li class="chapter" data-level="2.7.3" data-path="intro-example.html"><a href="intro-example.html#i-e-g-scatter"><i class="fa fa-check"></i><b>2.7.3</b> 散点图示例</a></li>
<li class="chapter" data-level="2.7.4" data-path="intro-example.html"><a href="intro-example.html#i-e-g-demo"><i class="fa fa-check"></i><b>2.7.4</b> R软件自带的图形示例</a></li>
<li class="chapter" data-level="2.7.5" data-path="intro-example.html"><a href="intro-example.html#i-e-g-ex"><i class="fa fa-check"></i><b>2.7.5</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="intro-example.html"><a href="intro-example.html#i-e-summary"><i class="fa fa-check"></i><b>2.8</b> 汇总统计示例</a><ul>
<li class="chapter" data-level="2.8.1" data-path="intro-example.html"><a href="intro-example.html#i-e-s-table"><i class="fa fa-check"></i><b>2.8.1</b> 表格数据</a></li>
<li class="chapter" data-level="2.8.2" data-path="intro-example.html"><a href="intro-example.html#i-e-s-t-read-table"><i class="fa fa-check"></i><b>2.8.2</b> 读入表格数据</a></li>
<li class="chapter" data-level="2.8.3" data-path="intro-example.html"><a href="intro-example.html#i-e-s-ex"><i class="fa fa-check"></i><b>2.8.3</b> 练习</a></li>
<li class="chapter" data-level="2.8.4" data-path="intro-example.html"><a href="intro-example.html#i-e-s-qual-freq"><i class="fa fa-check"></i><b>2.8.4</b> 分类变量频数统计</a></li>
<li class="chapter" data-level="2.8.5" data-path="intro-example.html"><a href="intro-example.html#i-e-s-num-summ"><i class="fa fa-check"></i><b>2.8.5</b> 数值型变量的统计</a></li>
<li class="chapter" data-level="2.8.6" data-path="intro-example.html"><a href="intro-example.html#i-e-s-ex2"><i class="fa fa-check"></i><b>2.8.6</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="intro-example.html"><a href="intro-example.html#i-e-source"><i class="fa fa-check"></i><b>2.9</b> 运行源程序文件</a><ul>
<li class="chapter" data-level="2.9.1" data-path="intro-example.html"><a href="intro-example.html#i-e-source-enc"><i class="fa fa-check"></i><b>2.9.1</b> 源文件编码</a></li>
<li class="chapter" data-level="2.9.2" data-path="intro-example.html"><a href="intro-example.html#i-e-cwd"><i class="fa fa-check"></i><b>2.9.2</b> 当前工作目录</a></li>
<li class="chapter" data-level="2.9.3" data-path="intro-example.html"><a href="intro-example.html#i-e-source-ex"><i class="fa fa-check"></i><b>2.9.3</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="intro-example.html"><a href="intro-example.html#i-e-appendix-data"><i class="fa fa-check"></i><b>2.10</b> 附录：数据</a><ul>
<li class="chapter" data-level="2.10.1" data-path="intro-example.html"><a href="intro-example.html#i-e-appendix-data-tax"><i class="fa fa-check"></i><b>2.10.1</b> 公司纳税数据样例</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II 数据类型与相应的运算</b></span></li>
<li class="chapter" data-level="3" data-path="prog-type-intro.html"><a href="prog-type-intro.html"><i class="fa fa-check"></i><b>3</b> 常量与变量</a><ul>
<li class="chapter" data-level="3.1" data-path="prog-type-intro.html"><a href="prog-type-intro.html#p-t-const"><i class="fa fa-check"></i><b>3.1</b> 常量</a></li>
<li class="chapter" data-level="3.2" data-path="prog-type-intro.html"><a href="prog-type-intro.html#p-t-cv-var"><i class="fa fa-check"></i><b>3.2</b> 变量</a></li>
<li class="chapter" data-level="3.3" data-path="prog-type-intro.html"><a href="prog-type-intro.html#p-t-type"><i class="fa fa-check"></i><b>3.3</b> R数据类型</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="prog-type-num.html"><a href="prog-type-num.html"><i class="fa fa-check"></i><b>4</b> 数值型向量及其运算</a><ul>
<li class="chapter" data-level="4.1" data-path="prog-type-num.html"><a href="prog-type-num.html#p-t-num"><i class="fa fa-check"></i><b>4.1</b> 数值型向量</a></li>
<li class="chapter" data-level="4.2" data-path="prog-type-num.html"><a href="prog-type-num.html#p-t-arith"><i class="fa fa-check"></i><b>4.2</b> 向量运算</a><ul>
<li class="chapter" data-level="4.2.1" data-path="prog-type-num.html"><a href="prog-type-num.html#p-t-arith-scalar"><i class="fa fa-check"></i><b>4.2.1</b> 标量和标量运算</a></li>
<li class="chapter" data-level="4.2.2" data-path="prog-type-num.html"><a href="prog-type-num.html#p-t-arith-vec-with-scalar"><i class="fa fa-check"></i><b>4.2.2</b> 向量与标量运算</a></li>
<li class="chapter" data-level="4.2.3" data-path="prog-type-num.html"><a href="prog-type-num.html#p-t-arith-vec-eq-len"><i class="fa fa-check"></i><b>4.2.3</b> 等长向量运算</a></li>
<li class="chapter" data-level="4.2.4" data-path="prog-type-num.html"><a href="prog-type-num.html#p-t-arith-vec-uneq-len"><i class="fa fa-check"></i><b>4.2.4</b> 不等长向量的运算</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="prog-type-num.html"><a href="prog-type-num.html#p-t-vfunc"><i class="fa fa-check"></i><b>4.3</b> 向量函数</a><ul>
<li class="chapter" data-level="4.3.1" data-path="prog-type-num.html"><a href="prog-type-num.html#p-t-vfunc-vector-func"><i class="fa fa-check"></i><b>4.3.1</b> 向量化的函数</a></li>
<li class="chapter" data-level="4.3.2" data-path="prog-type-num.html"><a href="prog-type-num.html#p-t-vfunc-sort"><i class="fa fa-check"></i><b>4.3.2</b> 排序函数</a></li>
<li class="chapter" data-level="4.3.3" data-path="prog-type-num.html"><a href="prog-type-num.html#p-t-vfunc-stat"><i class="fa fa-check"></i><b>4.3.3</b> 统计函数</a></li>
<li class="chapter" data-level="4.3.4" data-path="prog-type-num.html"><a href="prog-type-num.html#p-t-vfunc-seq"><i class="fa fa-check"></i><b>4.3.4</b> 生成规则序列的函数</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="prog-type-num.html"><a href="prog-type-num.html#p-t-complex"><i class="fa fa-check"></i><b>4.4</b> 复数向量</a></li>
<li class="chapter" data-level="4.5" data-path="prog-type-num.html"><a href="prog-type-num.html#p-t-vfunc-ex"><i class="fa fa-check"></i><b>4.5</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="prog-type-logi.html"><a href="prog-type-logi.html"><i class="fa fa-check"></i><b>5</b> 逻辑型向量及其运算</a><ul>
<li class="chapter" data-level="5.1" data-path="prog-type-logi.html"><a href="prog-type-logi.html#p-t-logical-vec"><i class="fa fa-check"></i><b>5.1</b> 逻辑型向量与比较运算</a></li>
<li class="chapter" data-level="5.2" data-path="prog-type-logi.html"><a href="prog-type-logi.html#p-t-lvec-logic-op"><i class="fa fa-check"></i><b>5.2</b> 逻辑运算</a></li>
<li class="chapter" data-level="5.3" data-path="prog-type-logi.html"><a href="prog-type-logi.html#p-t-lvec-logic-op-vec"><i class="fa fa-check"></i><b>5.3</b> 逻辑运算函数</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="prog-type-char.html"><a href="prog-type-char.html"><i class="fa fa-check"></i><b>6</b> 字符型数据及其处理</a><ul>
<li class="chapter" data-level="6.1" data-path="prog-type-char.html"><a href="prog-type-char.html#p-t-char"><i class="fa fa-check"></i><b>6.1</b> 字符型向量</a></li>
<li class="chapter" data-level="6.2" data-path="prog-type-char.html"><a href="prog-type-char.html#p-t-char-paste"><i class="fa fa-check"></i><b>6.2</b> <code>paste()</code>函数</a></li>
<li class="chapter" data-level="6.3" data-path="prog-type-char.html"><a href="prog-type-char.html#p-t-char-toupper"><i class="fa fa-check"></i><b>6.3</b> 转换大小写</a></li>
<li class="chapter" data-level="6.4" data-path="prog-type-char.html"><a href="prog-type-char.html#p-t-char-nchar"><i class="fa fa-check"></i><b>6.4</b> 字符串长度</a></li>
<li class="chapter" data-level="6.5" data-path="prog-type-char.html"><a href="prog-type-char.html#p-t-char-substr"><i class="fa fa-check"></i><b>6.5</b> 取子串</a></li>
<li class="chapter" data-level="6.6" data-path="prog-type-char.html"><a href="prog-type-char.html#p-t-char-asnum"><i class="fa fa-check"></i><b>6.6</b> 类型转换</a></li>
<li class="chapter" data-level="6.7" data-path="prog-type-char.html"><a href="prog-type-char.html#p-t-char-strsplit"><i class="fa fa-check"></i><b>6.7</b> 字符串拆分</a></li>
<li class="chapter" data-level="6.8" data-path="prog-type-char.html"><a href="prog-type-char.html#p-t-char-gsub"><i class="fa fa-check"></i><b>6.8</b> 字符串替换功能</a></li>
<li class="chapter" data-level="6.9" data-path="prog-type-char.html"><a href="prog-type-char.html#p-t-char-regexp"><i class="fa fa-check"></i><b>6.9</b> 正则表达式</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="prog-type-index.html"><a href="prog-type-index.html"><i class="fa fa-check"></i><b>7</b> R向量下标和子集</a><ul>
<li class="chapter" data-level="7.1" data-path="prog-type-index.html"><a href="prog-type-index.html#p-t-subset-int"><i class="fa fa-check"></i><b>7.1</b> 正整数下标</a></li>
<li class="chapter" data-level="7.2" data-path="prog-type-index.html"><a href="prog-type-index.html#p-t-subset-negint"><i class="fa fa-check"></i><b>7.2</b> 负整数下标</a></li>
<li class="chapter" data-level="7.3" data-path="prog-type-index.html"><a href="prog-type-index.html#p-t-subset-all"><i class="fa fa-check"></i><b>7.3</b> 空下标与零下标</a></li>
<li class="chapter" data-level="7.4" data-path="prog-type-index.html"><a href="prog-type-index.html#p-t-subset-over"><i class="fa fa-check"></i><b>7.4</b> 下标超界</a></li>
<li class="chapter" data-level="7.5" data-path="prog-type-index.html"><a href="prog-type-index.html#p-t-subset-logic"><i class="fa fa-check"></i><b>7.5</b> 逻辑下标</a></li>
<li class="chapter" data-level="7.6" data-path="prog-type-index.html"><a href="prog-type-index.html#p-t-subset-which"><i class="fa fa-check"></i><b>7.6</b> <code>which()</code>、<code>which.min()</code>、<code>which.max()</code>函数</a></li>
<li class="chapter" data-level="7.7" data-path="prog-type-index.html"><a href="prog-type-index.html#p-t-subset-names"><i class="fa fa-check"></i><b>7.7</b> 元素名</a></li>
<li class="chapter" data-level="7.8" data-path="prog-type-index.html"><a href="prog-type-index.html#p-t-subset-mapping"><i class="fa fa-check"></i><b>7.8</b> 用R向量下标作映射</a></li>
<li class="chapter" data-level="7.9" data-path="prog-type-index.html"><a href="prog-type-index.html#p-t-subset-set"><i class="fa fa-check"></i><b>7.9</b> 集合运算</a></li>
<li class="chapter" data-level="7.10" data-path="prog-type-index.html"><a href="prog-type-index.html#p-t-set-ex"><i class="fa fa-check"></i><b>7.10</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="prog-type-attr.html"><a href="prog-type-attr.html"><i class="fa fa-check"></i><b>8</b> R数据类型的性质</a><ul>
<li class="chapter" data-level="8.1" data-path="prog-type-attr.html"><a href="prog-type-attr.html#p-t-modes-typeof"><i class="fa fa-check"></i><b>8.1</b> 存储模式与基本类型</a></li>
<li class="chapter" data-level="8.2" data-path="prog-type-attr.html"><a href="prog-type-attr.html#p-t-modes-as"><i class="fa fa-check"></i><b>8.2</b> 类型转换与类型升档</a></li>
<li class="chapter" data-level="8.3" data-path="prog-type-attr.html"><a href="prog-type-attr.html#p-t-modes-attr"><i class="fa fa-check"></i><b>8.3</b> 属性</a><ul>
<li class="chapter" data-level="8.3.1" data-path="prog-type-attr.html"><a href="prog-type-attr.html#p-t-modes-attr-asfun"><i class="fa fa-check"></i><b>8.3.1</b> <code>attributes</code>函数</a></li>
<li class="chapter" data-level="8.3.2" data-path="prog-type-attr.html"><a href="prog-type-attr.html#p-t-modes-attr-attrfun"><i class="fa fa-check"></i><b>8.3.2</b> <code>attr</code>函数</a></li>
<li class="chapter" data-level="8.3.3" data-path="prog-type-attr.html"><a href="prog-type-attr.html#p-t-modes-attr-names"><i class="fa fa-check"></i><b>8.3.3</b> <code>names</code>属性</a></li>
<li class="chapter" data-level="8.3.4" data-path="prog-type-attr.html"><a href="prog-type-attr.html#p-t-modes-attr-dim"><i class="fa fa-check"></i><b>8.3.4</b> <code>dim</code>属性</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="prog-type-attr.html"><a href="prog-type-attr.html#p-t-modes-class"><i class="fa fa-check"></i><b>8.4</b> 类属</a></li>
<li class="chapter" data-level="8.5" data-path="prog-type-attr.html"><a href="prog-type-attr.html#p-t-modes-str"><i class="fa fa-check"></i><b>8.5</b> <code>str()</code>函数</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="prog-type-date.html"><a href="prog-type-date.html"><i class="fa fa-check"></i><b>9</b> R日期时间</a><ul>
<li class="chapter" data-level="9.1" data-path="prog-type-date.html"><a href="prog-type-date.html#prog-type-dt-intro"><i class="fa fa-check"></i><b>9.1</b> R日期和日期时间类型</a></li>
<li class="chapter" data-level="9.2" data-path="prog-type-date.html"><a href="prog-type-date.html#prog-type-dt-fromchr"><i class="fa fa-check"></i><b>9.2</b> 从字符串生成日期数据</a></li>
<li class="chapter" data-level="9.3" data-path="prog-type-date.html"><a href="prog-type-date.html#p-t-date-format"><i class="fa fa-check"></i><b>9.3</b> 日期显示格式</a></li>
<li class="chapter" data-level="9.4" data-path="prog-type-date.html"><a href="prog-type-date.html#p-t-date-comp"><i class="fa fa-check"></i><b>9.4</b> 访问日期时间的组成值</a></li>
<li class="chapter" data-level="9.5" data-path="prog-type-date.html"><a href="prog-type-date.html#p-t-date-round"><i class="fa fa-check"></i><b>9.5</b> 日期舍入计算</a></li>
<li class="chapter" data-level="9.6" data-path="prog-type-date.html"><a href="prog-type-date.html#p-t-date-calc"><i class="fa fa-check"></i><b>9.6</b> 日期计算</a><ul>
<li class="chapter" data-level="9.6.1" data-path="prog-type-date.html"><a href="prog-type-date.html#p-t-date-calc-dur"><i class="fa fa-check"></i><b>9.6.1</b> 时间长度</a></li>
<li class="chapter" data-level="9.6.2" data-path="prog-type-date.html"><a href="prog-type-date.html#p-t-date-calc-per"><i class="fa fa-check"></i><b>9.6.2</b> 时间周期</a></li>
<li class="chapter" data-level="9.6.3" data-path="prog-type-date.html"><a href="prog-type-date.html#p-t-date-calc-int"><i class="fa fa-check"></i><b>9.6.3</b> 时间区间</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="prog-type-date.html"><a href="prog-type-date.html#prog-type-dt-baser"><i class="fa fa-check"></i><b>9.7</b> 基本R软件的日期功能</a><ul>
<li class="chapter" data-level="9.7.1" data-path="prog-type-date.html"><a href="prog-type-date.html#p-t-date-baser-gen"><i class="fa fa-check"></i><b>9.7.1</b> 生成日期和日期时间型数据</a></li>
<li class="chapter" data-level="9.7.2" data-path="prog-type-date.html"><a href="prog-type-date.html#p-t-date-baser-comp"><i class="fa fa-check"></i><b>9.7.2</b> 取出日期时间的组成值</a></li>
<li class="chapter" data-level="9.7.3" data-path="prog-type-date.html"><a href="prog-type-date.html#p-t-date-baser-calc"><i class="fa fa-check"></i><b>9.7.3</b> 日期计算</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="prog-type-date.html"><a href="prog-type-date.html#p-t-date-ex"><i class="fa fa-check"></i><b>9.8</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="prog-type-fact.html"><a href="prog-type-fact.html"><i class="fa fa-check"></i><b>10</b> R因子类型</a><ul>
<li class="chapter" data-level="10.1" data-path="prog-type-fact.html"><a href="prog-type-fact.html#p-t-fact"><i class="fa fa-check"></i><b>10.1</b> 因子</a></li>
<li class="chapter" data-level="10.2" data-path="prog-type-fact.html"><a href="prog-type-fact.html#p-t-factor-table"><i class="fa fa-check"></i><b>10.2</b> <code>table()</code>函数</a></li>
<li class="chapter" data-level="10.3" data-path="prog-type-fact.html"><a href="prog-type-fact.html#p-t-factor-tapply"><i class="fa fa-check"></i><b>10.3</b> <code>tapply()</code>函数</a></li>
<li class="chapter" data-level="10.4" data-path="prog-type-fact.html"><a href="prog-type-fact.html#summ-by-forcats"><i class="fa fa-check"></i><b>10.4</b> forcats包的因子函数</a></li>
<li class="chapter" data-level="10.5" data-path="prog-type-fact.html"><a href="prog-type-fact.html#p-t-factor-ex"><i class="fa fa-check"></i><b>10.5</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="prog-type-list.html"><a href="prog-type-list.html"><i class="fa fa-check"></i><b>11</b> 列表类型</a><ul>
<li class="chapter" data-level="11.1" data-path="prog-type-list.html"><a href="prog-type-list.html#p-t-list"><i class="fa fa-check"></i><b>11.1</b> 列表</a></li>
<li class="chapter" data-level="11.2" data-path="prog-type-list.html"><a href="prog-type-list.html#p-t-list-access"><i class="fa fa-check"></i><b>11.2</b> 列表元素访问</a></li>
<li class="chapter" data-level="11.3" data-path="prog-type-list.html"><a href="prog-type-list.html#p-t-list-as"><i class="fa fa-check"></i><b>11.3</b> 列表类型转换</a></li>
<li class="chapter" data-level="11.4" data-path="prog-type-list.html"><a href="prog-type-list.html#p-t-list-ex-strsplit"><i class="fa fa-check"></i><b>11.4</b> 返回列表的函数示例–<code>strsplit()</code></a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="prog-type-matrix.html"><a href="prog-type-matrix.html"><i class="fa fa-check"></i><b>12</b> R矩阵和数组</a><ul>
<li class="chapter" data-level="12.1" data-path="prog-type-matrix.html"><a href="prog-type-matrix.html#p-t-array-matrix"><i class="fa fa-check"></i><b>12.1</b> R矩阵</a></li>
<li class="chapter" data-level="12.2" data-path="prog-type-matrix.html"><a href="prog-type-matrix.html#p-t-array-subset"><i class="fa fa-check"></i><b>12.2</b> 矩阵子集</a></li>
<li class="chapter" data-level="12.3" data-path="prog-type-matrix.html"><a href="prog-type-matrix.html#p-t-array-cbind"><i class="fa fa-check"></i><b>12.3</b> <code>cbind()</code>和<code>rbind()</code>函数</a></li>
<li class="chapter" data-level="12.4" data-path="prog-type-matrix.html"><a href="prog-type-matrix.html#p-t-array-matop"><i class="fa fa-check"></i><b>12.4</b> 矩阵运算</a><ul>
<li class="chapter" data-level="12.4.1" data-path="prog-type-matrix.html"><a href="prog-type-matrix.html#p-t-array-matop-arith"><i class="fa fa-check"></i><b>12.4.1</b> 四则运算</a></li>
<li class="chapter" data-level="12.4.2" data-path="prog-type-matrix.html"><a href="prog-type-matrix.html#p-t-array-matop-mult"><i class="fa fa-check"></i><b>12.4.2</b> 矩阵乘法</a></li>
<li class="chapter" data-level="12.4.3" data-path="prog-type-matrix.html"><a href="prog-type-matrix.html#p-t-array-matop-vecmat"><i class="fa fa-check"></i><b>12.4.3</b> 向量与矩阵相乘</a></li>
<li class="chapter" data-level="12.4.4" data-path="prog-type-matrix.html"><a href="prog-type-matrix.html#p-t-array-matop-inprod"><i class="fa fa-check"></i><b>12.4.4</b> 内积</a></li>
<li class="chapter" data-level="12.4.5" data-path="prog-type-matrix.html"><a href="prog-type-matrix.html#p-t-array-matop-outer"><i class="fa fa-check"></i><b>12.4.5</b> 外积</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="prog-type-matrix.html"><a href="prog-type-matrix.html#p-t-array-solve"><i class="fa fa-check"></i><b>12.5</b> 逆矩阵与线性方程组求解</a></li>
<li class="chapter" data-level="12.6" data-path="prog-type-matrix.html"><a href="prog-type-matrix.html#p-t-array-apply"><i class="fa fa-check"></i><b>12.6</b> <code>apply()</code>函数</a></li>
<li class="chapter" data-level="12.7" data-path="prog-type-matrix.html"><a href="prog-type-matrix.html#p-t-array-array"><i class="fa fa-check"></i><b>12.7</b> 多维数组</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="prog-type-df.html"><a href="prog-type-df.html"><i class="fa fa-check"></i><b>13</b> 数据框</a><ul>
<li class="chapter" data-level="13.1" data-path="prog-type-df.html"><a href="prog-type-df.html#p-t-dataframe"><i class="fa fa-check"></i><b>13.1</b> 数据框</a></li>
<li class="chapter" data-level="13.2" data-path="prog-type-df.html"><a href="prog-type-df.html#p-t-df-access"><i class="fa fa-check"></i><b>13.2</b> 数据框内容访问</a></li>
<li class="chapter" data-level="13.3" data-path="prog-type-df.html"><a href="prog-type-df.html#p-t-df-rownames"><i class="fa fa-check"></i><b>13.3</b> 数据框的行名</a></li>
<li class="chapter" data-level="13.4" data-path="prog-type-df.html"><a href="prog-type-df.html#p-t-df-notmatrix"><i class="fa fa-check"></i><b>13.4</b> 数据框与矩阵的区别</a></li>
<li class="chapter" data-level="13.5" data-path="prog-type-df.html"><a href="prog-type-df.html#p-t-df-gl-func"><i class="fa fa-check"></i><b>13.5</b> <code>tidyr::expand_grid()</code>函数</a></li>
<li class="chapter" data-level="13.6" data-path="prog-type-df.html"><a href="prog-type-df.html#p-t-tibble"><i class="fa fa-check"></i><b>13.6</b> <code>tibble</code>类型</a></li>
<li class="chapter" data-level="13.7" data-path="prog-type-df.html"><a href="prog-type-df.html#p-t-df-ex"><i class="fa fa-check"></i><b>13.7</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="prog-type-ws.html"><a href="prog-type-ws.html"><i class="fa fa-check"></i><b>14</b> 工作空间和变量赋值</a><ul>
<li class="chapter" data-level="14.1" data-path="prog-type-ws.html"><a href="prog-type-ws.html#p-t-ws"><i class="fa fa-check"></i><b>14.1</b> 工作空间</a></li>
<li class="chapter" data-level="14.2" data-path="prog-type-ws.html"><a href="prog-type-ws.html#p-t-nlvname"><i class="fa fa-check"></i><b>14.2</b> 非法变量名</a></li>
<li class="chapter" data-level="14.3" data-path="prog-type-ws.html"><a href="prog-type-ws.html#p-t-ws-asign"><i class="fa fa-check"></i><b>14.3</b> 变量赋值与绑定</a></li>
<li class="chapter" data-level="14.4" data-path="prog-type-ws.html"><a href="prog-type-ws.html#p-t-ws-env"><i class="fa fa-check"></i><b>14.4</b> 环境</a></li>
</ul></li>
<li class="part"><span><b>III 编程</b></span></li>
<li class="chapter" data-level="15" data-path="prog-io.html"><a href="prog-io.html"><i class="fa fa-check"></i><b>15</b> R输入输出</a><ul>
<li class="chapter" data-level="15.1" data-path="prog-io.html"><a href="prog-io.html#p-io-simple"><i class="fa fa-check"></i><b>15.1</b> 输入输出的简单方法</a><ul>
<li class="chapter" data-level="15.1.1" data-path="prog-io.html"><a href="prog-io.html#p-io-simple-out"><i class="fa fa-check"></i><b>15.1.1</b> 简单的输出</a></li>
<li class="chapter" data-level="15.1.2" data-path="prog-io.html"><a href="prog-io.html#p-io-simple-input"><i class="fa fa-check"></i><b>15.1.2</b> 简单的输入</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="prog-io.html"><a href="prog-io.html#p-io-read-csv"><i class="fa fa-check"></i><b>15.2</b> 读取CSV文件</a><ul>
<li class="chapter" data-level="15.2.1" data-path="prog-io.html"><a href="prog-io.html#p-io-read-csv-format"><i class="fa fa-check"></i><b>15.2.1</b> CSV格式</a></li>
<li class="chapter" data-level="15.2.2" data-path="prog-io.html"><a href="prog-io.html#p-io-read-csv-fromstr"><i class="fa fa-check"></i><b>15.2.2</b> 从字符串读入</a></li>
<li class="chapter" data-level="15.2.3" data-path="prog-io.html"><a href="prog-io.html#p-io-read-csv-opt"><i class="fa fa-check"></i><b>15.2.3</b> <code>read_csv</code>选项</a></li>
<li class="chapter" data-level="15.2.4" data-path="prog-io.html"><a href="prog-io.html#p-io-read-csv-enc"><i class="fa fa-check"></i><b>15.2.4</b> 编码设置</a></li>
<li class="chapter" data-level="15.2.5" data-path="prog-io.html"><a href="prog-io.html#p-io-read-csv-na"><i class="fa fa-check"></i><b>15.2.5</b> 缺失值设置</a></li>
<li class="chapter" data-level="15.2.6" data-path="prog-io.html"><a href="prog-io.html#p-io-read-csv-colt"><i class="fa fa-check"></i><b>15.2.6</b> 各列类型设置</a></li>
<li class="chapter" data-level="15.2.7" data-path="prog-io.html"><a href="prog-io.html#p-io-read-csv-fact"><i class="fa fa-check"></i><b>15.2.7</b> 因子类型设置</a></li>
<li class="chapter" data-level="15.2.8" data-path="prog-io.html"><a href="prog-io.html#p-io-read-csv-date"><i class="fa fa-check"></i><b>15.2.8</b> 读入日期</a></li>
<li class="chapter" data-level="15.2.9" data-path="prog-io.html"><a href="prog-io.html#p-io-read-csv-funcs"><i class="fa fa-check"></i><b>15.2.9</b> 其它函数</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="prog-io.html"><a href="prog-io.html#p-io-excel"><i class="fa fa-check"></i><b>15.3</b> Excel表访问</a><ul>
<li class="chapter" data-level="15.3.1" data-path="prog-io.html"><a href="prog-io.html#p-io-excel-csv"><i class="fa fa-check"></i><b>15.3.1</b> 借助于文本格式</a></li>
<li class="chapter" data-level="15.3.2" data-path="prog-io.html"><a href="prog-io.html#p-io-excel-clip"><i class="fa fa-check"></i><b>15.3.2</b> 使用剪贴板</a></li>
<li class="chapter" data-level="15.3.3" data-path="prog-io.html"><a href="prog-io.html#p-io-excel-readxl"><i class="fa fa-check"></i><b>15.3.3</b> 利用readxl扩展包</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="prog-io.html"><a href="prog-io.html#p-io-file"><i class="fa fa-check"></i><b>15.4</b> 文件访问</a><ul>
<li class="chapter" data-level="15.4.1" data-path="prog-io.html"><a href="prog-io.html#p-io-file-conn"><i class="fa fa-check"></i><b>15.4.1</b> 连接</a></li>
<li class="chapter" data-level="15.4.2" data-path="prog-io.html"><a href="prog-io.html#p-io-file-text"><i class="fa fa-check"></i><b>15.4.2</b> 文本文件访问</a></li>
<li class="chapter" data-level="15.4.3" data-path="prog-io.html"><a href="prog-io.html#p-io-enc-batch"><i class="fa fa-check"></i><b>15.4.3</b> 文本文件分批读写</a></li>
<li class="chapter" data-level="15.4.4" data-path="prog-io.html"><a href="prog-io.html#p-io-file-bin"><i class="fa fa-check"></i><b>15.4.4</b> 二进制文件访问</a></li>
<li class="chapter" data-level="15.4.5" data-path="prog-io.html"><a href="prog-io.html#p-io-file-textcon"><i class="fa fa-check"></i><b>15.4.5</b> 字符型连接</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="prog-io.html"><a href="prog-io.html#p-io-enc"><i class="fa fa-check"></i><b>15.5</b> 中文编码问题</a><ul>
<li class="chapter" data-level="15.5.1" data-path="prog-io.html"><a href="prog-io.html#p-io-enc-base"><i class="fa fa-check"></i><b>15.5.1</b> 用基本R的读取函数读取</a></li>
<li class="chapter" data-level="15.5.2" data-path="prog-io.html"><a href="prog-io.html#p-io-enc-readr"><i class="fa fa-check"></i><b>15.5.2</b> 用readr包读取</a></li>
<li class="chapter" data-level="15.5.3" data-path="prog-io.html"><a href="prog-io.html#p-io-enc-write"><i class="fa fa-check"></i><b>15.5.3</b> 输出文件的编码</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="prog-io.html"><a href="prog-io.html#p-io-dir"><i class="fa fa-check"></i><b>15.6</b> 目录和文件管理</a></li>
<li class="chapter" data-level="15.7" data-path="prog-io.html"><a href="prog-io.html#p-io-db"><i class="fa fa-check"></i><b>15.7</b> SQL数据库访问</a><ul>
<li class="chapter" data-level="15.7.1" data-path="prog-io.html"><a href="prog-io.html#p-io-db-intro"><i class="fa fa-check"></i><b>15.7.1</b> 介绍</a></li>
<li class="chapter" data-level="15.7.2" data-path="prog-io.html"><a href="prog-io.html#p-io-db-sqlite"><i class="fa fa-check"></i><b>15.7.2</b> SQLite数据库访问</a></li>
<li class="chapter" data-level="15.7.3" data-path="prog-io.html"><a href="prog-io.html#p-io-db-sql"><i class="fa fa-check"></i><b>15.7.3</b> SQL命令简介</a></li>
<li class="chapter" data-level="15.7.4" data-path="prog-io.html"><a href="prog-io.html#p-io-db-oracle"><i class="fa fa-check"></i><b>15.7.4</b> 访问Oracle数据库</a></li>
<li class="chapter" data-level="15.7.5" data-path="prog-io.html"><a href="prog-io.html#p-io-db-mysql"><i class="fa fa-check"></i><b>15.7.5</b> MySQL数据库访问</a></li>
<li class="chapter" data-level="15.7.6" data-path="prog-io.html"><a href="prog-io.html#p-io-excel-rodbc"><i class="fa fa-check"></i><b>15.7.6</b> 利用RODBC访问Access数据库</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="prog-control.html"><a href="prog-control.html"><i class="fa fa-check"></i><b>16</b> 程序控制结构</a><ul>
<li class="chapter" data-level="16.1" data-path="prog-control.html"><a href="prog-control.html#p-con-exp"><i class="fa fa-check"></i><b>16.1</b> 表达式</a></li>
<li class="chapter" data-level="16.2" data-path="prog-control.html"><a href="prog-control.html#p-con-if"><i class="fa fa-check"></i><b>16.2</b> 分支结构</a><ul>
<li class="chapter" data-level="16.2.1" data-path="prog-control.html"><a href="prog-control.html#p-con-logic-index"><i class="fa fa-check"></i><b>16.2.1</b> 用逻辑下标代替分支结构</a></li>
<li class="chapter" data-level="16.2.2" data-path="prog-control.html"><a href="prog-control.html#p-con-ifelsef"><i class="fa fa-check"></i><b>16.2.2</b> <code>ifelse</code>函数</a></li>
<li class="chapter" data-level="16.2.3" data-path="prog-control.html"><a href="prog-control.html#p-con-switch"><i class="fa fa-check"></i><b>16.2.3</b> <code>switch</code>函数</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="prog-control.html"><a href="prog-control.html#p-con-loop"><i class="fa fa-check"></i><b>16.3</b> 循环结构</a><ul>
<li class="chapter" data-level="16.3.1" data-path="prog-control.html"><a href="prog-control.html#p-con-for"><i class="fa fa-check"></i><b>16.3.1</b> 计数循环</a></li>
<li class="chapter" data-level="16.3.2" data-path="prog-control.html"><a href="prog-control.html#p-con-while"><i class="fa fa-check"></i><b>16.3.2</b> <code>while</code>循环和<code>repeat</code>循环</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="prog-control.html"><a href="prog-control.html#p-con-cond"><i class="fa fa-check"></i><b>16.4</b> R中判断条件</a></li>
<li class="chapter" data-level="16.5" data-path="prog-control.html"><a href="prog-control.html#p-pipe"><i class="fa fa-check"></i><b>16.5</b> 管道控制</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="prog-func.html"><a href="prog-func.html"><i class="fa fa-check"></i><b>17</b> 函数</a><ul>
<li class="chapter" data-level="17.1" data-path="prog-func.html"><a href="prog-func.html#p-func"><i class="fa fa-check"></i><b>17.1</b> 函数基础</a><ul>
<li class="chapter" data-level="17.1.1" data-path="prog-func.html"><a href="prog-func.html#p-func-intro"><i class="fa fa-check"></i><b>17.1.1</b> 介绍</a></li>
<li class="chapter" data-level="17.1.2" data-path="prog-func.html"><a href="prog-func.html#p-func-def"><i class="fa fa-check"></i><b>17.1.2</b> 函数定义</a></li>
<li class="chapter" data-level="17.1.3" data-path="prog-func.html"><a href="prog-func.html#p-func-call"><i class="fa fa-check"></i><b>17.1.3</b> 函数调用</a></li>
<li class="chapter" data-level="17.1.4" data-path="prog-func.html"><a href="prog-func.html#p-func-recursive"><i class="fa fa-check"></i><b>17.1.4</b> 递归调用</a></li>
<li class="chapter" data-level="17.1.5" data-path="prog-func.html"><a href="prog-func.html#p-func-vr"><i class="fa fa-check"></i><b>17.1.5</b> 向量化</a></li>
<li class="chapter" data-level="17.1.6" data-path="prog-func.html"><a href="prog-func.html#p-func-anonymf"><i class="fa fa-check"></i><b>17.1.6</b> 无名函数</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="prog-func.html"><a href="prog-func.html#p-func-space"><i class="fa fa-check"></i><b>17.2</b> 变量作用域</a><ul>
<li class="chapter" data-level="17.2.1" data-path="prog-func.html"><a href="prog-func.html#p-func-global"><i class="fa fa-check"></i><b>17.2.1</b> 全局变量和工作空间</a></li>
<li class="chapter" data-level="17.2.2" data-path="prog-func.html"><a href="prog-func.html#p-func-local"><i class="fa fa-check"></i><b>17.2.2</b> 局部变量</a></li>
<li class="chapter" data-level="17.2.3" data-path="prog-func.html"><a href="prog-func.html#p-func-global-access"><i class="fa fa-check"></i><b>17.2.3</b> 在函数内访问全局变量</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="prog-prof.html"><a href="prog-prof.html"><i class="fa fa-check"></i><b>18</b> R程序效率</a><ul>
<li class="chapter" data-level="18.1" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-effic"><i class="fa fa-check"></i><b>18.1</b> R的运行效率</a></li>
<li class="chapter" data-level="18.2" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-vect"><i class="fa fa-check"></i><b>18.2</b> 向量化编程</a><ul>
<li class="chapter" data-level="18.2.1" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-vect-ex1"><i class="fa fa-check"></i><b>18.2.1</b> 示例1</a></li>
<li class="chapter" data-level="18.2.2" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-vect-ex2"><i class="fa fa-check"></i><b>18.2.2</b> 示例2</a></li>
<li class="chapter" data-level="18.2.3" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-vect-ex3"><i class="fa fa-check"></i><b>18.2.3</b> 示例3</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-loop"><i class="fa fa-check"></i><b>18.3</b> 减少显式循环</a><ul>
<li class="chapter" data-level="18.3.1" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-replicate"><i class="fa fa-check"></i><b>18.3.1</b> <code>replicate()</code>函数</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-copy"><i class="fa fa-check"></i><b>18.4</b> 避免制作副本</a></li>
<li class="chapter" data-level="18.5" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-mathfun"><i class="fa fa-check"></i><b>18.5</b> R的计算函数</a><ul>
<li class="chapter" data-level="18.5.1" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-mathfun-math"><i class="fa fa-check"></i><b>18.5.1</b> 数学函数</a></li>
<li class="chapter" data-level="18.5.2" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-mathfun-sum"><i class="fa fa-check"></i><b>18.5.2</b> 概括函数</a></li>
<li class="chapter" data-level="18.5.3" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-mathfun-max"><i class="fa fa-check"></i><b>18.5.3</b> 最值</a></li>
<li class="chapter" data-level="18.5.4" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-mathfun-sort"><i class="fa fa-check"></i><b>18.5.4</b> 排序</a></li>
<li class="chapter" data-level="18.5.5" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-mathfun-integrate"><i class="fa fa-check"></i><b>18.5.5</b> 一元定积分<code>integrate</code></a></li>
<li class="chapter" data-level="18.5.6" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-mathfun-uniroot"><i class="fa fa-check"></i><b>18.5.6</b> 一元函数求根<code>uniroot</code></a></li>
<li class="chapter" data-level="18.5.7" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-mathfun-fft"><i class="fa fa-check"></i><b>18.5.7</b> 离散傅立叶变换<code>fft</code></a></li>
<li class="chapter" data-level="18.5.8" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-mathfun-filter"><i class="fa fa-check"></i><b>18.5.8</b> 用<code>filter</code>函数作迭代</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-mcpu"><i class="fa fa-check"></i><b>18.6</b> 并行计算</a><ul>
<li class="chapter" data-level="18.6.1" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-mcpu-ex1"><i class="fa fa-check"></i><b>18.6.1</b> 例1：完全不互相依赖的并行运算</a></li>
<li class="chapter" data-level="18.6.2" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-mcpu-ex2"><i class="fa fa-check"></i><b>18.6.2</b> 例2：使用相同随机数序列的并行计算</a></li>
<li class="chapter" data-level="18.6.3" data-path="prog-prof.html"><a href="prog-prof.html#p-prof-mcpu-ex3"><i class="fa fa-check"></i><b>18.6.3</b> 例3：使用独立随机数序列的并行计算</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="p-advfunc.html"><a href="p-advfunc.html"><i class="fa fa-check"></i><b>19</b> 函数进阶</a><ul>
<li class="chapter" data-level="19.1" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-callspe"><i class="fa fa-check"></i><b>19.1</b> 函数调用的各种形式</a></li>
<li class="chapter" data-level="19.2" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-lex"><i class="fa fa-check"></i><b>19.2</b> 嵌套定义与句法作用域(lexical scoping)</a></li>
<li class="chapter" data-level="19.3" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-inner"><i class="fa fa-check"></i><b>19.3</b> 辅助嵌套函数</a></li>
<li class="chapter" data-level="19.4" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-lazy"><i class="fa fa-check"></i><b>19.4</b> 懒惰求值</a></li>
<li class="chapter" data-level="19.5" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-debug"><i class="fa fa-check"></i><b>19.5</b> 程序调试</a><ul>
<li class="chapter" data-level="19.5.1" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-debug-intro"><i class="fa fa-check"></i><b>19.5.1</b> 基本调试策略</a></li>
<li class="chapter" data-level="19.5.2" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-debug-findfunc"><i class="fa fa-check"></i><b>19.5.2</b> 找到出错的函数</a></li>
<li class="chapter" data-level="19.5.3" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-debug-browser"><i class="fa fa-check"></i><b>19.5.3</b> 跟踪调试</a></li>
<li class="chapter" data-level="19.5.4" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-debug-cond"><i class="fa fa-check"></i><b>19.5.4</b> 条件断点</a></li>
<li class="chapter" data-level="19.5.5" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-debug-debugf"><i class="fa fa-check"></i><b>19.5.5</b> 开启对一个函数的调试</a></li>
<li class="chapter" data-level="19.5.6" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-debug-opt"><i class="fa fa-check"></i><b>19.5.6</b> 出错调试选项</a></li>
<li class="chapter" data-level="19.5.7" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-debug-stop"><i class="fa fa-check"></i><b>19.5.7</b> <code>stop()</code>、<code>warning()</code>、<code>message()</code></a></li>
<li class="chapter" data-level="19.5.8" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-debug-preventive"><i class="fa fa-check"></i><b>19.5.8</b> 预防性设计</a></li>
<li class="chapter" data-level="19.5.9" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-debug-try"><i class="fa fa-check"></i><b>19.5.9</b> 出错处理机制</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-funcprog"><i class="fa fa-check"></i><b>19.6</b> 函数式编程介绍</a><ul>
<li class="chapter" data-level="19.6.1" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-pure"><i class="fa fa-check"></i><b>19.6.1</b> 纯函数</a></li>
<li class="chapter" data-level="19.6.2" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-rec"><i class="fa fa-check"></i><b>19.6.2</b> 副作用和运行环境恢复</a></li>
<li class="chapter" data-level="19.6.3" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-rsupp"><i class="fa fa-check"></i><b>19.6.3</b> R的函数式编程功能</a></li>
</ul></li>
<li class="chapter" data-level="19.7" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-functional"><i class="fa fa-check"></i><b>19.7</b> 泛函</a><ul>
<li class="chapter" data-level="19.7.1" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-fnctnl-map"><i class="fa fa-check"></i><b>19.7.1</b> <code>purrr::map</code>函数</a></li>
<li class="chapter" data-level="19.7.2" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-fnctnl-mapv"><i class="fa fa-check"></i><b>19.7.2</b> purrr包中<code>map</code>函数的变种</a></li>
<li class="chapter" data-level="19.7.3" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-fnctnl-reduce"><i class="fa fa-check"></i><b>19.7.3</b> purrr包中<code>reduce</code>类函数</a></li>
<li class="chapter" data-level="19.7.4" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-fnctnl-pred"><i class="fa fa-check"></i><b>19.7.4</b> purrr包中使用示性函数的泛函</a></li>
<li class="chapter" data-level="19.7.5" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-fnctnl-lapp"><i class="fa fa-check"></i><b>19.7.5</b> 基本R的函数式编程支持</a></li>
<li class="chapter" data-level="19.7.6" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-fnctnl-udef"><i class="fa fa-check"></i><b>19.7.6</b> 自定义泛函</a></li>
</ul></li>
<li class="chapter" data-level="19.8" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-factory"><i class="fa fa-check"></i><b>19.8</b> 函数工厂</a><ul>
<li class="chapter" data-level="19.8.1" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-factory-clex"><i class="fa fa-check"></i><b>19.8.1</b> 闭包例子</a></li>
<li class="chapter" data-level="19.8.2" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-factory-lazy"><i class="fa fa-check"></i><b>19.8.2</b> 动态查找和懒惰求值引起的问题</a></li>
<li class="chapter" data-level="19.8.3" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-factory-mem"><i class="fa fa-check"></i><b>19.8.3</b> 函数工厂的内存负担</a></li>
<li class="chapter" data-level="19.8.4" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-operator"><i class="fa fa-check"></i><b>19.8.4</b> 函数算子</a></li>
</ul></li>
<li class="chapter" data-level="19.9" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-env"><i class="fa fa-check"></i><b>19.9</b> 环境</a><ul>
<li class="chapter" data-level="19.9.1" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-env-def"><i class="fa fa-check"></i><b>19.9.1</b> 基本概念</a></li>
<li class="chapter" data-level="19.9.2" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-env-recurs"><i class="fa fa-check"></i><b>19.9.2</b> 逐层向上访问环境</a></li>
<li class="chapter" data-level="19.9.3" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-env-spec"><i class="fa fa-check"></i><b>19.9.3</b> 特殊环境</a></li>
<li class="chapter" data-level="19.9.4" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-env-callst"><i class="fa fa-check"></i><b>19.9.4</b> 调用栈</a></li>
<li class="chapter" data-level="19.9.5" data-path="p-advfunc.html"><a href="p-advfunc.html#p-advfunc-env-usedt"><i class="fa fa-check"></i><b>19.9.5</b> 将环境用作一般数据结构</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV 制作研究报告和图书</b></span></li>
<li class="chapter" data-level="20" data-path="knitr.html"><a href="knitr.html"><i class="fa fa-check"></i><b>20</b> 用R制作研究报告</a></li>
<li class="chapter" data-level="21" data-path="markdown.html"><a href="markdown.html"><i class="fa fa-check"></i><b>21</b> Markdown格式</a><ul>
<li class="chapter" data-level="21.1" data-path="markdown.html"><a href="markdown.html#markdown-intro"><i class="fa fa-check"></i><b>21.1</b> 介绍</a></li>
<li class="chapter" data-level="21.2" data-path="markdown.html"><a href="markdown.html#markdown-app"><i class="fa fa-check"></i><b>21.2</b> Markdown格式文件的应用</a></li>
<li class="chapter" data-level="21.3" data-path="markdown.html"><a href="markdown.html#markdown-format"><i class="fa fa-check"></i><b>21.3</b> markdown格式说明</a><ul>
<li class="chapter" data-level="21.3.1" data-path="markdown.html"><a href="markdown.html#markdown-format-intro"><i class="fa fa-check"></i><b>21.3.1</b> 概述</a></li>
<li class="chapter" data-level="21.3.2" data-path="markdown.html"><a href="markdown.html#markdown-format-paragraph"><i class="fa fa-check"></i><b>21.3.2</b> 段落</a></li>
<li class="chapter" data-level="21.3.3" data-path="markdown.html"><a href="markdown.html#markdown-format-inline"><i class="fa fa-check"></i><b>21.3.3</b> 段内文字格式</a></li>
<li class="chapter" data-level="21.3.4" data-path="markdown.html"><a href="markdown.html#markdown-format-header"><i class="fa fa-check"></i><b>21.3.4</b> 标题和分隔线</a></li>
<li class="chapter" data-level="21.3.5" data-path="markdown.html"><a href="markdown.html#markdown-format-cite"><i class="fa fa-check"></i><b>21.3.5</b> 引用段落</a></li>
<li class="chapter" data-level="21.3.6" data-path="markdown.html"><a href="markdown.html#markdown-format-list"><i class="fa fa-check"></i><b>21.3.6</b> 列表</a></li>
<li class="chapter" data-level="21.3.7" data-path="markdown.html"><a href="markdown.html#markdown-format-code"><i class="fa fa-check"></i><b>21.3.7</b> 源程序</a></li>
<li class="chapter" data-level="21.3.8" data-path="markdown.html"><a href="markdown.html#markdown-format-link"><i class="fa fa-check"></i><b>21.3.8</b> 链接</a></li>
<li class="chapter" data-level="21.3.9" data-path="markdown.html"><a href="markdown.html#markdown-format-fig"><i class="fa fa-check"></i><b>21.3.9</b> 插入图形</a></li>
<li class="chapter" data-level="21.3.10" data-path="markdown.html"><a href="markdown.html#markdown-format-table"><i class="fa fa-check"></i><b>21.3.10</b> 表格</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="markdown.html"><a href="markdown.html#markdown-pandoc"><i class="fa fa-check"></i><b>21.4</b> 附录：pandoc软件介绍</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="rmarkdown.html"><a href="rmarkdown.html"><i class="fa fa-check"></i><b>22</b> R Markdown文件格式</a><ul>
<li class="chapter" data-level="22.1" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-intro"><i class="fa fa-check"></i><b>22.1</b> R Markdown文件</a></li>
<li class="chapter" data-level="22.2" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-compile"><i class="fa fa-check"></i><b>22.2</b> R Markdown文件的编译</a><ul>
<li class="chapter" data-level="22.2.1" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-compile-proc"><i class="fa fa-check"></i><b>22.2.1</b> 编译的实际过程</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-rcode"><i class="fa fa-check"></i><b>22.3</b> 在R Markdown文件中插入R代码</a></li>
<li class="chapter" data-level="22.4" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-kable"><i class="fa fa-check"></i><b>22.4</b> 输出表格</a></li>
<li class="chapter" data-level="22.5" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-graph"><i class="fa fa-check"></i><b>22.5</b> 利用R程序插图</a></li>
<li class="chapter" data-level="22.6" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-rcode-opt"><i class="fa fa-check"></i><b>22.6</b> 代码段选项</a><ul>
<li class="chapter" data-level="22.6.1" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-rcode-outformat"><i class="fa fa-check"></i><b>22.6.1</b> 代码和文本输出结果格式</a></li>
<li class="chapter" data-level="22.6.2" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-rcode-figopt"><i class="fa fa-check"></i><b>22.6.2</b> 图形选项</a></li>
<li class="chapter" data-level="22.6.3" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-rcode-cache"><i class="fa fa-check"></i><b>22.6.3</b> 缓存(cache)选项</a></li>
</ul></li>
<li class="chapter" data-level="22.7" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd--sectionlink"><i class="fa fa-check"></i><b>22.7</b> 章节目录链接问题</a></li>
<li class="chapter" data-level="22.8" data-path="rmarkdown.html"><a href="rmarkdown.html#markdown-formula"><i class="fa fa-check"></i><b>22.8</b> 数学公式</a><ul>
<li class="chapter" data-level="22.8.1" data-path="rmarkdown.html"><a href="rmarkdown.html#markdown-formula-intro"><i class="fa fa-check"></i><b>22.8.1</b> 在Markdown中输入数学公式</a></li>
<li class="chapter" data-level="22.8.2" data-path="rmarkdown.html"><a href="rmarkdown.html#markdown-formula-type"><i class="fa fa-check"></i><b>22.8.2</b> 数学公式类别</a></li>
<li class="chapter" data-level="22.8.3" data-path="rmarkdown.html"><a href="rmarkdown.html#markdown-formula-basic"><i class="fa fa-check"></i><b>22.8.3</b> 基本功能</a></li>
<li class="chapter" data-level="22.8.4" data-path="rmarkdown.html"><a href="rmarkdown.html#markdown-formula-accent"><i class="fa fa-check"></i><b>22.8.4</b> 修饰符</a></li>
<li class="chapter" data-level="22.8.5" data-path="rmarkdown.html"><a href="rmarkdown.html#markdown-formula-align"><i class="fa fa-check"></i><b>22.8.5</b> 对齐与矩阵</a></li>
<li class="chapter" data-level="22.8.6" data-path="rmarkdown.html"><a href="rmarkdown.html#markdown-formula-fonts"><i class="fa fa-check"></i><b>22.8.6</b> 特殊字体</a></li>
</ul></li>
<li class="chapter" data-level="22.9" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-engines"><i class="fa fa-check"></i><b>22.9</b> 其它编程语言引擎</a></li>
<li class="chapter" data-level="22.10" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-interact"><i class="fa fa-check"></i><b>22.10</b> 交互内容</a></li>
<li class="chapter" data-level="22.11" data-path="rmarkdown.html"><a href="rmarkdown.html#rmarkdown-attryaml"><i class="fa fa-check"></i><b>22.11</b> 属性设置</a><ul>
<li class="chapter" data-level="22.11.1" data-path="rmarkdown.html"><a href="rmarkdown.html#rmarkdown-yaml"><i class="fa fa-check"></i><b>22.11.1</b> YAML元数据</a></li>
<li class="chapter" data-level="22.11.2" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-output-types"><i class="fa fa-check"></i><b>22.11.2</b> 输出格式</a></li>
<li class="chapter" data-level="22.11.3" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-output-attr"><i class="fa fa-check"></i><b>22.11.3</b> 输出格式设置</a></li>
<li class="chapter" data-level="22.11.4" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-output-attr-toc"><i class="fa fa-check"></i><b>22.11.4</b> 目录设置</a></li>
<li class="chapter" data-level="22.11.5" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-output-attr-numsec"><i class="fa fa-check"></i><b>22.11.5</b> 章节自动编号</a></li>
<li class="chapter" data-level="22.11.6" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-output-attr-wordnumsec"><i class="fa fa-check"></i><b>22.11.6</b> Word输出章节自动编号及模板功能</a></li>
<li class="chapter" data-level="22.11.7" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-output-htmlspecific"><i class="fa fa-check"></i><b>22.11.7</b> HTML特有输出格式设置</a></li>
<li class="chapter" data-level="22.11.8" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-mathjax"><i class="fa fa-check"></i><b>22.11.8</b> 关于数学公式支持的设置</a></li>
<li class="chapter" data-level="22.11.9" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-output-yml"><i class="fa fa-check"></i><b>22.11.9</b> 输出设置文件</a></li>
</ul></li>
<li class="chapter" data-level="22.12" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-latex"><i class="fa fa-check"></i><b>22.12</b> LaTeX和PDF输出</a><ul>
<li class="chapter" data-level="22.12.1" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-latex-tinytex"><i class="fa fa-check"></i><b>22.12.1</b> TinyTex的安装使用</a></li>
<li class="chapter" data-level="22.12.2" data-path="rmarkdown.html"><a href="rmarkdown.html#rmd-latex-yaml"><i class="fa fa-check"></i><b>22.12.2</b> Rmd中Latex设置</a></li>
</ul></li>
<li class="chapter" data-level="22.13" data-path="rmarkdown.html"><a href="rmarkdown.html#rmarkdown-rticles"><i class="fa fa-check"></i><b>22.13</b> 生成期刊文章</a></li>
<li class="chapter" data-level="22.14" data-path="rmarkdown.html"><a href="rmarkdown.html#rmarkdown-app1"><i class="fa fa-check"></i><b>22.14</b> 附录：经验与问题</a><ul>
<li class="chapter" data-level="22.14.1" data-path="rmarkdown.html"><a href="rmarkdown.html#rmarkdown-app1-wordtemplate"><i class="fa fa-check"></i><b>22.14.1</b> Word模板制作</a></li>
<li class="chapter" data-level="22.14.2" data-path="rmarkdown.html"><a href="rmarkdown.html#rmarkdown-app1-math"><i class="fa fa-check"></i><b>22.14.2</b> 数学公式设置补充</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="bookdown.html"><a href="bookdown.html"><i class="fa fa-check"></i><b>23</b> 用bookdown制作图书</a><ul>
<li class="chapter" data-level="23.1" data-path="bookdown.html"><a href="bookdown.html#bookdown-intro"><i class="fa fa-check"></i><b>23.1</b> 介绍</a></li>
<li class="chapter" data-level="23.2" data-path="bookdown.html"><a href="bookdown.html#bookdown-settings"><i class="fa fa-check"></i><b>23.2</b> 一本书的设置</a></li>
<li class="chapter" data-level="23.3" data-path="bookdown.html"><a href="bookdown.html#bookdown-sectioning"><i class="fa fa-check"></i><b>23.3</b> 章节结构</a></li>
<li class="chapter" data-level="23.4" data-path="bookdown.html"><a href="bookdown.html#bookdown-compile"><i class="fa fa-check"></i><b>23.4</b> 书的编译</a></li>
<li class="chapter" data-level="23.5" data-path="bookdown.html"><a href="bookdown.html#bookdown-cref"><i class="fa fa-check"></i><b>23.5</b> 交叉引用</a></li>
<li class="chapter" data-level="23.6" data-path="bookdown.html"><a href="bookdown.html#bookdown-formula"><i class="fa fa-check"></i><b>23.6</b> 数学公式和公式编号</a></li>
<li class="chapter" data-level="23.7" data-path="bookdown.html"><a href="bookdown.html#bookdown-theorem"><i class="fa fa-check"></i><b>23.7</b> 定理类编号</a></li>
<li class="chapter" data-level="23.8" data-path="bookdown.html"><a href="bookdown.html#bookdown-bib"><i class="fa fa-check"></i><b>23.8</b> 文献引用</a></li>
<li class="chapter" data-level="23.9" data-path="bookdown.html"><a href="bookdown.html#bookdown-graph"><i class="fa fa-check"></i><b>23.9</b> 插图</a></li>
<li class="chapter" data-level="23.10" data-path="bookdown.html"><a href="bookdown.html#bookdown-table"><i class="fa fa-check"></i><b>23.10</b> 表格</a><ul>
<li class="chapter" data-level="23.10.1" data-path="bookdown.html"><a href="bookdown.html#bookdown-table-md"><i class="fa fa-check"></i><b>23.10.1</b> Markdown表格</a></li>
<li class="chapter" data-level="23.10.2" data-path="bookdown.html"><a href="bookdown.html#bookdown-table-kable"><i class="fa fa-check"></i><b>23.10.2</b> 用<code>kable()</code>函数制作表格</a></li>
<li class="chapter" data-level="23.10.3" data-path="bookdown.html"><a href="bookdown.html#bookdown-table-kable"><i class="fa fa-check"></i><b>23.10.3</b> R中其它制作表格的包</a></li>
</ul></li>
<li class="chapter" data-level="23.11" data-path="bookdown.html"><a href="bookdown.html#bookdown-mathjax"><i class="fa fa-check"></i><b>23.11</b> 数学公式的设置</a></li>
<li class="chapter" data-level="23.12" data-path="bookdown.html"><a href="bookdown.html#bookdown-exp"><i class="fa fa-check"></i><b>23.12</b> 使用经验</a></li>
<li class="chapter" data-level="23.13" data-path="bookdown.html"><a href="bookdown.html#bookdown-bugs"><i class="fa fa-check"></i><b>23.13</b> bookdown的一些使用问题</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="rmdsite.html"><a href="rmdsite.html"><i class="fa fa-check"></i><b>24</b> 用R Markdown制作简易网站</a><ul>
<li class="chapter" data-level="24.1" data-path="rmdsite.html"><a href="rmdsite.html#rmdsite-intro"><i class="fa fa-check"></i><b>24.1</b> 介绍</a></li>
<li class="chapter" data-level="24.2" data-path="rmdsite.html"><a href="rmdsite.html#rmdsite-rmarkdown"><i class="fa fa-check"></i><b>24.2</b> 简易网站制作</a><ul>
<li class="chapter" data-level="24.2.1" data-path="rmdsite.html"><a href="rmdsite.html#rmdsite-rmarkdown-struct"><i class="fa fa-check"></i><b>24.2.1</b> 网站结构</a></li>
<li class="chapter" data-level="24.2.2" data-path="rmdsite.html"><a href="rmdsite.html#rmdsite-rmarkdown-build"><i class="fa fa-check"></i><b>24.2.2</b> 编译</a></li>
<li class="chapter" data-level="24.2.3" data-path="rmdsite.html"><a href="rmdsite.html#rmdsite-rmarkdown-pages"><i class="fa fa-check"></i><b>24.2.3</b> 内容文件</a></li>
<li class="chapter" data-level="24.2.4" data-path="rmdsite.html"><a href="rmdsite.html#rmdsite-rmarkdown-config"><i class="fa fa-check"></i><b>24.2.4</b> 网站设置</a></li>
</ul></li>
<li class="chapter" data-level="24.3" data-path="rmdsite.html"><a href="rmdsite.html#blogdown"><i class="fa fa-check"></i><b>24.3</b> 用blogdown制作网站</a><ul>
<li class="chapter" data-level="24.3.1" data-path="rmdsite.html"><a href="rmdsite.html#blogd-new"><i class="fa fa-check"></i><b>24.3.1</b> 生成新网站的框架</a></li>
<li class="chapter" data-level="24.3.2" data-path="rmdsite.html"><a href="rmdsite.html#blogd-page"><i class="fa fa-check"></i><b>24.3.2</b> 网页内容文件及其设置</a></li>
<li class="chapter" data-level="24.3.3" data-path="rmdsite.html"><a href="rmdsite.html#blogd-workflow"><i class="fa fa-check"></i><b>24.3.3</b> 初学者的工作流程</a></li>
<li class="chapter" data-level="24.3.4" data-path="rmdsite.html"><a href="rmdsite.html#blogd-config"><i class="fa fa-check"></i><b>24.3.4</b> 网站设置文件</a></li>
<li class="chapter" data-level="24.3.5" data-path="rmdsite.html"><a href="rmdsite.html#blogd-static"><i class="fa fa-check"></i><b>24.3.5</b> 静态文件</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="25" data-path="slides.html"><a href="slides.html"><i class="fa fa-check"></i><b>25</b> 制作幻灯片</a><ul>
<li class="chapter" data-level="25.1" data-path="slides.html"><a href="slides.html#rmd-slides-intro"><i class="fa fa-check"></i><b>25.1</b> 介绍</a></li>
<li class="chapter" data-level="25.2" data-path="slides.html"><a href="slides.html#rmd-slidy"><i class="fa fa-check"></i><b>25.2</b> Slidy幻灯片</a><ul>
<li class="chapter" data-level="25.2.1" data-path="slides.html"><a href="slides.html#rmd-slidy-format"><i class="fa fa-check"></i><b>25.2.1</b> 文件格式</a></li>
<li class="chapter" data-level="25.2.2" data-path="slides.html"><a href="slides.html#rmd-slidy-compile"><i class="fa fa-check"></i><b>25.2.2</b> 幻灯片编译</a></li>
<li class="chapter" data-level="25.2.3" data-path="slides.html"><a href="slides.html#rmd-slidy-play"><i class="fa fa-check"></i><b>25.2.3</b> 播放控制</a></li>
<li class="chapter" data-level="25.2.4" data-path="slides.html"><a href="slides.html#rmd-slidy-handout"><i class="fa fa-check"></i><b>25.2.4</b> 生成单页HTML</a></li>
<li class="chapter" data-level="25.2.5" data-path="slides.html"><a href="slides.html#rmd-slidy-mathjax"><i class="fa fa-check"></i><b>25.2.5</b> 数学公式处理与输出设置文件</a></li>
<li class="chapter" data-level="25.2.6" data-path="slides.html"><a href="slides.html#rmd-slidy-options"><i class="fa fa-check"></i><b>25.2.6</b> 其它选项</a></li>
<li class="chapter" data-level="25.2.7" data-path="slides.html"><a href="slides.html#rmd-slidy-laser"><i class="fa fa-check"></i><b>25.2.7</b> slidy幻灯片激光笔失效问题的修改</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="slides.html"><a href="slides.html#rmdslides-pp"><i class="fa fa-check"></i><b>25.3</b> MS PowerPoint幻灯片</a></li>
<li class="chapter" data-level="25.4" data-path="slides.html"><a href="slides.html#rmdslides-beamer"><i class="fa fa-check"></i><b>25.4</b> Bearmer幻灯片格式</a></li>
<li class="chapter" data-level="25.5" data-path="slides.html"><a href="slides.html#rmdslides-rpres"><i class="fa fa-check"></i><b>25.5</b> R Presentation格式</a></li>
</ul></li>
<li class="part"><span><b>V 数据整理与汇总</b></span></li>
<li class="chapter" data-level="26" data-path="summary-manip.html"><a href="summary-manip.html"><i class="fa fa-check"></i><b>26</b> 数据整理</a><ul>
<li class="chapter" data-level="26.1" data-path="summary-manip.html"><a href="summary-manip.html#summm-tidyv"><i class="fa fa-check"></i><b>26.1</b> tidyverse系统</a></li>
<li class="chapter" data-level="26.2" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-filter"><i class="fa fa-check"></i><b>26.2</b> 用<code>filter()</code>选择行子集</a></li>
<li class="chapter" data-level="26.3" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-head"><i class="fa fa-check"></i><b>26.3</b> 按行序号选择行子集</a></li>
<li class="chapter" data-level="26.4" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-samplen"><i class="fa fa-check"></i><b>26.4</b> 用<code>sample_n()</code>对观测随机抽样</a></li>
<li class="chapter" data-level="26.5" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-distinct"><i class="fa fa-check"></i><b>26.5</b> 用<code>distinct()</code>去除重复行</a></li>
<li class="chapter" data-level="26.6" data-path="summary-manip.html"><a href="summary-manip.html#tidyr-dropna"><i class="fa fa-check"></i><b>26.6</b> 用<code>drop_na()</code>去除指定的变量有缺失值的行</a></li>
<li class="chapter" data-level="26.7" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-select"><i class="fa fa-check"></i><b>26.7</b> 用<code>select()</code>选择列子集</a></li>
<li class="chapter" data-level="26.8" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-pull"><i class="fa fa-check"></i><b>26.8</b> 取出单个变量为向量</a></li>
<li class="chapter" data-level="26.9" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-arrange"><i class="fa fa-check"></i><b>26.9</b> 用<code>arrange()</code>排序</a></li>
<li class="chapter" data-level="26.10" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-rename"><i class="fa fa-check"></i><b>26.10</b> 用<code>rename()</code>修改变量名</a></li>
<li class="chapter" data-level="26.11" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-mutate"><i class="fa fa-check"></i><b>26.11</b> 用<code>mutate()</code>计算新变量</a></li>
<li class="chapter" data-level="26.12" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-transmute"><i class="fa fa-check"></i><b>26.12</b> 用<code>tranmute()</code>生成新变量的数据框</a></li>
<li class="chapter" data-level="26.13" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-pipe"><i class="fa fa-check"></i><b>26.13</b> 用管道连接多次操作</a></li>
<li class="chapter" data-level="26.14" data-path="summary-manip.html"><a href="summary-manip.html#tidyr-longer"><i class="fa fa-check"></i><b>26.14</b> 宽表转换为长表</a><ul>
<li class="chapter" data-level="26.14.1" data-path="summary-manip.html"><a href="summary-manip.html#tidyr-longer-pl"><i class="fa fa-check"></i><b>26.14.1</b> <code>pivot_longer</code>函数</a></li>
<li class="chapter" data-level="26.14.2" data-path="summary-manip.html"><a href="summary-manip.html#tidyr-longer-prefixvalue"><i class="fa fa-check"></i><b>26.14.2</b> 从列名中提取数值</a></li>
<li class="chapter" data-level="26.14.3" data-path="summary-manip.html"><a href="summary-manip.html#tidyr-longer-colnamemultclassv"><i class="fa fa-check"></i><b>26.14.3</b> 从列名中提取多个分类变量值</a></li>
<li class="chapter" data-level="26.14.4" data-path="summary-manip.html"><a href="summary-manip.html#tidyr-longer-multvarsmultclassv"><i class="fa fa-check"></i><b>26.14.4</b> 一行中有多个属性的多次观测的情形</a></li>
</ul></li>
<li class="chapter" data-level="26.15" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-wider"><i class="fa fa-check"></i><b>26.15</b> 长表转换为宽表</a><ul>
<li class="chapter" data-level="26.15.1" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-wider-sepvars"><i class="fa fa-check"></i><b>26.15.1</b> 将多个混在一起的变量拆开</a></li>
<li class="chapter" data-level="26.15.2" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-wider-combtimes"><i class="fa fa-check"></i><b>26.15.2</b> 将多个类别合并到一个观测</a></li>
<li class="chapter" data-level="26.15.3" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-wider-combcross"><i class="fa fa-check"></i><b>26.15.3</b> 将交叉类别合并到一个观测</a></li>
<li class="chapter" data-level="26.15.4" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-wider-mvmest"><i class="fa fa-check"></i><b>26.15.4</b> 多个变量的多种值</a></li>
<li class="chapter" data-level="26.15.5" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-wider-mixed"><i class="fa fa-check"></i><b>26.15.5</b> 长宽转换混合使用</a></li>
</ul></li>
<li class="chapter" data-level="26.16" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-spearate"><i class="fa fa-check"></i><b>26.16</b> 拆分数据列</a></li>
<li class="chapter" data-level="26.17" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-unite"><i class="fa fa-check"></i><b>26.17</b> 合并数据列</a></li>
<li class="chapter" data-level="26.18" data-path="summary-manip.html"><a href="summary-manip.html#summ-trans-combv"><i class="fa fa-check"></i><b>26.18</b> 数据框纵向合并</a></li>
<li class="chapter" data-level="26.19" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-join"><i class="fa fa-check"></i><b>26.19</b> 横向合并</a></li>
<li class="chapter" data-level="26.20" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-semi"><i class="fa fa-check"></i><b>26.20</b> 利用第二个数据集筛选</a></li>
<li class="chapter" data-level="26.21" data-path="summary-manip.html"><a href="summary-manip.html#dplyr-set"><i class="fa fa-check"></i><b>26.21</b> 数据集的集合操作</a></li>
<li class="chapter" data-level="26.22" data-path="summary-manip.html"><a href="summary-manip.html#summ-trans-standard"><i class="fa fa-check"></i><b>26.22</b> 标准化</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="summary-summ.html"><a href="summary-summ.html"><i class="fa fa-check"></i><b>27</b> 数据汇总</a><ul>
<li class="chapter" data-level="27.1" data-path="summary-summ.html"><a href="summary-summ.html#dplyr-summ"><i class="fa fa-check"></i><b>27.1</b> 用dplyr作数据汇总</a></li>
<li class="chapter" data-level="27.2" data-path="summary-summ.html"><a href="summary-summ.html#dplyr-summat"><i class="fa fa-check"></i><b>27.2</b> 多个变量的汇总</a></li>
<li class="chapter" data-level="27.3" data-path="summary-summ.html"><a href="summary-summ.html#dplyr-groupby"><i class="fa fa-check"></i><b>27.3</b> 用dplyr作数据分组汇总</a></li>
<li class="chapter" data-level="27.4" data-path="summary-summ.html"><a href="summary-summ.html#dplyr-crossgroup"><i class="fa fa-check"></i><b>27.4</b> 交叉分类的汇总</a></li>
<li class="chapter" data-level="27.5" data-path="summary-summ.html"><a href="summary-summ.html#summ-nest"><i class="fa fa-check"></i><b>27.5</b> tibble中的列表列</a><ul>
<li class="chapter" data-level="27.5.1" data-path="summary-summ.html"><a href="summary-summ.html#summ-nest-intro"><i class="fa fa-check"></i><b>27.5.1</b> <code>nest</code>和<code>unnest</code></a></li>
<li class="chapter" data-level="27.5.2" data-path="summary-summ.html"><a href="summary-summ.html#summ-nest-groupby"><i class="fa fa-check"></i><b>27.5.2</b> <code>group_by</code>与<code>nest</code>配合</a></li>
<li class="chapter" data-level="27.5.3" data-path="summary-summ.html"><a href="summary-summ.html#summ-nest-summarise"><i class="fa fa-check"></i><b>27.5.3</b> <code>summarise</code>统计量用列表表示</a></li>
<li class="chapter" data-level="27.5.4" data-path="summary-summ.html"><a href="summary-summ.html#summ-nest-unnest-grammar"><i class="fa fa-check"></i><b>27.5.4</b> <code>unnest</code>的语法格式</a></li>
<li class="chapter" data-level="27.5.5" data-path="summary-summ.html"><a href="summary-summ.html#summ-nest-direct"><i class="fa fa-check"></i><b>27.5.5</b> 直接生成列表类型的列</a></li>
</ul></li>
<li class="chapter" data-level="27.6" data-path="summary-summ.html"><a href="summary-summ.html#summ-base"><i class="fa fa-check"></i><b>27.6</b> 基本R的汇总功能</a><ul>
<li class="chapter" data-level="27.6.1" data-path="summary-summ.html"><a href="summary-summ.html#summ-base-summary"><i class="fa fa-check"></i><b>27.6.1</b> <code>summary()</code>函数</a></li>
<li class="chapter" data-level="27.6.2" data-path="summary-summ.html"><a href="summary-summ.html#summ-cont"><i class="fa fa-check"></i><b>27.6.2</b> 连续型变量概括函数</a></li>
<li class="chapter" data-level="27.6.3" data-path="summary-summ.html"><a href="summary-summ.html#summ-fact"><i class="fa fa-check"></i><b>27.6.3</b> 分类变量概括</a></li>
<li class="chapter" data-level="27.6.4" data-path="summary-summ.html"><a href="summary-summ.html#summ-df"><i class="fa fa-check"></i><b>27.6.4</b> 数据框概括</a></li>
</ul></li>
<li class="chapter" data-level="27.7" data-path="summary-summ.html"><a href="summary-summ.html#summ-by"><i class="fa fa-check"></i><b>27.7</b> 用基本R作分类概括</a><ul>
<li class="chapter" data-level="27.7.1" data-path="summary-summ.html"><a href="summary-summ.html#summ-by-tapply"><i class="fa fa-check"></i><b>27.7.1</b> 用<code>tapply()</code>分组概括向量</a></li>
<li class="chapter" data-level="27.7.2" data-path="summary-summ.html"><a href="summary-summ.html#summ-by-aggregate"><i class="fa fa-check"></i><b>27.7.2</b> 用<code>aggregate()</code>分组概括数据框</a></li>
<li class="chapter" data-level="27.7.3" data-path="summary-summ.html"><a href="summary-summ.html#summ-by-split"><i class="fa fa-check"></i><b>27.7.3</b> 用<code>split()</code>函数分组后概括</a></li>
</ul></li>
<li class="chapter" data-level="27.8" data-path="summary-summ.html"><a href="summary-summ.html#summ-by-plyr"><i class="fa fa-check"></i><b>27.8</b> 用plyr包进行分类概括</a></li>
<li class="chapter" data-level="27.9" data-path="summary-summ.html"><a href="summary-summ.html#summ-by-exer"><i class="fa fa-check"></i><b>27.9</b> 练习</a></li>
</ul></li>
<li class="part"><span><b>VI 绘图</b></span></li>
<li class="chapter" data-level="28" data-path="graph.html"><a href="graph.html"><i class="fa fa-check"></i><b>28</b> 基本R绘图</a><ul>
<li class="chapter" data-level="28.1" data-path="graph.html"><a href="graph.html#graph-ph"><i class="fa fa-check"></i><b>28.1</b> 常用高级图形</a><ul>
<li class="chapter" data-level="28.1.1" data-path="graph.html"><a href="graph.html#graph-ph-barplot"><i class="fa fa-check"></i><b>28.1.1</b> 条形图</a></li>
<li class="chapter" data-level="28.1.2" data-path="graph.html"><a href="graph.html#graph-ph-hist"><i class="fa fa-check"></i><b>28.1.2</b> 直方图和密度估计图</a></li>
<li class="chapter" data-level="28.1.3" data-path="graph.html"><a href="graph.html#graph-ph-boxplot"><i class="fa fa-check"></i><b>28.1.3</b> 盒形图</a></li>
<li class="chapter" data-level="28.1.4" data-path="graph.html"><a href="graph.html#graph-pr-qq"><i class="fa fa-check"></i><b>28.1.4</b> 正态QQ图</a></li>
<li class="chapter" data-level="28.1.5" data-path="graph.html"><a href="graph.html#graph-ph-plot"><i class="fa fa-check"></i><b>28.1.5</b> 散点图</a></li>
<li class="chapter" data-level="28.1.6" data-path="graph.html"><a href="graph.html#graph-ph-curve"><i class="fa fa-check"></i><b>28.1.6</b> 曲线图</a></li>
<li class="chapter" data-level="28.1.7" data-path="graph.html"><a href="graph.html#graph-ph-3d"><i class="fa fa-check"></i><b>28.1.7</b> 三维图</a></li>
<li class="chapter" data-level="28.1.8" data-path="graph.html"><a href="graph.html#graph-ph-rgl"><i class="fa fa-check"></i><b>28.1.8</b> 动态三维图</a></li>
</ul></li>
<li class="chapter" data-level="28.2" data-path="graph.html"><a href="graph.html#graph-pl"><i class="fa fa-check"></i><b>28.2</b> 低级图形函数</a><ul>
<li class="chapter" data-level="28.2.1" data-path="graph.html"><a href="graph.html#graph-pl-abline"><i class="fa fa-check"></i><b>28.2.1</b> <code>abline()</code></a></li>
<li class="chapter" data-level="28.2.2" data-path="graph.html"><a href="graph.html#graph-pl-points"><i class="fa fa-check"></i><b>28.2.2</b> <code>points()</code></a></li>
<li class="chapter" data-level="28.2.3" data-path="graph.html"><a href="graph.html#graph-pl-lines"><i class="fa fa-check"></i><b>28.2.3</b> <code>lines()</code></a></li>
<li class="chapter" data-level="28.2.4" data-path="graph.html"><a href="graph.html#graph-pl-legend"><i class="fa fa-check"></i><b>28.2.4</b> 图例</a></li>
<li class="chapter" data-level="28.2.5" data-path="graph.html"><a href="graph.html#graph-pl-axis"><i class="fa fa-check"></i><b>28.2.5</b> <code>axis()</code></a></li>
<li class="chapter" data-level="28.2.6" data-path="graph.html"><a href="graph.html#graph-pl-text"><i class="fa fa-check"></i><b>28.2.6</b> <code>text()</code></a></li>
<li class="chapter" data-level="28.2.7" data-path="graph.html"><a href="graph.html#graph-pl-locator"><i class="fa fa-check"></i><b>28.2.7</b> <code>locator()</code>和<code>identify()</code></a></li>
</ul></li>
<li class="chapter" data-level="28.3" data-path="graph.html"><a href="graph.html#graph-par"><i class="fa fa-check"></i><b>28.3</b> 图形参数</a><ul>
<li class="chapter" data-level="28.3.1" data-path="graph.html"><a href="graph.html#graph-par-ex1"><i class="fa fa-check"></i><b>28.3.1</b> 例子：用图形参数解决barplot图形横坐标值过宽</a></li>
<li class="chapter" data-level="28.3.2" data-path="graph.html"><a href="graph.html#graph-par-elem"><i class="fa fa-check"></i><b>28.3.2</b> 图形元素控制</a></li>
<li class="chapter" data-level="28.3.3" data-path="graph.html"><a href="graph.html#graph-par-axis"><i class="fa fa-check"></i><b>28.3.3</b> 坐标轴与坐标刻度</a></li>
<li class="chapter" data-level="28.3.4" data-path="graph.html"><a href="graph.html#graph-par-mar"><i class="fa fa-check"></i><b>28.3.4</b> 图形边空</a></li>
<li class="chapter" data-level="28.3.5" data-path="graph.html"><a href="graph.html#graph-par-mfrow"><i class="fa fa-check"></i><b>28.3.5</b> 一页多图</a></li>
</ul></li>
<li class="chapter" data-level="28.4" data-path="graph.html"><a href="graph.html#graph-pout"><i class="fa fa-check"></i><b>28.4</b> 图形输出</a><ul>
<li class="chapter" data-level="28.4.1" data-path="graph.html"><a href="graph.html#graph-pout-pdf"><i class="fa fa-check"></i><b>28.4.1</b> PDF 输出</a></li>
<li class="chapter" data-level="28.4.2" data-path="graph.html"><a href="graph.html#graph-pout-png"><i class="fa fa-check"></i><b>28.4.2</b> PNG输出</a></li>
</ul></li>
<li class="chapter" data-level="28.5" data-path="graph.html"><a href="graph.html#graph-pzhn"><i class="fa fa-check"></i><b>28.5</b> 包含多种中文字体的图形</a></li>
<li class="chapter" data-level="28.6" data-path="graph.html"><a href="graph.html#graph-other"><i class="fa fa-check"></i><b>28.6</b> 其它图形</a><ul>
<li class="chapter" data-level="28.6.1" data-path="graph.html"><a href="graph.html#graph-other-corr"><i class="fa fa-check"></i><b>28.6.1</b> 相关系数图</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="29" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>29</b> ggplot作图入门</a><ul>
<li class="chapter" data-level="29.1" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-intro"><i class="fa fa-check"></i><b>29.1</b> 介绍</a></li>
<li class="chapter" data-level="29.2" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-principles"><i class="fa fa-check"></i><b>29.2</b> 作图的一般原则</a></li>
<li class="chapter" data-level="29.3" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-point"><i class="fa fa-check"></i><b>29.3</b> 散点图：ggplot入门</a><ul>
<li class="chapter" data-level="29.3.1" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-point-base"><i class="fa fa-check"></i><b>29.3.1</b> 基本的散点图</a></li>
<li class="chapter" data-level="29.3.2" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-point-layers"><i class="fa fa-check"></i><b>29.3.2</b> 逐步改善</a></li>
<li class="chapter" data-level="29.3.3" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-point-otheraes"><i class="fa fa-check"></i><b>29.3.3</b> 颜色、符号、线型等映射</a></li>
<li class="chapter" data-level="29.3.4" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-point-geomaes"><i class="fa fa-check"></i><b>29.3.4</b> 在geom函数中映射变量</a></li>
<li class="chapter" data-level="29.3.5" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-point-contcolor"><i class="fa fa-check"></i><b>29.3.5</b> 连续变量的颜色映射</a></li>
<li class="chapter" data-level="29.3.6" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-point-save"><i class="fa fa-check"></i><b>29.3.6</b> 保存图像</a></li>
</ul></li>
<li class="chapter" data-level="29.4" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-right"><i class="fa fa-check"></i><b>29.4</b> 折线图、分组、小图</a><ul>
<li class="chapter" data-level="29.4.1" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-right-group"><i class="fa fa-check"></i><b>29.4.1</b> 图形中的分组和折线图</a></li>
<li class="chapter" data-level="29.4.2" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-right-facet"><i class="fa fa-check"></i><b>29.4.2</b> 小图(facet)</a></li>
</ul></li>
<li class="chapter" data-level="29.5" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-bar-trans"><i class="fa fa-check"></i><b>29.5</b> 数据变换与条形图</a><ul>
<li class="chapter" data-level="29.5.1" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-right-morebar"><i class="fa fa-check"></i><b>29.5.1</b> 分段与并列条形图</a></li>
<li class="chapter" data-level="29.5.2" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-bar-morebar"><i class="fa fa-check"></i><b>29.5.2</b> 条形图的其它应用</a></li>
</ul></li>
<li class="chapter" data-level="29.6" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-hist"><i class="fa fa-check"></i><b>29.6</b> 直方图与密度估计</a></li>
<li class="chapter" data-level="29.7" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-gramm"><i class="fa fa-check"></i><b>29.7</b> 绘图语法介绍</a><ul>
<li class="chapter" data-level="29.7.1" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-gramm-gramm"><i class="fa fa-check"></i><b>29.7.1</b> 绘图语法</a></li>
<li class="chapter" data-level="29.7.2" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-gramm-geoms"><i class="fa fa-check"></i><b>29.7.2</b> 图形种类</a></li>
</ul></li>
<li class="chapter" data-level="29.8" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-moregeom"><i class="fa fa-check"></i><b>29.8</b> 更多图形种类</a><ul>
<li class="chapter" data-level="29.8.1" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-moregeom-continuousvar"><i class="fa fa-check"></i><b>29.8.1</b> 连续变量的分组图形</a></li>
<li class="chapter" data-level="29.8.2" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-moregeom-text"><i class="fa fa-check"></i><b>29.8.2</b> 坐标系中的文字</a></li>
<li class="chapter" data-level="29.8.3" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-moregeom-textops"><i class="fa fa-check"></i><b>29.8.3</b> 文字选项</a></li>
<li class="chapter" data-level="29.8.4" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-moregeom-outliers"><i class="fa fa-check"></i><b>29.8.4</b> 标出特殊点</a></li>
</ul></li>
<li class="chapter" data-level="29.9" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-auxfuncs-scale"><i class="fa fa-check"></i><b>29.9</b> 刻度(scale)</a></li>
<li class="chapter" data-level="29.10" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-refine-color"><i class="fa fa-check"></i><b>29.10</b> 如何使用颜色</a><ul>
<li class="chapter" data-level="29.10.1" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-refine-qual"><i class="fa fa-check"></i><b>29.10.1</b> 名义型变量的颜色</a></li>
<li class="chapter" data-level="29.10.2" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-refine-tile"><i class="fa fa-check"></i><b>29.10.2</b> 色块图</a></li>
<li class="chapter" data-level="29.10.3" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-refine-seq"><i class="fa fa-check"></i><b>29.10.3</b> 有序型变量的颜色</a></li>
<li class="chapter" data-level="29.10.4" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-refine-div"><i class="fa fa-check"></i><b>29.10.4</b> 相异型变量的颜色</a></li>
<li class="chapter" data-level="29.10.5" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-refine-num"><i class="fa fa-check"></i><b>29.10.5</b> 连续数值变量的颜色</a></li>
</ul></li>
<li class="chapter" data-level="29.11" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-auxfuncs"><i class="fa fa-check"></i><b>29.11</b> 标题、标注、指南、拼接</a><ul>
<li class="chapter" data-level="29.11.1" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-auxfuncs-labs"><i class="fa fa-check"></i><b>29.11.1</b> 标题</a></li>
<li class="chapter" data-level="29.11.2" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-auxfuncs-anno"><i class="fa fa-check"></i><b>29.11.2</b> 标注功能</a></li>
<li class="chapter" data-level="29.11.3" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-auxfuncs-guides"><i class="fa fa-check"></i><b>29.11.3</b> 指南(guides)</a></li>
<li class="chapter" data-level="29.11.4" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-auxfuncs-compfig"><i class="fa fa-check"></i><b>29.11.4</b> 拼接图形</a></li>
</ul></li>
<li class="chapter" data-level="29.12" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-refine"><i class="fa fa-check"></i><b>29.12</b> 图形定制调整</a><ul>
<li class="chapter" data-level="29.12.1" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-refine-asasec"><i class="fa fa-check"></i><b>29.12.1</b> 图形逐步调整例子</a></li>
</ul></li>
<li class="chapter" data-level="29.13" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-theme"><i class="fa fa-check"></i><b>29.13</b> 主题</a></li>
<li class="chapter" data-level="29.14" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-ref"><i class="fa fa-check"></i><b>29.14</b> 参考文献</a></li>
</ul></li>
<li class="chapter" data-level="30" data-path="ggplotvis.html"><a href="ggplotvis.html"><i class="fa fa-check"></i><b>30</b> ggplot的各种图形</a><ul>
<li class="chapter" data-level="30.1" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-intro"><i class="fa fa-check"></i><b>30.1</b> 介绍</a></li>
<li class="chapter" data-level="30.2" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-amount"><i class="fa fa-check"></i><b>30.2</b> 表现数量</a><ul>
<li class="chapter" data-level="30.2.1" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-amount-bar"><i class="fa fa-check"></i><b>30.2.1</b> 条形图</a></li>
<li class="chapter" data-level="30.2.2" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-amount-point"><i class="fa fa-check"></i><b>30.2.2</b> 点图</a></li>
<li class="chapter" data-level="30.2.3" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-amount-heatmap"><i class="fa fa-check"></i><b>30.2.3</b> 热力图</a></li>
</ul></li>
<li class="chapter" data-level="30.3" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-dist"><i class="fa fa-check"></i><b>30.3</b> 表现分布</a><ul>
<li class="chapter" data-level="30.3.1" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-dist-suni-hist"><i class="fa fa-check"></i><b>30.3.1</b> 单个一元分布的直方图与密度估计图</a></li>
<li class="chapter" data-level="30.3.2" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-dist-muni"><i class="fa fa-check"></i><b>30.3.2</b> 多个一元分布的直方图和密度图形</a></li>
<li class="chapter" data-level="30.3.3" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-dist-cdf"><i class="fa fa-check"></i><b>30.3.3</b> 经验分布函数图</a></li>
<li class="chapter" data-level="30.3.4" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-dist-qqplot"><i class="fa fa-check"></i><b>30.3.4</b> QQ图</a></li>
<li class="chapter" data-level="30.3.5" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-dist-boxplot"><i class="fa fa-check"></i><b>30.3.5</b> 盒形图</a></li>
<li class="chapter" data-level="30.3.6" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-dist-violin"><i class="fa fa-check"></i><b>30.3.6</b> 小提琴图</a></li>
<li class="chapter" data-level="30.3.7" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-dist-mdens"><i class="fa fa-check"></i><b>30.3.7</b> 多个密度的其它画法</a></li>
<li class="chapter" data-level="30.3.8" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-dist-2d"><i class="fa fa-check"></i><b>30.3.8</b> 二元分布直方图和等值线图</a></li>
</ul></li>
<li class="chapter" data-level="30.4" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-prop"><i class="fa fa-check"></i><b>30.4</b> 表现比例</a><ul>
<li class="chapter" data-level="30.4.1" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-prop-uni"><i class="fa fa-check"></i><b>30.4.1</b> 单个分布</a></li>
<li class="chapter" data-level="30.4.2" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-prop-mult"><i class="fa fa-check"></i><b>30.4.2</b> 组间的比例分布的比较</a></li>
<li class="chapter" data-level="30.4.3" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-prop-nest"><i class="fa fa-check"></i><b>30.4.3</b> 嵌套比例分布的比较</a></li>
</ul></li>
<li class="chapter" data-level="30.5" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-mulvar"><i class="fa fa-check"></i><b>30.5</b> 表现多个变量间的关系</a><ul>
<li class="chapter" data-level="30.5.1" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-mulvar-scatter"><i class="fa fa-check"></i><b>30.5.1</b> 散点图</a></li>
<li class="chapter" data-level="30.5.2" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-mulvar-scatmat"><i class="fa fa-check"></i><b>30.5.2</b> 散点图矩阵</a></li>
<li class="chapter" data-level="30.5.3" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-mulvar-corrgram"><i class="fa fa-check"></i><b>30.5.3</b> 相关系数矩阵图</a></li>
<li class="chapter" data-level="30.5.4" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-mulvar-dimreduct"><i class="fa fa-check"></i><b>30.5.4</b> 数据降维</a></li>
<li class="chapter" data-level="30.5.5" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-mulvar-paird"><i class="fa fa-check"></i><b>30.5.5</b> 成对数据</a></li>
</ul></li>
<li class="chapter" data-level="30.6" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-ts"><i class="fa fa-check"></i><b>30.6</b> 时间序列图</a><ul>
<li class="chapter" data-level="30.6.1" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-ts-uni"><i class="fa fa-check"></i><b>30.6.1</b> 一元时间序列</a></li>
<li class="chapter" data-level="30.6.2" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-ts-mul"><i class="fa fa-check"></i><b>30.6.2</b> 多元时间序列</a></li>
<li class="chapter" data-level="30.6.3" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-ts-het"><i class="fa fa-check"></i><b>30.6.3</b> 多个不同类型指标的时间序列</a></li>
</ul></li>
<li class="chapter" data-level="30.7" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-fit"><i class="fa fa-check"></i><b>30.7</b> 拟合曲线图</a><ul>
<li class="chapter" data-level="30.7.1" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-fit-smooth"><i class="fa fa-check"></i><b>30.7.1</b> 平滑方法</a></li>
<li class="chapter" data-level="30.7.2" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-fit-param"><i class="fa fa-check"></i><b>30.7.2</b> 参数模型方法</a></li>
</ul></li>
<li class="chapter" data-level="30.8" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-uncert"><i class="fa fa-check"></i><b>30.8</b> 表现不确定性</a><ul>
<li class="chapter" data-level="30.8.1" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-uncert-prob"><i class="fa fa-check"></i><b>30.8.1</b> 表现概率</a></li>
<li class="chapter" data-level="30.8.2" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-uncert-se"><i class="fa fa-check"></i><b>30.8.2</b> 表现点估计精度</a></li>
<li class="chapter" data-level="30.8.3" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-uncert-cband"><i class="fa fa-check"></i><b>30.8.3</b> 拟合曲线的置信带</a></li>
<li class="chapter" data-level="30.8.4" data-path="ggplotvis.html"><a href="ggplotvis.html#ggplotvis-uncert-dyn"><i class="fa fa-check"></i><b>30.8.4</b> 随机结果动态演示</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>VII 统计模型</b></span></li>
<li class="chapter" data-level="31" data-path="stat-basics.html"><a href="stat-basics.html"><i class="fa fa-check"></i><b>31</b> R初等统计分析</a><ul>
<li class="chapter" data-level="31.1" data-path="stat-basics.html"><a href="stat-basics.html#stat-base-distr"><i class="fa fa-check"></i><b>31.1</b> 概率分布</a></li>
<li class="chapter" data-level="31.2" data-path="stat-basics.html"><a href="stat-basics.html#stat-base-mle"><i class="fa fa-check"></i><b>31.2</b> 最大似然估计</a><ul>
<li class="chapter" data-level="31.2.1" data-path="stat-basics.html"><a href="stat-basics.html#stat-base-mle-norm1"><i class="fa fa-check"></i><b>31.2.1</b> 一元正态分布参数最大似然估计</a></li>
</ul></li>
<li class="chapter" data-level="31.3" data-path="stat-basics.html"><a href="stat-basics.html#stat-base-hyptest"><i class="fa fa-check"></i><b>31.3</b> 假设检验和置信区间</a><ul>
<li class="chapter" data-level="31.3.1" data-path="stat-basics.html"><a href="stat-basics.html#stat-base-hyptest-mu"><i class="fa fa-check"></i><b>31.3.1</b> 均值的假设检验和置信区间</a></li>
<li class="chapter" data-level="31.3.2" data-path="stat-basics.html"><a href="stat-basics.html#stat-base-hyptest-prop"><i class="fa fa-check"></i><b>31.3.2</b> 比例的假设检验和置信区间</a></li>
<li class="chapter" data-level="31.3.3" data-path="stat-basics.html"><a href="stat-basics.html#stat-base-hyptest-sigma"><i class="fa fa-check"></i><b>31.3.3</b> 方差的假设检验和置信区间</a></li>
<li class="chapter" data-level="31.3.4" data-path="stat-basics.html"><a href="stat-basics.html#stat-base-hyptest-gof"><i class="fa fa-check"></i><b>31.3.4</b> 拟合优度检验</a></li>
<li class="chapter" data-level="31.3.5" data-path="stat-basics.html"><a href="stat-basics.html#stat-base-hyptest-gof-vcd"><i class="fa fa-check"></i><b>31.3.5</b> 检验分布类型</a></li>
<li class="chapter" data-level="31.3.6" data-path="stat-basics.html"><a href="stat-basics.html#stat-base-hyptest-indepcont"><i class="fa fa-check"></i><b>31.3.6</b> 列联表独立性卡方检验</a></li>
<li class="chapter" data-level="31.3.7" data-path="stat-basics.html"><a href="stat-basics.html#stat-base-hyptest-npar"><i class="fa fa-check"></i><b>31.3.7</b> 非参数检验</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="32" data-path="stat-reg.html"><a href="stat-reg.html"><i class="fa fa-check"></i><b>32</b> R相关与回归</a><ul>
<li class="chapter" data-level="32.1" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-cor"><i class="fa fa-check"></i><b>32.1</b> 相关分析</a><ul>
<li class="chapter" data-level="32.1.1" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-cor-prop"><i class="fa fa-check"></i><b>32.1.1</b> 相关系数的性质</a></li>
<li class="chapter" data-level="32.1.2" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-cor-caus"><i class="fa fa-check"></i><b>32.1.2</b> 相关与因果</a></li>
<li class="chapter" data-level="32.1.3" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-cor-magn"><i class="fa fa-check"></i><b>32.1.3</b> 相关系数大小</a></li>
<li class="chapter" data-level="32.1.4" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-cor-test"><i class="fa fa-check"></i><b>32.1.4</b> 相关系数的检验</a></li>
<li class="chapter" data-level="32.1.5" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-cor-vcorr"><i class="fa fa-check"></i><b>32.1.5</b> 相关阵</a></li>
</ul></li>
<li class="chapter" data-level="32.2" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regsimp"><i class="fa fa-check"></i><b>32.2</b> 一元回归分析</a><ul>
<li class="chapter" data-level="32.2.1" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regsimp-model"><i class="fa fa-check"></i><b>32.2.1</b> 模型</a></li>
<li class="chapter" data-level="32.2.2" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regsimp-ls"><i class="fa fa-check"></i><b>32.2.2</b> 最小二乘法</a></li>
<li class="chapter" data-level="32.2.3" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regsimp-test"><i class="fa fa-check"></i><b>32.2.3</b> 回归有效性</a></li>
<li class="chapter" data-level="32.2.4" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regsimp-prog"><i class="fa fa-check"></i><b>32.2.4</b> R程序</a></li>
<li class="chapter" data-level="32.2.5" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regsimp-diag"><i class="fa fa-check"></i><b>32.2.5</b> 回归诊断</a></li>
<li class="chapter" data-level="32.2.6" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regsimp-ci"><i class="fa fa-check"></i><b>32.2.6</b> 预测区间</a></li>
<li class="chapter" data-level="32.2.7" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regsimp-control"><i class="fa fa-check"></i><b>32.2.7</b> 控制</a></li>
</ul></li>
<li class="chapter" data-level="32.3" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regmu"><i class="fa fa-check"></i><b>32.3</b> 多元线性回归</a><ul>
<li class="chapter" data-level="32.3.1" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regmu-mod"><i class="fa fa-check"></i><b>32.3.1</b> 模型</a></li>
<li class="chapter" data-level="32.3.2" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regmu-est"><i class="fa fa-check"></i><b>32.3.2</b> 参数估计</a></li>
<li class="chapter" data-level="32.3.3" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regmu-rcode"><i class="fa fa-check"></i><b>32.3.3</b> R的多元回归程序</a></li>
<li class="chapter" data-level="32.3.4" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regmu-test"><i class="fa fa-check"></i><b>32.3.4</b> 模型的检验</a></li>
<li class="chapter" data-level="32.3.5" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regmu-subset"><i class="fa fa-check"></i><b>32.3.5</b> 回归自变量筛选</a></li>
<li class="chapter" data-level="32.3.6" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regmu-dum"><i class="fa fa-check"></i><b>32.3.6</b> 哑变量与变截距项的模型</a></li>
<li class="chapter" data-level="32.3.7" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regmu-resid"><i class="fa fa-check"></i><b>32.3.7</b> 残差诊断</a></li>
<li class="chapter" data-level="32.3.8" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regmu-colin"><i class="fa fa-check"></i><b>32.3.8</b> 多重共线性</a></li>
<li class="chapter" data-level="32.3.9" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regmu-lev"><i class="fa fa-check"></i><b>32.3.9</b> 强影响点分析</a></li>
<li class="chapter" data-level="32.3.10" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regmu-overfit"><i class="fa fa-check"></i><b>32.3.10</b> 过度拟合示例</a></li>
<li class="chapter" data-level="32.3.11" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regmu-comp-inset"><i class="fa fa-check"></i><b>32.3.11</b> 嵌套模型的比较</a></li>
<li class="chapter" data-level="32.3.12" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regmu-pred"><i class="fa fa-check"></i><b>32.3.12</b> 拟合与预测</a></li>
<li class="chapter" data-level="32.3.13" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regmu-curve"><i class="fa fa-check"></i><b>32.3.13</b> 利用线性回归模型做曲线拟合</a></li>
<li class="chapter" data-level="32.3.14" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-regmu-group"><i class="fa fa-check"></i><b>32.3.14</b> 分组建立多个模型</a></li>
</ul></li>
<li class="chapter" data-level="32.4" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-npar"><i class="fa fa-check"></i><b>32.4</b> 非参数回归</a><ul>
<li class="chapter" data-level="32.4.1" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-npar-mod"><i class="fa fa-check"></i><b>32.4.1</b> 模型</a></li>
<li class="chapter" data-level="32.4.2" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-cfit-spl1d"><i class="fa fa-check"></i><b>32.4.2</b> 样条平滑</a></li>
<li class="chapter" data-level="32.4.3" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-cfit-loess"><i class="fa fa-check"></i><b>32.4.3</b> 局部多项式曲线平滑</a></li>
<li class="chapter" data-level="32.4.4" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-cfit-bs"><i class="fa fa-check"></i><b>32.4.4</b> 样条函数变换</a></li>
<li class="chapter" data-level="32.4.5" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-cfit-gam"><i class="fa fa-check"></i><b>32.4.5</b> 线性可加模型</a></li>
</ul></li>
<li class="chapter" data-level="32.5" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-reglog"><i class="fa fa-check"></i><b>32.5</b> Logistic回归</a><ul>
<li class="chapter" data-level="32.5.1" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-reglog-mod"><i class="fa fa-check"></i><b>32.5.1</b> 模型</a></li>
<li class="chapter" data-level="32.5.2" data-path="stat-reg.html"><a href="stat-reg.html#stat-base-reg-reglog-rcode"><i class="fa fa-check"></i><b>32.5.2</b> R程序</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="33" data-path="stat-tsa.html"><a href="stat-tsa.html"><i class="fa fa-check"></i><b>33</b> R时间序列分析</a><ul>
<li class="chapter" data-level="33.1" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-defs"><i class="fa fa-check"></i><b>33.1</b> 基本概念</a></li>
<li class="chapter" data-level="33.2" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-dtype"><i class="fa fa-check"></i><b>33.2</b> 时间序列数据类型</a><ul>
<li class="chapter" data-level="33.2.1" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-dtype-ts"><i class="fa fa-check"></i><b>33.2.1</b> ts类型</a></li>
<li class="chapter" data-level="33.2.2" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-dtype-xts"><i class="fa fa-check"></i><b>33.2.2</b> xts类型与常用函数</a></li>
</ul></li>
<li class="chapter" data-level="33.3" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-basicstat"><i class="fa fa-check"></i><b>33.3</b> 基本分析与作图</a></li>
<li class="chapter" data-level="33.4" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-arima"><i class="fa fa-check"></i><b>33.4</b> ARIMA建模和模拟</a><ul>
<li class="chapter" data-level="33.4.1" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-arima-def"><i class="fa fa-check"></i><b>33.4.1</b> 模型公式</a></li>
<li class="chapter" data-level="33.4.2" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-arima-sim"><i class="fa fa-check"></i><b>33.4.2</b> 模拟</a></li>
<li class="chapter" data-level="33.4.3" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-arima-armod"><i class="fa fa-check"></i><b>33.4.3</b> AR建模</a></li>
<li class="chapter" data-level="33.4.4" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-arima-armamod"><i class="fa fa-check"></i><b>33.4.4</b> ARMA建模</a></li>
<li class="chapter" data-level="33.4.5" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-arima-diag"><i class="fa fa-check"></i><b>33.4.5</b> 模型诊断</a></li>
<li class="chapter" data-level="33.4.6" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-arima-lbtest"><i class="fa fa-check"></i><b>33.4.6</b> 白噪声检验</a></li>
<li class="chapter" data-level="33.4.7" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-arima-sparse"><i class="fa fa-check"></i><b>33.4.7</b> 稀疏系数估计</a></li>
<li class="chapter" data-level="33.4.8" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-arima-adftest"><i class="fa fa-check"></i><b>33.4.8</b> 单位根检验</a></li>
<li class="chapter" data-level="33.4.9" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-arima-cfuncs"><i class="fa fa-check"></i><b>33.4.9</b> ARMA模型的一些自定义函数</a></li>
</ul></li>
<li class="chapter" data-level="33.5" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-spectra"><i class="fa fa-check"></i><b>33.5</b> 谱密度估计</a></li>
<li class="chapter" data-level="33.6" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-garch"><i class="fa fa-check"></i><b>33.6</b> GARCH类模型</a></li>
<li class="chapter" data-level="33.7" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-mtsa"><i class="fa fa-check"></i><b>33.7</b> 多元时间序列基础统计</a></li>
<li class="chapter" data-level="33.8" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-var"><i class="fa fa-check"></i><b>33.8</b> VAR模型</a></li>
<li class="chapter" data-level="33.9" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-coint"><i class="fa fa-check"></i><b>33.9</b> 协整分析</a></li>
<li class="chapter" data-level="33.10" data-path="stat-tsa.html"><a href="stat-tsa.html#stat-tsa-causal"><i class="fa fa-check"></i><b>33.10</b> 因果性检验</a></li>
</ul></li>
<li class="chapter" data-level="34" data-path="stat-learning.html"><a href="stat-learning.html"><i class="fa fa-check"></i><b>34</b> 统计学习介绍</a><ul>
<li class="chapter" data-level="34.1" data-path="stat-learning.html"><a href="stat-learning.html#statl-intro"><i class="fa fa-check"></i><b>34.1</b> 统计学习的基本概念和一般步骤</a><ul>
<li class="chapter" data-level="34.1.1" data-path="stat-learning.html"><a href="stat-learning.html#statl-intro-basic"><i class="fa fa-check"></i><b>34.1.1</b> 统计学习的基本概念和方法</a></li>
<li class="chapter" data-level="34.1.2" data-path="stat-learning.html"><a href="stat-learning.html#statl-intro-biasvar"><i class="fa fa-check"></i><b>34.1.2</b> 偏差与方差折衷</a></li>
<li class="chapter" data-level="34.1.3" data-path="stat-learning.html"><a href="stat-learning.html#statl-cv"><i class="fa fa-check"></i><b>34.1.3</b> 交叉验证</a></li>
<li class="chapter" data-level="34.1.4" data-path="stat-learning.html"><a href="stat-learning.html#statl-steps"><i class="fa fa-check"></i><b>34.1.4</b> 一般步骤</a></li>
</ul></li>
<li class="chapter" data-level="34.2" data-path="stat-learning.html"><a href="stat-learning.html#statl-hitters"><i class="fa fa-check"></i><b>34.2</b> Hitters数据分析</a><ul>
<li class="chapter" data-level="34.2.1" data-path="stat-learning.html"><a href="stat-learning.html#statl-hitters-subset"><i class="fa fa-check"></i><b>34.2.1</b> 回归自变量选择</a></li>
<li class="chapter" data-level="34.2.2" data-path="stat-learning.html"><a href="stat-learning.html#statl-hitters-ridge"><i class="fa fa-check"></i><b>34.2.2</b> 岭回归</a></li>
<li class="chapter" data-level="34.2.3" data-path="stat-learning.html"><a href="stat-learning.html#statl-hitters-lasso"><i class="fa fa-check"></i><b>34.2.3</b> Lasso回归</a></li>
<li class="chapter" data-level="34.2.4" data-path="stat-learning.html"><a href="stat-learning.html#statl-hitters-simpt"><i class="fa fa-check"></i><b>34.2.4</b> 树回归的简单演示</a></li>
<li class="chapter" data-level="34.2.5" data-path="stat-learning.html"><a href="stat-learning.html#statl-hitters-tree"><i class="fa fa-check"></i><b>34.2.5</b> 树回归</a></li>
<li class="chapter" data-level="34.2.6" data-path="stat-learning.html"><a href="stat-learning.html#statl-hitters-bag"><i class="fa fa-check"></i><b>34.2.6</b> 装袋法</a></li>
<li class="chapter" data-level="34.2.7" data-path="stat-learning.html"><a href="stat-learning.html#statl-hitters-rf"><i class="fa fa-check"></i><b>34.2.7</b> 随机森林</a></li>
</ul></li>
<li class="chapter" data-level="34.3" data-path="stat-learning.html"><a href="stat-learning.html#statl-heart"><i class="fa fa-check"></i><b>34.3</b> Heart数据分析</a><ul>
<li class="chapter" data-level="34.3.1" data-path="stat-learning.html"><a href="stat-learning.html#statl-heart-tree"><i class="fa fa-check"></i><b>34.3.1</b> 树回归</a></li>
<li class="chapter" data-level="34.3.2" data-path="stat-learning.html"><a href="stat-learning.html#statl-heart-bag"><i class="fa fa-check"></i><b>34.3.2</b> 用装袋法</a></li>
<li class="chapter" data-level="34.3.3" data-path="stat-learning.html"><a href="stat-learning.html#statl-heart-rf"><i class="fa fa-check"></i><b>34.3.3</b> 用随机森林</a></li>
</ul></li>
<li class="chapter" data-level="34.4" data-path="stat-learning.html"><a href="stat-learning.html#statl-car"><i class="fa fa-check"></i><b>34.4</b> 汽车销量数据分析</a><ul>
<li class="chapter" data-level="34.4.1" data-path="stat-learning.html"><a href="stat-learning.html#statl-car-tree"><i class="fa fa-check"></i><b>34.4.1</b> 判别树</a></li>
<li class="chapter" data-level="34.4.2" data-path="stat-learning.html"><a href="stat-learning.html#statl-car-rf"><i class="fa fa-check"></i><b>34.4.2</b> 随机森林</a></li>
</ul></li>
<li class="chapter" data-level="34.5" data-path="stat-learning.html"><a href="stat-learning.html#statl-boston"><i class="fa fa-check"></i><b>34.5</b> 波士顿郊区房价数据</a><ul>
<li class="chapter" data-level="34.5.1" data-path="stat-learning.html"><a href="stat-learning.html#statl-boston-tree"><i class="fa fa-check"></i><b>34.5.1</b> 回归树</a></li>
<li class="chapter" data-level="34.5.2" data-path="stat-learning.html"><a href="stat-learning.html#statl-boston-bag"><i class="fa fa-check"></i><b>34.5.2</b> 装袋法</a></li>
<li class="chapter" data-level="34.5.3" data-path="stat-learning.html"><a href="stat-learning.html#statl-boston-rf"><i class="fa fa-check"></i><b>34.5.3</b> 随机森林</a></li>
<li class="chapter" data-level="34.5.4" data-path="stat-learning.html"><a href="stat-learning.html#statl-boston-boost"><i class="fa fa-check"></i><b>34.5.4</b> 提升法</a></li>
</ul></li>
<li class="chapter" data-level="34.6" data-path="stat-learning.html"><a href="stat-learning.html#statl-svm"><i class="fa fa-check"></i><b>34.6</b> 支持向量机方法</a><ul>
<li class="chapter" data-level="34.6.1" data-path="stat-learning.html"><a href="stat-learning.html#statl-svm-heart"><i class="fa fa-check"></i><b>34.6.1</b> 支持向量机用于Heart数据</a></li>
</ul></li>
<li class="chapter" data-level="34.7" data-path="stat-learning.html"><a href="stat-learning.html#statl-app"><i class="fa fa-check"></i><b>34.7</b> 附录</a><ul>
<li class="chapter" data-level="34.7.1" data-path="stat-learning.html"><a href="stat-learning.html#statl-app-hitters"><i class="fa fa-check"></i><b>34.7.1</b> Hitters数据</a></li>
<li class="chapter" data-level="34.7.2" data-path="stat-learning.html"><a href="stat-learning.html#statl-app-heart"><i class="fa fa-check"></i><b>34.7.2</b> Heart数据</a></li>
<li class="chapter" data-level="34.7.3" data-path="stat-learning.html"><a href="stat-learning.html#statl-app-car"><i class="fa fa-check"></i><b>34.7.3</b> CarSeats数据</a></li>
<li class="chapter" data-level="34.7.4" data-path="stat-learning.html"><a href="stat-learning.html#statl-app-boston"><i class="fa fa-check"></i><b>34.7.4</b> Boston数据</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="35" data-path="simulation.html"><a href="simulation.html"><i class="fa fa-check"></i><b>35</b> 随机模拟</a><ul>
<li class="chapter" data-level="35.1" data-path="simulation.html"><a href="simulation.html#simint"><i class="fa fa-check"></i><b>35.1</b> 随机数</a></li>
<li class="chapter" data-level="35.2" data-path="simulation.html"><a href="simulation.html#simsamp"><i class="fa fa-check"></i><b>35.2</b> <code>sample()</code>函数</a></li>
<li class="chapter" data-level="35.3" data-path="simulation.html"><a href="simulation.html#simexamp"><i class="fa fa-check"></i><b>35.3</b> 随机模拟示例</a><ul>
<li class="chapter" data-level="35.3.1" data-path="simulation.html"><a href="simulation.html#simexamp-expect"><i class="fa fa-check"></i><b>35.3.1</b> 估计期望值</a></li>
<li class="chapter" data-level="35.3.2" data-path="simulation.html"><a href="simulation.html#simexamp-lm"><i class="fa fa-check"></i><b>35.3.2</b> 线性回归模拟</a></li>
<li class="chapter" data-level="35.3.3" data-path="simulation.html"><a href="simulation.html#simexamp-kde"><i class="fa fa-check"></i><b>35.3.3</b> 核密度的bootstrap置信区间</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>VIII 特殊应用</b></span></li>
<li class="chapter" data-level="36" data-path="text.html"><a href="text.html"><i class="fa fa-check"></i><b>36</b> R语言的文本处理</a><ul>
<li class="chapter" data-level="36.1" data-path="text.html"><a href="text.html#text-simple"><i class="fa fa-check"></i><b>36.1</b> 简单的文本处理</a><ul>
<li class="chapter" data-level="36.1.1" data-path="text.html"><a href="text.html#text-simple-const"><i class="fa fa-check"></i><b>36.1.1</b> 字符型常量与字符型向量</a></li>
<li class="chapter" data-level="36.1.2" data-path="text.html"><a href="text.html#text-paste"><i class="fa fa-check"></i><b>36.1.2</b> 字符串连接、重复</a></li>
<li class="chapter" data-level="36.1.3" data-path="text.html"><a href="text.html#text-formatout"><i class="fa fa-check"></i><b>36.1.3</b> 格式化输出</a></li>
<li class="chapter" data-level="36.1.4" data-path="text.html"><a href="text.html#text-length"><i class="fa fa-check"></i><b>36.1.4</b> 字符串长度</a></li>
<li class="chapter" data-level="36.1.5" data-path="text.html"><a href="text.html#text-substring"><i class="fa fa-check"></i><b>36.1.5</b> 取子串</a></li>
<li class="chapter" data-level="36.1.6" data-path="text.html"><a href="text.html#text-convert"><i class="fa fa-check"></i><b>36.1.6</b> 字符串变换</a></li>
<li class="chapter" data-level="36.1.7" data-path="text.html"><a href="text.html#text-simp-find"><i class="fa fa-check"></i><b>36.1.7</b> 简单匹配与查找</a></li>
<li class="chapter" data-level="36.1.8" data-path="text.html"><a href="text.html#text-simple-gsub"><i class="fa fa-check"></i><b>36.1.8</b> 字符串替换</a></li>
<li class="chapter" data-level="36.1.9" data-path="text.html"><a href="text.html#text-simple-strsplit"><i class="fa fa-check"></i><b>36.1.9</b> 字符串拆分</a></li>
</ul></li>
<li class="chapter" data-level="36.2" data-path="text.html"><a href="text.html#text-file"><i class="fa fa-check"></i><b>36.2</b> 文本文件读写</a></li>
<li class="chapter" data-level="36.3" data-path="text.html"><a href="text.html#text-regex"><i class="fa fa-check"></i><b>36.3</b> 正则表达式</a><ul>
<li class="chapter" data-level="36.3.1" data-path="text.html"><a href="text.html#text-regex-strview"><i class="fa fa-check"></i><b>36.3.1</b> 字面匹配与匹配显示</a></li>
<li class="chapter" data-level="36.3.2" data-path="text.html"><a href="text.html#text-regex-ignore"><i class="fa fa-check"></i><b>36.3.2</b> 不区分大小写匹配和<code>regex</code>函数</a></li>
<li class="chapter" data-level="36.3.3" data-path="text.html"><a href="text.html#text-regex-dot"><i class="fa fa-check"></i><b>36.3.3</b> 用句点匹配单个字符</a></li>
<li class="chapter" data-level="36.3.4" data-path="text.html"><a href="text.html#text-regex-set"><i class="fa fa-check"></i><b>36.3.4</b> 匹配一组字符中的某一个</a></li>
<li class="chapter" data-level="36.3.5" data-path="text.html"><a href="text.html#text-regex-metalit"><i class="fa fa-check"></i><b>36.3.5</b> 原样匹配元字符</a></li>
<li class="chapter" data-level="36.3.6" data-path="text.html"><a href="text.html#text-regex-space"><i class="fa fa-check"></i><b>36.3.6</b> 匹配空白</a></li>
<li class="chapter" data-level="36.3.7" data-path="text.html"><a href="text.html#text-regex-digit"><i class="fa fa-check"></i><b>36.3.7</b> 匹配数字</a></li>
<li class="chapter" data-level="36.3.8" data-path="text.html"><a href="text.html#text-regex-alnum"><i class="fa fa-check"></i><b>36.3.8</b> 匹配字母、数字、下划线</a></li>
<li class="chapter" data-level="36.3.9" data-path="text.html"><a href="text.html#text-regex-hex"><i class="fa fa-check"></i><b>36.3.9</b> 十六进制和八进制数</a></li>
<li class="chapter" data-level="36.3.10" data-path="text.html"><a href="text.html#text-regex-posix"><i class="fa fa-check"></i><b>36.3.10</b> POSIX字符类</a></li>
<li class="chapter" data-level="36.3.11" data-path="text.html"><a href="text.html#text-regex-start"><i class="fa fa-check"></i><b>36.3.11</b> 匹配开头和末尾</a></li>
<li class="chapter" data-level="36.3.12" data-path="text.html"><a href="text.html#text-regex-wordb"><i class="fa fa-check"></i><b>36.3.12</b> 单词边界</a></li>
<li class="chapter" data-level="36.3.13" data-path="text.html"><a href="text.html#text-regex-repeat"><i class="fa fa-check"></i><b>36.3.13</b> 重复匹配</a></li>
<li class="chapter" data-level="36.3.14" data-path="text.html"><a href="text.html#text-regex-lazy"><i class="fa fa-check"></i><b>36.3.14</b> 贪婪匹配和懒惰匹配</a></li>
<li class="chapter" data-level="36.3.15" data-path="text.html"><a href="text.html#text-regex-smlines"><i class="fa fa-check"></i><b>36.3.15</b> 句点全匹配与多行模式</a></li>
<li class="chapter" data-level="36.3.16" data-path="text.html"><a href="text.html#text-regex-alt"><i class="fa fa-check"></i><b>36.3.16</b> 备择模式</a></li>
<li class="chapter" data-level="36.3.17" data-path="text.html"><a href="text.html#text-regex-group"><i class="fa fa-check"></i><b>36.3.17</b> 分组与捕获</a></li>
</ul></li>
<li class="chapter" data-level="36.4" data-path="text.html"><a href="text.html#text-stringr-funcs"><i class="fa fa-check"></i><b>36.4</b> stringr包的正则表达式函数</a><ul>
<li class="chapter" data-level="36.4.1" data-path="text.html"><a href="text.html#text-stringr-funcs-strview"><i class="fa fa-check"></i><b>36.4.1</b> <code>str_view()</code>函数</a></li>
<li class="chapter" data-level="36.4.2" data-path="text.html"><a href="text.html#text-stringr-funcs-regex"><i class="fa fa-check"></i><b>36.4.2</b> <code>regex()</code>函数</a></li>
<li class="chapter" data-level="36.4.3" data-path="text.html"><a href="text.html#text-stringr-funcs-detect"><i class="fa fa-check"></i><b>36.4.3</b> 检查那些元素能够匹配</a></li>
<li class="chapter" data-level="36.4.4" data-path="text.html"><a href="text.html#text-stringr-funcs-replace"><i class="fa fa-check"></i><b>36.4.4</b> 替换</a></li>
<li class="chapter" data-level="36.4.5" data-path="text.html"><a href="text.html#text-stringr-funcs-subset"><i class="fa fa-check"></i><b>36.4.5</b> 返回匹配的元素</a></li>
<li class="chapter" data-level="36.4.6" data-path="text.html"><a href="text.html#text-stringr-funcs-extract"><i class="fa fa-check"></i><b>36.4.6</b> 提取匹配内容</a></li>
<li class="chapter" data-level="36.4.7" data-path="text.html"><a href="text.html#text-stringr-funcs-match"><i class="fa fa-check"></i><b>36.4.7</b> 提取分组捕获内容</a></li>
<li class="chapter" data-level="36.4.8" data-path="text.html"><a href="text.html#text-stringr-funcs-locate"><i class="fa fa-check"></i><b>36.4.8</b> 定位匹配位置</a></li>
</ul></li>
<li class="chapter" data-level="36.5" data-path="text.html"><a href="text.html#text-regex-bfuncs"><i class="fa fa-check"></i><b>36.5</b> 利用基本R函数进行正则表达式处理</a><ul>
<li class="chapter" data-level="36.5.1" data-path="text.html"><a href="text.html#text-regex-bfuncs-igcase"><i class="fa fa-check"></i><b>36.5.1</b> 不区分大小写匹配</a></li>
<li class="chapter" data-level="36.5.2" data-path="text.html"><a href="text.html#text-regex-bfuncs-dotp"><i class="fa fa-check"></i><b>36.5.2</b> 匹配单个字符</a></li>
<li class="chapter" data-level="36.5.3" data-path="text.html"><a href="text.html#text-regex-bfuncs-setp"><i class="fa fa-check"></i><b>36.5.3</b> 匹配一组字符中的某一个</a></li>
<li class="chapter" data-level="36.5.4" data-path="text.html"><a href="text.html#text-regex-bfuncs-metalit"><i class="fa fa-check"></i><b>36.5.4</b> 原样匹配元字符</a></li>
<li class="chapter" data-level="36.5.5" data-path="text.html"><a href="text.html#text-regex-bfuncs-digit"><i class="fa fa-check"></i><b>36.5.5</b> 匹配数字</a></li>
<li class="chapter" data-level="36.5.6" data-path="text.html"><a href="text.html#text-regex-bfuncs-start"><i class="fa fa-check"></i><b>36.5.6</b> 匹配开头和末尾</a></li>
<li class="chapter" data-level="36.5.7" data-path="text.html"><a href="text.html#text-regex-bfuncs-alnum"><i class="fa fa-check"></i><b>36.5.7</b> 匹配字母、数字、下划线</a></li>
<li class="chapter" data-level="36.5.8" data-path="text.html"><a href="text.html#text-regex-bfuncs-hex"><i class="fa fa-check"></i><b>36.5.8</b> 十六进制和八进制数</a></li>
<li class="chapter" data-level="36.5.9" data-path="text.html"><a href="text.html#text-regex-bfuncs-posix"><i class="fa fa-check"></i><b>36.5.9</b> POSIX字符类</a></li>
<li class="chapter" data-level="36.5.10" data-path="text.html"><a href="text.html#text-regex-bfuncs-plus"><i class="fa fa-check"></i><b>36.5.10</b> 加号重复匹配</a></li>
<li class="chapter" data-level="36.5.11" data-path="text.html"><a href="text.html#text-regex-bfuncs-ast"><i class="fa fa-check"></i><b>36.5.11</b> 星号和问号重复匹配</a></li>
<li class="chapter" data-level="36.5.12" data-path="text.html"><a href="text.html#text-regex-bfuncs-repnum"><i class="fa fa-check"></i><b>36.5.12</b> 计数重复</a></li>
<li class="chapter" data-level="36.5.13" data-path="text.html"><a href="text.html#text-regex-bfuncs-lazy"><i class="fa fa-check"></i><b>36.5.13</b> 贪婪匹配和懒惰匹配</a></li>
<li class="chapter" data-level="36.5.14" data-path="text.html"><a href="text.html#text-regex-bfuncs-wordb"><i class="fa fa-check"></i><b>36.5.14</b> 单词边界</a></li>
<li class="chapter" data-level="36.5.15" data-path="text.html"><a href="text.html#text-regex-bfuncs-sm"><i class="fa fa-check"></i><b>36.5.15</b> 句点全匹配与多行模式</a></li>
<li class="chapter" data-level="36.5.16" data-path="text.html"><a href="text.html#text-regex-bfuncs-alt"><i class="fa fa-check"></i><b>36.5.16</b> 备择模式</a></li>
<li class="chapter" data-level="36.5.17" data-path="text.html"><a href="text.html#text-regex-bfuncs-group"><i class="fa fa-check"></i><b>36.5.17</b> 分组与捕获</a></li>
</ul></li>
<li class="chapter" data-level="36.6" data-path="text.html"><a href="text.html#text-regexex"><i class="fa fa-check"></i><b>36.6</b> 正则表达式应用例子</a><ul>
<li class="chapter" data-level="36.6.1" data-path="text.html"><a href="text.html#text-regexex-pre"><i class="fa fa-check"></i><b>36.6.1</b> 数据预处理</a></li>
<li class="chapter" data-level="36.6.2" data-path="text.html"><a href="text.html#text-regexex-excelmore"><i class="fa fa-check"></i><b>36.6.2</b> 不规则Excel文件处理</a></li>
<li class="chapter" data-level="36.6.3" data-path="text.html"><a href="text.html#text-regexex-wordfreq"><i class="fa fa-check"></i><b>36.6.3</b> 字频统计</a></li>
<li class="chapter" data-level="36.6.4" data-path="text.html"><a href="text.html#text-regexex-digits"><i class="fa fa-check"></i><b>36.6.4</b> 数字验证</a></li>
<li class="chapter" data-level="36.6.5" data-path="text.html"><a href="text.html#text-regexex-digfn"><i class="fa fa-check"></i><b>36.6.5</b> 文件名中的数字提取</a></li>
</ul></li>
<li class="chapter" data-level="36.7" data-path="text.html"><a href="text.html#text-webscape"><i class="fa fa-check"></i><b>36.7</b> 网站数据获取</a></li>
<li class="chapter" data-level="36.8" data-path="text.html"><a href="text.html#text-jiebaR"><i class="fa fa-check"></i><b>36.8</b> 中文分词与词频</a></li>
</ul></li>
<li class="part"><span><b>IX 用Rcpp访问C++代码</b></span></li>
<li class="chapter" data-level="37" data-path="rcpp.html"><a href="rcpp.html"><i class="fa fa-check"></i><b>37</b> Rcpp介绍</a><ul>
<li class="chapter" data-level="37.1" data-path="rcpp.html"><a href="rcpp.html#rcpp-intro-use"><i class="fa fa-check"></i><b>37.1</b> Rcpp的用途</a></li>
<li class="chapter" data-level="37.2" data-path="rcpp.html"><a href="rcpp.html#rcpp-intro-examp"><i class="fa fa-check"></i><b>37.2</b> Rcpp入门样例</a><ul>
<li class="chapter" data-level="37.2.1" data-path="rcpp.html"><a href="rcpp.html#rcpp-intro-examp-ex1"><i class="fa fa-check"></i><b>37.2.1</b> 用<code>cppFunction()</code>转换简单的C++函数—Fibnacci例子</a></li>
<li class="chapter" data-level="37.2.2" data-path="rcpp.html"><a href="rcpp.html#rcpp-intro-examp-ex2"><i class="fa fa-check"></i><b>37.2.2</b> 用<code>sourceCpp()</code>转换C++程序—正负交替迭代例子</a></li>
<li class="chapter" data-level="37.2.3" data-path="rcpp.html"><a href="rcpp.html#rcpp-intro-examp-ex3"><i class="fa fa-check"></i><b>37.2.3</b> 用<code>sourceCpp()</code>转换C++源文件中的程序—正负交替迭代例子</a></li>
<li class="chapter" data-level="37.2.4" data-path="rcpp.html"><a href="rcpp.html#rcpp-intro-examp-ex4"><i class="fa fa-check"></i><b>37.2.4</b> 用<code>sourceCpp()</code>转换C++源程序文件—卷积例子</a></li>
<li class="chapter" data-level="37.2.5" data-path="rcpp.html"><a href="rcpp.html#rcpp-intro-examp-rmdconv"><i class="fa fa-check"></i><b>37.2.5</b> 在Rmd文件中使用C++源程序文件</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="38" data-path="rcpp-typeconv.html"><a href="rcpp-typeconv.html"><i class="fa fa-check"></i><b>38</b> R与C++的类型转换</a><ul>
<li class="chapter" data-level="38.1" data-path="rcpp-typeconv.html"><a href="rcpp-typeconv.html#rcpp-typeconv-wrap"><i class="fa fa-check"></i><b>38.1</b> 用<code>wrap()</code>把C++变量返回到R中</a></li>
<li class="chapter" data-level="38.2" data-path="rcpp-typeconv.html"><a href="rcpp-typeconv.html#rcpp-typeconv-as"><i class="fa fa-check"></i><b>38.2</b> 用<code>as()</code>函数把R变量转换为C++类型</a></li>
<li class="chapter" data-level="38.3" data-path="rcpp-typeconv.html"><a href="rcpp-typeconv.html#rcpp-typeconv-implicit"><i class="fa fa-check"></i><b>38.3</b> <code>as()</code>和<code>wrap()</code>的隐含调用</a></li>
</ul></li>
<li class="chapter" data-level="39" data-path="rcpp-attr.html"><a href="rcpp-attr.html"><i class="fa fa-check"></i><b>39</b> Rcpp 属性</a><ul>
<li class="chapter" data-level="39.1" data-path="rcpp-attr.html"><a href="rcpp-attr.html#rcpp-attr-intro"><i class="fa fa-check"></i><b>39.1</b> Rcpp属性介绍</a></li>
<li class="chapter" data-level="39.2" data-path="rcpp-attr.html"><a href="rcpp-attr.html#rcpp-attr-export"><i class="fa fa-check"></i><b>39.2</b> 在C++源程序中指定要导出的C++函数</a></li>
<li class="chapter" data-level="39.3" data-path="rcpp-attr.html"><a href="rcpp-attr.html#rcpp-attr-sourcecpp"><i class="fa fa-check"></i><b>39.3</b> 在R中编译链接C++代码</a></li>
<li class="chapter" data-level="39.4" data-path="rcpp-attr.html"><a href="rcpp-attr.html#rcpp-attr-misc"><i class="fa fa-check"></i><b>39.4</b> Rcpp属性的其它功能</a><ul>
<li class="chapter" data-level="39.4.1" data-path="rcpp-attr.html"><a href="rcpp-attr.html#rcpp-attr-misc-default"><i class="fa fa-check"></i><b>39.4.1</b> 自变量有缺省值的函数</a></li>
<li class="chapter" data-level="39.4.2" data-path="rcpp-attr.html"><a href="rcpp-attr.html#rcpp-attr-misc-interrupt"><i class="fa fa-check"></i><b>39.4.2</b> 允许用户中断</a></li>
<li class="chapter" data-level="39.4.3" data-path="rcpp-attr.html"><a href="rcpp-attr.html#rcpp-attr-misc-rinclude"><i class="fa fa-check"></i><b>39.4.3</b> 把R代码写在C++源文件中</a></li>
<li class="chapter" data-level="39.4.4" data-path="rcpp-attr.html"><a href="rcpp-attr.html#rcpp-attr-misc-rand"><i class="fa fa-check"></i><b>39.4.4</b> 在C++中调用R的随机数发生器</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="40" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html"><i class="fa fa-check"></i><b>40</b> Rcpp提供的C++数据类型</a><ul>
<li class="chapter" data-level="40.1" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-vectype-robject"><i class="fa fa-check"></i><b>40.1</b> RObject类</a></li>
<li class="chapter" data-level="40.2" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-vectype-ivec"><i class="fa fa-check"></i><b>40.2</b> IntegerVector类</a><ul>
<li class="chapter" data-level="40.2.1" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-vectype-ivec-ex1"><i class="fa fa-check"></i><b>40.2.1</b> IntegerVector示例1：返回完全数</a></li>
<li class="chapter" data-level="40.2.2" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-vectype-ivec-ex2"><i class="fa fa-check"></i><b>40.2.2</b> IntegerVector示例2：输入整数向量</a></li>
</ul></li>
<li class="chapter" data-level="40.3" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-vectype-num"><i class="fa fa-check"></i><b>40.3</b> NumericVector类</a><ul>
<li class="chapter" data-level="40.3.1" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-vectype-num-ex1"><i class="fa fa-check"></i><b>40.3.1</b> 示例1：计算元素<span class="math inline">\(p\)</span>次方的和</a></li>
<li class="chapter" data-level="40.3.2" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-vectype-num-ex2"><i class="fa fa-check"></i><b>40.3.2</b> 示例2：<code>clone</code>函数</a></li>
<li class="chapter" data-level="40.3.3" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-vectype-num-ex3"><i class="fa fa-check"></i><b>40.3.3</b> 示例3：向量子集</a></li>
</ul></li>
<li class="chapter" data-level="40.4" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-vectype-mat"><i class="fa fa-check"></i><b>40.4</b> NumericMatrix类</a><ul>
<li class="chapter" data-level="40.4.1" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-vectype-mat-ex1"><i class="fa fa-check"></i><b>40.4.1</b> 示例1：计算矩阵各列模的最大值</a></li>
<li class="chapter" data-level="40.4.2" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-vectype-mat-ex2"><i class="fa fa-check"></i><b>40.4.2</b> 示例2：把输入矩阵制作副本计算元素平方根</a></li>
<li class="chapter" data-level="40.4.3" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-vectype-mat-ex3"><i class="fa fa-check"></i><b>40.4.3</b> 示例3：访问列子集</a></li>
</ul></li>
<li class="chapter" data-level="40.5" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-vectype-other"><i class="fa fa-check"></i><b>40.5</b> Rcpp的其它向量类</a><ul>
<li class="chapter" data-level="40.5.1" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-vectype-logic"><i class="fa fa-check"></i><b>40.5.1</b> Rcpp的LogicalVector类</a></li>
<li class="chapter" data-level="40.5.2" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-vectype-char"><i class="fa fa-check"></i><b>40.5.2</b> Rcpp的CharacterVector类型</a></li>
</ul></li>
<li class="chapter" data-level="40.6" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-types"><i class="fa fa-check"></i><b>40.6</b> Rcpp提供的其它数据类型</a><ul>
<li class="chapter" data-level="40.6.1" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-types-named"><i class="fa fa-check"></i><b>40.6.1</b> Named类型</a></li>
<li class="chapter" data-level="40.6.2" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-types-list"><i class="fa fa-check"></i><b>40.6.2</b> List类型</a></li>
<li class="chapter" data-level="40.6.3" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-types-df"><i class="fa fa-check"></i><b>40.6.3</b> Rcpp的DataFrame类</a></li>
<li class="chapter" data-level="40.6.4" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-types-func"><i class="fa fa-check"></i><b>40.6.4</b> Rcpp的Function类</a></li>
<li class="chapter" data-level="40.6.5" data-path="rcpp-vectype.html"><a href="rcpp-vectype.html#rcpp-types-environ"><i class="fa fa-check"></i><b>40.6.5</b> Rcpp的Environment类</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="41" data-path="rcpp-sugar.html"><a href="rcpp-sugar.html"><i class="fa fa-check"></i><b>41</b> Rcpp糖</a><ul>
<li class="chapter" data-level="41.1" data-path="rcpp-sugar.html"><a href="rcpp-sugar.html#rcpp-sugar-examp"><i class="fa fa-check"></i><b>41.1</b> 简单示例</a></li>
<li class="chapter" data-level="41.2" data-path="rcpp-sugar.html"><a href="rcpp-sugar.html#rcpp-sugar-vecop"><i class="fa fa-check"></i><b>41.2</b> 向量化的运算符</a><ul>
<li class="chapter" data-level="41.2.1" data-path="rcpp-sugar.html"><a href="rcpp-sugar.html#rcpp-sugar-vecop-arith"><i class="fa fa-check"></i><b>41.2.1</b> 向量化的四则运算</a></li>
<li class="chapter" data-level="41.2.2" data-path="rcpp-sugar.html"><a href="rcpp-sugar.html#rcpp-sugar-vecop-binop"><i class="fa fa-check"></i><b>41.2.2</b> 向量化的二元逻辑运算</a></li>
<li class="chapter" data-level="41.2.3" data-path="rcpp-sugar.html"><a href="rcpp-sugar.html#rcpp-sugar-vecop-uop"><i class="fa fa-check"></i><b>41.2.3</b> 向量化的一元运算符</a></li>
</ul></li>
<li class="chapter" data-level="41.3" data-path="rcpp-sugar.html"><a href="rcpp-sugar.html#rcpp-sugar-mathfunc"><i class="fa fa-check"></i><b>41.3</b> 用Rcpp访问数学函数</a></li>
<li class="chapter" data-level="41.4" data-path="rcpp-sugar.html"><a href="rcpp-sugar.html#rcpp-sugar-any"><i class="fa fa-check"></i><b>41.4</b> 返回单一逻辑值的函数</a></li>
<li class="chapter" data-level="41.5" data-path="rcpp-sugar.html"><a href="rcpp-sugar.html#rcpp-sugar-expfunc"><i class="fa fa-check"></i><b>41.5</b> 返回糖表达式的函数</a></li>
<li class="chapter" data-level="41.6" data-path="rcpp-sugar.html"><a href="rcpp-sugar.html#rcpp-sugar-diff"><i class="fa fa-check"></i><b>41.6</b> R与Rcpp不同语法示例</a></li>
</ul></li>
<li class="chapter" data-level="42" data-path="rcpp-package.html"><a href="rcpp-package.html"><i class="fa fa-check"></i><b>42</b> 用Rcpp帮助制作R扩展包</a><ul>
<li class="chapter" data-level="42.1" data-path="rcpp-package.html"><a href="rcpp-package.html#rcpp-package-wo"><i class="fa fa-check"></i><b>42.1</b> 不用扩展包共享C++代码的方法</a></li>
<li class="chapter" data-level="42.2" data-path="rcpp-package.html"><a href="rcpp-package.html#rcpp-package-gen"><i class="fa fa-check"></i><b>42.2</b> 生成扩展包</a><ul>
<li class="chapter" data-level="42.2.1" data-path="rcpp-package.html"><a href="rcpp-package.html#rcpp-package-gen-exist"><i class="fa fa-check"></i><b>42.2.1</b> 利用已有基于Rcpp属性的源程序制作扩展包</a></li>
<li class="chapter" data-level="42.2.2" data-path="rcpp-package.html"><a href="rcpp-package.html#rcpp-package-gen-desc"><i class="fa fa-check"></i><b>42.2.2</b> DESCRIPTION文件</a></li>
<li class="chapter" data-level="42.2.3" data-path="rcpp-package.html"><a href="rcpp-package.html#rcpp-package-gen-namespace"><i class="fa fa-check"></i><b>42.2.3</b> NAMESPACE文件</a></li>
</ul></li>
<li class="chapter" data-level="42.3" data-path="rcpp-package.html"><a href="rcpp-package.html#rcpp-package-recomp"><i class="fa fa-check"></i><b>42.3</b> 重新编译</a></li>
<li class="chapter" data-level="42.4" data-path="rcpp-package.html"><a href="rcpp-package.html#rcpp-package-interface"><i class="fa fa-check"></i><b>42.4</b> 建立C++用的接口界面</a></li>
</ul></li>
<li class="part"><span><b>X 编程例子</b></span></li>
<li class="chapter" data-level="43" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>43</b> R编程例子</a><ul>
<li class="chapter" data-level="43.1" data-path="examples.html"><a href="examples.html#examples-rlang"><i class="fa fa-check"></i><b>43.1</b> R语言</a><ul>
<li class="chapter" data-level="43.1.1" data-path="examples.html"><a href="examples.html#examples-rlang-inverse"><i class="fa fa-check"></i><b>43.1.1</b> 用向量作逆变换</a></li>
<li class="chapter" data-level="43.1.2" data-path="examples.html"><a href="examples.html#examples-rlang-fibonacci"><i class="fa fa-check"></i><b>43.1.2</b> 斐波那契数列计算</a></li>
<li class="chapter" data-level="43.1.3" data-path="examples.html"><a href="examples.html#examples-rlang-permutation"><i class="fa fa-check"></i><b>43.1.3</b> 穷举所有排列</a></li>
<li class="chapter" data-level="43.1.4" data-path="examples.html"><a href="examples.html#examples-rlang-repgroup"><i class="fa fa-check"></i><b>43.1.4</b> 可重复分组方式穷举</a></li>
<li class="chapter" data-level="43.1.5" data-path="examples.html"><a href="examples.html#examples-rlang-runs"><i class="fa fa-check"></i><b>43.1.5</b> 升降连计数</a></li>
</ul></li>
<li class="chapter" data-level="43.2" data-path="examples.html"><a href="examples.html#examples-prob"><i class="fa fa-check"></i><b>43.2</b> 概率</a><ul>
<li class="chapter" data-level="43.2.1" data-path="examples.html"><a href="examples.html#examples-prob-thsage"><i class="fa fa-check"></i><b>43.2.1</b> 智者千虑必有一失</a></li>
<li class="chapter" data-level="43.2.2" data-path="examples.html"><a href="examples.html#examples-prob-coupleseats"><i class="fa fa-check"></i><b>43.2.2</b> 圆桌夫妇座位问题</a></li>
</ul></li>
<li class="chapter" data-level="43.3" data-path="examples.html"><a href="examples.html#examples-scicomp"><i class="fa fa-check"></i><b>43.3</b> 科学计算</a><ul>
<li class="chapter" data-level="43.3.1" data-path="examples.html"><a href="examples.html#examples-scicomp-citylink"><i class="fa fa-check"></i><b>43.3.1</b> 城市间最短路径</a></li>
<li class="chapter" data-level="43.3.2" data-path="examples.html"><a href="examples.html#examples-scicomp-daub"><i class="fa fa-check"></i><b>43.3.2</b> Daubechies小波函数计算</a></li>
<li class="chapter" data-level="43.3.3" data-path="examples.html"><a href="examples.html#examples-scicomp-heating"><i class="fa fa-check"></i><b>43.3.3</b> 房间加热温度变化</a></li>
</ul></li>
<li class="chapter" data-level="43.4" data-path="examples.html"><a href="examples.html#examples-statcomp"><i class="fa fa-check"></i><b>43.4</b> 统计计算</a><ul>
<li class="chapter" data-level="43.4.1" data-path="examples.html"><a href="examples.html#examples-statcomp-kernden"><i class="fa fa-check"></i><b>43.4.1</b> 核回归与核密度估计</a></li>
<li class="chapter" data-level="43.4.2" data-path="examples.html"><a href="examples.html#examples-statcomp-mcquad2d"><i class="fa fa-check"></i><b>43.4.2</b> 二维随机模拟积分</a></li>
<li class="chapter" data-level="43.4.3" data-path="examples.html"><a href="examples.html#examples-statcomp-hidfreq"><i class="fa fa-check"></i><b>43.4.3</b> 潜周期估计</a></li>
<li class="chapter" data-level="43.4.4" data-path="examples.html"><a href="examples.html#examples-statcomp-armaest"><i class="fa fa-check"></i><b>43.4.4</b> ARMA(1,1)模型估计</a></li>
<li class="chapter" data-level="43.4.5" data-path="examples.html"><a href="examples.html#examples-statcomp-varprop"><i class="fa fa-check"></i><b>43.4.5</b> VAR模型平稳性</a></li>
<li class="chapter" data-level="43.4.6" data-path="examples.html"><a href="examples.html#examples-statcomp-storereliab"><i class="fa fa-check"></i><b>43.4.6</b> 贮存可靠性评估</a></li>
</ul></li>
<li class="chapter" data-level="43.5" data-path="examples.html"><a href="examples.html#examples-datatreat"><i class="fa fa-check"></i><b>43.5</b> 数据处理</a><ul>
<li class="chapter" data-level="43.5.1" data-path="examples.html"><a href="examples.html#examples-datatreat-subscore"><i class="fa fa-check"></i><b>43.5.1</b> 小题分题型分数汇总</a></li>
<li class="chapter" data-level="43.5.2" data-path="examples.html"><a href="examples.html#examples-datatreat-cluslab"><i class="fa fa-check"></i><b>43.5.2</b> 类别编号重排</a></li>
</ul></li>
<li class="chapter" data-level="43.6" data-path="examples.html"><a href="examples.html#examples-texttr"><i class="fa fa-check"></i><b>43.6</b> 文本处理</a><ul>
<li class="chapter" data-level="43.6.1" data-path="examples.html"><a href="examples.html#examples-texttr-hongloument"><i class="fa fa-check"></i><b>43.6.1</b> 用R语言下载处理《红楼梦》htm文件</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="http://www.math.pku.edu.cn/teachers/lidf/" target="blank">编著：李东风</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R语言教程</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="stat-tsa" class="section level1">
<h1><span class="header-section-number">33</span> R时间序列分析</h1>
<p>这里仅仅给出了部分常用的时间序列函数的用法，
更详细的说明参见作者的<a href="http://www.math.pku.edu.cn/teachers/lidf/course/fts/ftsnotes/html/_ftsnotes/index.html">金融时间序列分析讲义</a>。</p>
<div id="stat-tsa-defs" class="section level2">
<h2><span class="header-section-number">33.1</span> 基本概念</h2>
<p>设<span class="math inline">\(\mathbb Z\)</span>为整数集，
<span class="math inline">\(\{X_t, t \in \mathbb Z\}\)</span>中<span class="math inline">\(X_t\)</span>是随机变量，
称<span class="math inline">\(\{ X_t \}\)</span>为时间序列。
如果<span class="math inline">\(\{ X_t \}\)</span>的有限维联合分布不随时间推移而变化，
称<span class="math inline">\(\{ X_t \}\)</span>为<strong>严平稳</strong>时间序列。
如果<span class="math inline">\(\{ X_t \}\)</span>二阶矩有限，
期望和方差不随时间而变化，
两个时间点之间的协方差只依赖于时间距离而不依赖于具体时间，
则称<span class="math inline">\(\{ X_t \}\)</span>为<strong>(宽)平稳</strong>时间序列。</p>
<p>如果<span class="math inline">\(X_t\)</span>是随机向量，
称<span class="math inline">\(\{ X_t \}\)</span>为多元（或多维）时间序列。</p>
<p>对宽平稳列<span class="math inline">\(\{ X_t \}\)</span>，
定义其自协方差函数(ACVF)为
<span class="math display">\[
  \gamma_k = \text{Cov}(X_{t+k}, X_t), \ k \in \mathbb Z .
\]</span>
定义其自相关函数(ACF)为
<span class="math display">\[
  \rho_k = \text{corr}(X_{t+k}, X_t) = \frac{\gamma_k}{\gamma_0}, \ k \in \mathbb Z .
\]</span></p>
<p>偏自相关函数(PACF)定义请参考时间序列分析的教材。</p>
<p>如果<span class="math inline">\(\sum_k |\gamma_k| &lt; \infty\)</span>，
则平稳列<span class="math inline">\(\{ X_t \}\)</span>有谱密度<span class="math inline">\(f(\lambda), \lambda \in [-\pi, \pi]\)</span>，
<span class="math inline">\(f(\lambda)\)</span>是非负可积偶函数，使得
<span class="math display">\[\begin{aligned}
  \gamma_k =&amp; \int_{-\pi}^{\pi} e^{ik\lambda} f(\lambda) \,d\lambda, \ k \in \mathbb Z, \\
  f(\lambda) =&amp; \frac{1}{2\pi} \sum_{k=-\infty}^{\infty} \gamma_k e^{-ik\lambda}, \ \lambda \in [-\pi, \pi] .
\end{aligned}\]</span></p>
<p>若平稳列<span class="math inline">\(\{ \varepsilon_t \}\)</span>的自协方差函数满足<span class="math inline">\(\gamma_0 = \sigma^2\)</span>,
<span class="math inline">\(\gamma_k = 0, k \neq 0\)</span>，
称<span class="math inline">\(\{ \varepsilon_t \}\)</span>为白噪声列。
如果均值为零，称为零均值白噪声列，
记为WN(0, <span class="math inline">\(\sigma^2\)</span>)。</p>
</div>
<div id="stat-tsa-dtype" class="section level2">
<h2><span class="header-section-number">33.2</span> 时间序列数据类型</h2>
<p>时间序列的数据可以保存在R的向量中，
或者保存在R的数据框的一列或几列中，
对应的时间单独保存或者保存在同一数据框中。</p>
<p>也有一些专门的时间序列数据类型，
将时间序列的观测数据与对应的时间同时保存在一个专用的数据结构中。</p>
<div id="stat-tsa-dtype-ts" class="section level3">
<h3><span class="header-section-number">33.2.1</span> ts类型</h3>
<p>R中最基本的时间序列类型是ts类型，
可以保存一元或者多元时间序列数据，
其中的时间必须是等间隔的，
比如年数据、月数据、季度数据、日数据，
不能在中间有缺失的日期。
生成方法如</p>
<div class="sourceCode" id="cb2299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2299-1"><a href="stat-tsa.html#cb2299-1"></a><span class="kw">ts</span>(x, <span class="dt">start=</span><span class="kw">c</span>(<span class="dv">2001</span>, <span class="dv">1</span>), <span class="dt">frequency=</span><span class="dv">12</span>)</span></code></pre></div>
<p>其中<code>x</code>是向量或者矩阵，
取矩阵值时矩阵的每一列是一个多元时间序列的一个分量。
<code>frequency</code>对月度数据是12，
对季度数据是4，
对年度数据可以缺省（值为1）。
<code>start=c(2001,1)</code>表示序列开始时间是2001年1月。
如果是年度数据，
用如<code>ts(x, start=2001)</code>即可。</p>
<p>例如：
用函数<code>ts</code>把一个向量转换为时间序列。
如</p>
<div class="sourceCode" id="cb2300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2300-1"><a href="stat-tsa.html#cb2300-1"></a>yd &lt;-<span class="st"> </span><span class="kw">ts</span>(</span>
<span id="cb2300-2"><a href="stat-tsa.html#cb2300-2"></a>  <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">7</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">5</span>,</span>
<span id="cb2300-3"><a href="stat-tsa.html#cb2300-3"></a>    <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">4</span>), </span>
<span id="cb2300-4"><a href="stat-tsa.html#cb2300-4"></a>  <span class="dt">frequency=</span><span class="dv">1</span>, <span class="dt">start=</span><span class="dv">2001</span>); yd</span></code></pre></div>
<pre><code>## Time Series:
## Start = 2001 
## End = 2024 
## Frequency = 1 
##  [1] 4 8 7 7 3 1 8 9 8 6 3 5 5 8 2 5 9 2 5 2 3 2 2 4</code></pre>
<div class="sourceCode" id="cb2302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2302-1"><a href="stat-tsa.html#cb2302-1"></a>ym &lt;-<span class="st"> </span><span class="kw">ts</span>(</span>
<span id="cb2302-2"><a href="stat-tsa.html#cb2302-2"></a>  <span class="kw">c</span>(<span class="dv">9</span>, <span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">3</span>,</span>
<span id="cb2302-3"><a href="stat-tsa.html#cb2302-3"></a>    <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">4</span>, <span class="dv">6</span>), </span>
<span id="cb2302-4"><a href="stat-tsa.html#cb2302-4"></a>  <span class="dt">frequency=</span><span class="dv">12</span>, <span class="dt">start=</span><span class="kw">c</span>(<span class="dv">2001</span>,<span class="dv">1</span>)); ym</span></code></pre></div>
<pre><code>##      Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec
## 2001   9   6   3   5   4   8   2   5   8   4   6   3
## 2002   2   2   6   4   1   4   2   1   8   9   4   6</code></pre>
<p>其中<code>yd</code>是年数据，从2001到2024年；
<code>ym</code>是月度数据从2001年1月到2002年12月。</p>
<p>对于多元时间序列，可以用ts函数把一个矩阵转换为ts类型的多元时间序列对象。
用ts.intersect函数和ts.union函数可以把两个或多个时间序列合并为多元时间序列，
时间段取交集或者取并集。</p>
<p>为了使用序列数据进行计算、绘图等，
可以用as.vector把时间序列的数据转换成普通向量。
如：</p>
<div class="sourceCode" id="cb2304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2304-1"><a href="stat-tsa.html#cb2304-1"></a><span class="kw">as.vector</span>(ym)</span></code></pre></div>
<pre><code>##  [1] 9 6 3 5 4 8 2 5 8 4 6 3 2 2 6 4 1 4 2 1 8 9 4 6</code></pre>
<div class="sourceCode" id="cb2306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2306-1"><a href="stat-tsa.html#cb2306-1"></a><span class="kw">class</span>(<span class="kw">as.vector</span>(ym))</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<p>在R中已安装的时间列示例数据有美国泛美航空公司1949-1960
的国际航班订票数的月度数据（单位：千人），12年144个月。
用</p>
<div class="sourceCode" id="cb2308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2308-1"><a href="stat-tsa.html#cb2308-1"></a><span class="kw">data</span>(AirPassengers)</span></code></pre></div>
<p>调入名字空间。类型和属性如下：</p>
<div class="sourceCode" id="cb2309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2309-1"><a href="stat-tsa.html#cb2309-1"></a><span class="kw">data</span>(AirPassengers)</span>
<span id="cb2309-2"><a href="stat-tsa.html#cb2309-2"></a><span class="kw">attributes</span>(AirPassengers)</span></code></pre></div>
<pre><code>## $tsp
## [1] 1949.000 1960.917   12.000
## 
## $class
## [1] &quot;ts&quot;</code></pre>
<p>这里时间以年为单位，
数据类属为ts，
两个数据值之间的时间间隔为<span class="math inline">\(1/12\)</span>。</p>
<p>AirPassengers的具体数值：</p>
<div class="sourceCode" id="cb2311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2311-1"><a href="stat-tsa.html#cb2311-1"></a>AirPassengers</span></code></pre></div>
<pre><code>##      Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec
## 1949 112 118 132 129 121 135 148 148 136 119 104 118
## 1950 115 126 141 135 125 149 170 170 158 133 114 140
## 1951 145 150 178 163 172 178 199 199 184 162 146 166
## 1952 171 180 193 181 183 218 230 242 209 191 172 194
## 1953 196 196 236 235 229 243 264 272 237 211 180 201
## 1954 204 188 235 227 234 264 302 293 259 229 203 229
## 1955 242 233 267 269 270 315 364 347 312 274 237 278
## 1956 284 277 317 313 318 374 413 405 355 306 271 306
## 1957 315 301 356 348 355 422 465 467 404 347 305 336
## 1958 340 318 362 348 363 435 491 505 404 359 310 337
## 1959 360 342 406 396 420 472 548 559 463 407 362 405
## 1960 417 391 419 461 472 535 622 606 508 461 390 432</code></pre>
<p>用<code>start()</code>求时间序列的开始点，
<code>end()</code>求时间序列的结束点，
<code>frequency()</code>求采样频率。
如</p>
<div class="sourceCode" id="cb2313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2313-1"><a href="stat-tsa.html#cb2313-1"></a><span class="kw">start</span>(AirPassengers)</span></code></pre></div>
<pre><code>## [1] 1949    1</code></pre>
<div class="sourceCode" id="cb2315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2315-1"><a href="stat-tsa.html#cb2315-1"></a><span class="kw">end</span>(AirPassengers)</span></code></pre></div>
<pre><code>## [1] 1960   12</code></pre>
<div class="sourceCode" id="cb2317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2317-1"><a href="stat-tsa.html#cb2317-1"></a><span class="kw">frequency</span>(AirPassengers)</span></code></pre></div>
<pre><code>## [1] 12</code></pre>
<p><code>aggregate()</code>函数可以把月度数据加总成年数据。
如</p>
<div class="sourceCode" id="cb2319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2319-1"><a href="stat-tsa.html#cb2319-1"></a>AP.year &lt;-<span class="st"> </span><span class="kw">aggregate</span>(AirPassengers); AP.year</span></code></pre></div>
<pre><code>## Time Series:
## Start = 1949 
## End = 1960 
## Frequency = 1 
##  [1] 1520 1676 2042 2364 2700 2867 3408 3939 4421 4572 5140 5714</code></pre>
<p>如果加参数<code>FUN=mean</code>可以取均值。</p>
<p><code>time()</code>函数对ts类型数据返回序列中的每个时间点的时间，
结果是一个和原来时间序列形状相同的时间序列。
<code>cycle()</code>函数对月度数据返回序列每个时间点所在的月份,
结果是和原序列时间点相同的一个时间序列。如</p>
<div class="sourceCode" id="cb2321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2321-1"><a href="stat-tsa.html#cb2321-1"></a>cy.AP &lt;-<span class="st"> </span><span class="kw">cycle</span>(AirPassengers); cy.AP</span></code></pre></div>
<pre><code>##      Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec
## 1949   1   2   3   4   5   6   7   8   9  10  11  12
## 1950   1   2   3   4   5   6   7   8   9  10  11  12
## 1951   1   2   3   4   5   6   7   8   9  10  11  12
## 1952   1   2   3   4   5   6   7   8   9  10  11  12
## 1953   1   2   3   4   5   6   7   8   9  10  11  12
## 1954   1   2   3   4   5   6   7   8   9  10  11  12
## 1955   1   2   3   4   5   6   7   8   9  10  11  12
## 1956   1   2   3   4   5   6   7   8   9  10  11  12
## 1957   1   2   3   4   5   6   7   8   9  10  11  12
## 1958   1   2   3   4   5   6   7   8   9  10  11  12
## 1959   1   2   3   4   5   6   7   8   9  10  11  12
## 1960   1   2   3   4   5   6   7   8   9  10  11  12</code></pre>
<p><code>window()</code>函数取出时间序列的一段，
如果指定<code>frequency=TRUE</code>还可以仅取出某个月（季度）。
如</p>
<div class="sourceCode" id="cb2323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2323-1"><a href="stat-tsa.html#cb2323-1"></a>AP.Jan &lt;-<span class="st"> </span><span class="kw">window</span>(AirPassengers, <span class="dt">start=</span><span class="kw">c</span>(<span class="dv">1949</span>,<span class="dv">1</span>), </span>
<span id="cb2323-2"><a href="stat-tsa.html#cb2323-2"></a>                 <span class="dt">frequency=</span><span class="ot">TRUE</span>); AP.Jan</span></code></pre></div>
<pre><code>## Time Series:
## Start = 1949 
## End = 1960 
## Frequency = 1 
##  [1] 112 115 145 171 196 204 242 284 315 340 360 417</code></pre>
<p><code>ts.union</code>可以形成多元时间序列。</p>
</div>
<div id="stat-tsa-dtype-xts" class="section level3">
<h3><span class="header-section-number">33.2.2</span> xts类型与常用函数</h3>
<p>xts也是一种时间序列数据类型，
既可以保存等间隔时间序列数据，
也可以保存不等间隔的时间序列数据，
并且xts类型的数据访问功能更为方便。
读入方法例如</p>
<div class="sourceCode" id="cb2325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2325-1"><a href="stat-tsa.html#cb2325-1"></a><span class="kw">xts</span>(x, date)</span></code></pre></div>
<p>其中<code>x</code>是向量、矩阵或数据框，
<code>date</code>是日期或者日期时间。
<code>x</code>取矩阵或者数据框时每列是一个时间序列。
如</p>
<div class="sourceCode" id="cb2326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2326-1"><a href="stat-tsa.html#cb2326-1"></a><span class="kw">library</span>(xts)</span></code></pre></div>
<pre><code>## 载入需要的程辑包：zoo</code></pre>
<pre><code>## 
## 载入程辑包：&#39;zoo&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     as.Date, as.Date.numeric</code></pre>
<div class="sourceCode" id="cb2330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2330-1"><a href="stat-tsa.html#cb2330-1"></a><span class="kw">library</span>(lubridate)</span></code></pre></div>
<pre><code>## 
## 载入程辑包：&#39;lubridate&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     date</code></pre>
<div class="sourceCode" id="cb2333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2333-1"><a href="stat-tsa.html#cb2333-1"></a>xts<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">xts</span>(</span>
<span id="cb2333-2"><a href="stat-tsa.html#cb2333-2"></a>  <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">4</span>), </span>
<span id="cb2333-3"><a href="stat-tsa.html#cb2333-3"></a>  <span class="kw">make_date</span>(<span class="dv">2018</span>, <span class="dv">1</span>, <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ddays</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">11</span>)); xts<span class="fl">.1</span></span></code></pre></div>
<pre><code>##            [,1]
## 2018-01-01    5
## 2018-01-02    5
## 2018-01-03    4
## 2018-01-04    6
## 2018-01-05    4
## 2018-01-06    3
## 2018-01-07    3
## 2018-01-08    3
## 2018-01-09    4
## 2018-01-10    5
## 2018-01-11    5
## 2018-01-12    4</code></pre>
<p>如果数据框中一列是日期时间，
其它列是时间序列数据，
就可以用<code>xts()</code>转化成xts类型。</p>
<p>其它时间序列类型可以用<code>as.xts()</code>转换成xts类型，如</p>
<div class="sourceCode" id="cb2335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2335-1"><a href="stat-tsa.html#cb2335-1"></a><span class="kw">as.xts</span>(ym)</span></code></pre></div>
<pre><code>##           [,1]
## 1月 2001     9
## 2月 2001     6
## 3月 2001     3
## 4月 2001     5
## 5月 2001     4
## 6月 2001     8
## 7月 2001     2
## 8月 2001     5
## 9月 2001     8
## 10月 2001    4
## 11月 2001    6
## 12月 2001    3
## 1月 2002     2
## 2月 2002     2
## 3月 2002     6
## 4月 2002     4
## 5月 2002     1
## 6月 2002     4
## 7月 2002     2
## 8月 2002     1
## 9月 2002     8
## 10月 2002    9
## 11月 2002    4
## 12月 2002    6</code></pre>
<p>有了xts类型的变量<code>x</code>后，
可以用<code>coredata(x)</code>返回<code>x</code>的不包含时间的纯数据；
用<code>index(x)</code>返回<code>x</code>的时间标签。
这两个函数很有用。</p>
<p>xts类型支持强大的子集提取功能。
若<code>x</code>是xts类型，
则<code>x[i]</code>可以取出行子集，
<code>x[i,j]</code>可以取出行、列子集，
其中<code>i</code>可以是整数下标，
还可以是包含日期时间的字符串向量，
日期时间类型的向量等。
日期时间字符串的格式为<code>CCYY-MM-DD HH:MM:SS</code>，
而且可以省略后面的一部分，
其含义是取出前面部分能匹配的所有时间点，
这种设计使得取出某年、某月的数据变得十分方便。
如</p>
<div class="sourceCode" id="cb2337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2337-1"><a href="stat-tsa.html#cb2337-1"></a><span class="kw">data</span>(AirPassengers)</span>
<span id="cb2337-2"><a href="stat-tsa.html#cb2337-2"></a>xts.ap &lt;-<span class="st"> </span><span class="kw">as.xts</span>(AirPassengers)</span>
<span id="cb2337-3"><a href="stat-tsa.html#cb2337-3"></a>xts.ap[<span class="st">&quot;1949&quot;</span>]</span></code></pre></div>
<pre><code>##           [,1]
## 1月 1949   112
## 2月 1949   118
## 3月 1949   132
## 4月 1949   129
## 5月 1949   121
## 6月 1949   135
## 7月 1949   148
## 8月 1949   148
## 9月 1949   136
## 10月 1949  119
## 11月 1949  104
## 12月 1949  118</code></pre>
<p>又比如，设<code>x</code>是某个股票的每分钟的数据，
则<code>x["2018-01-18 08"]</code>取出2018-1-18 8:00-9:00之间的所有数据。</p>
<p>也可以用<code>"from/to"</code>的格式指定一个日期时间范围，
而且也不需要开始点和结束点恰好有数据，
<code>from</code>和<code>to</code>的时间精度也不需要与数据的实际采样频率相同。
省略<code>from</code>则从头开始，
省略<code>to</code>则直到末尾。
如</p>
<div class="sourceCode" id="cb2339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2339-1"><a href="stat-tsa.html#cb2339-1"></a>xts<span class="fl">.1</span>[<span class="st">&quot;2018-01-10/2018-01-14&quot;</span>]</span></code></pre></div>
<pre><code>##            [,1]
## 2018-01-10    5
## 2018-01-11    5
## 2018-01-12    4</code></pre>
<p><code>first(x, n)</code>和<code>last(x, n)</code>类似于<code>head(x, n)</code>和<code>last(x, n)</code>，
但是对xts对象<code>x</code>，<code>n</code>除了可以取正整数值以外，
还允许用字符串指定时间长度，
允许的单位包括
secs, seconds, mins, minutes, hours, days, weeks, months, quarters, years。
比如，取出开头的三个月：</p>
<div class="sourceCode" id="cb2341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2341-1"><a href="stat-tsa.html#cb2341-1"></a><span class="kw">first</span>(xts.ap, <span class="st">&quot;3 months&quot;</span>)</span></code></pre></div>
<pre><code>##          [,1]
## 1月 1949  112
## 2月 1949  118
## 3月 1949  132</code></pre>
<p>字符串中取负值时表示扣除，如扣除开始的3个月：</p>
<div class="sourceCode" id="cb2343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2343-1"><a href="stat-tsa.html#cb2343-1"></a><span class="kw">start</span>(xts.ap)</span></code></pre></div>
<pre><code>## [1] &quot;1月 1949&quot;</code></pre>
<div class="sourceCode" id="cb2345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2345-1"><a href="stat-tsa.html#cb2345-1"></a><span class="kw">start</span>(<span class="kw">first</span>(xts.ap, <span class="st">&quot;-3 months&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;4月 1949&quot;</code></pre>
<p>取出的单位可以是比实际采样频率更大的时间单位，
比如，
分钟数据可以用<code>last(x, "1 day")</code>取出最后一天的的所有数据。
但是，取出的单位不能比实际采样频率更小，
比如，日数据不能用小时单位取出。</p>
<p>xts的时间下标也可以是一个日期或者日期时间类型的向量。
支持的类型包括
Date, POSIXct, chron, yearmon, yearqtr, timeDate。
可用<code>index(x)</code>函数来读取或者修改xts类型的时间下标。
用<code>coredata(x)</code>取出不包含日期时间线信息的实际数据。</p>
<p>可以用<code>to.period(x, period)</code>将其xts类型的时间序列降频成<code>period</code>指定的采样频率，
如<code>to.period(x, period="days")</code>。</p>
</div>
</div>
<div id="stat-tsa-basicstat" class="section level2">
<h2><span class="header-section-number">33.3</span> 基本分析与作图</h2>
<p>对ts和xts类型，
仍可用<code>length()</code>, <code>mean()</code>, <code>sd()</code>等函数计算基本的统计量。</p>
<p>对ts类型，<code>plot()</code>函数作曲线图，如：</p>
<div class="sourceCode" id="cb2347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2347-1"><a href="stat-tsa.html#cb2347-1"></a><span class="kw">data</span>(AirPassengers)</span>
<span id="cb2347-2"><a href="stat-tsa.html#cb2347-2"></a><span class="kw">plot</span>(AirPassengers)</span></code></pre></div>
<p><img src="static/picture/tsa-bst-ap01-1.png" width="672" /></p>
<p>对xts类型，
<code>plot()</code>函数作时间序列曲线图，
对多元时间序列，
可以选择每个分量单独在一个坐标系中作图也可以重叠在一个坐标系中(用<code>multi.panel = TRUE</code>选项)。
如</p>
<div class="sourceCode" id="cb2348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2348-1"><a href="stat-tsa.html#cb2348-1"></a>xts.ap &lt;-<span class="st"> </span><span class="kw">as.xts</span>(AirPassengers)</span>
<span id="cb2348-2"><a href="stat-tsa.html#cb2348-2"></a><span class="kw">plot</span>(xts.ap, <span class="dt">main=</span><span class="st">&quot;Air Passengers&quot;</span>,</span>
<span id="cb2348-3"><a href="stat-tsa.html#cb2348-3"></a>     <span class="dt">major.ticks=</span><span class="st">&quot;years&quot;</span>, <span class="dt">minor.ticks=</span><span class="ot">NULL</span>, </span>
<span id="cb2348-4"><a href="stat-tsa.html#cb2348-4"></a>     <span class="dt">grid.ticks.on=</span><span class="st">&quot;years&quot;</span>,</span>
<span id="cb2348-5"><a href="stat-tsa.html#cb2348-5"></a>     <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="static/picture/tsa-bst-ap02-1.png" width="672" /></p>
<p>对ts类型，可以用<code>as.vector(x)</code>提取不包含日期时间信息的数据，结果是向量；
对xts类型，可以用<code>coredata(x)</code>提取不包含日期时间信息的数据，
结果不论一元还是多元时间序列都是矩阵。
取出数据后，
用通常的统计估计、图形方法可以进行一些探索性分析，
如直方图(<code>hist()</code>)、盒形图(<code>boxplot()</code>)、QQ图(<code>qqnorm()</code>和<code>qqline()</code>)、散点图(<code>plot()</code>)等。</p>
<p><code>stats::lag()</code>可以计算滞后序列，
对ts类型输入，
<code>lag()</code>的作用是序列数值不变，
但是时间标签增加一个单位或者用<code>k=</code>指定的间隔。
所以，
为了得到通常理解的滞后1序列，应该使用<code>stats::lag(x, k=-1)</code>，
如</p>
<div class="sourceCode" id="cb2349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2349-1"><a href="stat-tsa.html#cb2349-1"></a>stats<span class="op">::</span><span class="kw">lag</span>(<span class="kw">ts</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">start=</span><span class="dv">2001</span>), <span class="dt">k=</span><span class="op">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## Time Series:
## Start = 2002 
## End = 2006 
## Frequency = 1 
## [1] 1 2 3 4 5</code></pre>
<p><code>diff(x)</code>计算一阶差分，
<code>diff(x, lag, differences)</code>计算滞后为<code>lag</code>的阶数位<code>differences</code>的差分。</p>
<p><code>acf</code>和<code>pacf</code>函数可以作自相关、自协方差和偏自相关函数图，
并可返回这些函数的估计值。
参见<a href="stat-tsa.html#stat-tsa-arima-sim-ar4">33.4.2.1</a>。</p>
<p><code>filter</code>函数可以计算递推的或卷积的滤波。</p>
<p><code>arima</code>可以拟合ARIMA模型。
<code>arima.sim</code>可以模拟生成ARIMA模型的数据。</p>
</div>
<div id="stat-tsa-arima" class="section level2">
<h2><span class="header-section-number">33.4</span> ARIMA建模和模拟</h2>
<div id="stat-tsa-arima-def" class="section level3">
<h3><span class="header-section-number">33.4.1</span> 模型公式</h3>
<p>AR(<span class="math inline">\(p\)</span>)模型（零均值）：
<span class="math display">\[\begin{aligned}
  X_t = a_1 X_{t-1} + a_2 X_{t-2} + \dots + a_p X_{t-p} + \varepsilon_t,
  \ \{ \varepsilon_t \} \sim \text{WN}(0, \sigma^2),
\end{aligned}\]</span>
参数为<span class="math inline">\(a_1, \dots, a_p, \sigma^2\)</span>，
满足
<span class="math display">\[
  A(z) = 1 - a_1 z - \dots - a_p z^p \neq 0, \ \forall |z| \leq 1, \ z \in \mathbb C,
\]</span>
<span class="math inline">\(\mathbb C\)</span>为复数域。</p>
<p>可逆MA(<span class="math inline">\(q\)</span>)模型（零均值）：
<span class="math display">\[\begin{aligned}
  X_t = \varepsilon_t + b_1 \varepsilon_{t-1} + \dots + b_1 \varepsilon_{t-q},
  \ \{ \varepsilon_t \} \sim \text{WN}(0, \sigma^2),
\end{aligned}\]</span>
满足
<span class="math display">\[
  B(z) = 1 + b_1 z + \dots + b_q z^q \neq 0, \ \forall |z| \leq 1, \ z \in \mathbb C .
\]</span></p>
<p>零均值可逆ARMA(<span class="math inline">\(p,q\)</span>)模型：
<span class="math display">\[\begin{aligned}
  X_t = a_1 X_{t-1} + a_2 X_{t-2} + \dots + a_p X_{t-p} 
  + \varepsilon_t + b_1 \varepsilon_{t-1} + \dots + b_1 \varepsilon_{t-q},
  \ \{ \varepsilon_t \} \sim \text{WN}(0, \sigma^2) .
\end{aligned}\]</span></p>
<p>记一阶差分为<span class="math inline">\(\Delta X_t = X_t - X_{t-1}\)</span>，
<span class="math inline">\(d\)</span>阶差分为<span class="math inline">\(\Delta^d X_t = \Delta(\Delta^{d-1} X_t)\)</span>，
事实上
<span class="math display">\[\begin{aligned}
  \Delta^d X_t = \sum_{j=0}^d C_d^j (-1)^j X_{t-j} .
\end{aligned}\]</span>
其中<span class="math inline">\(C_d^j\)</span>是<span class="math inline">\(k\)</span>取<span class="math inline">\(j\)</span>的组合个数。</p>
<p>ARIMA(<span class="math inline">\(p,d,q\)</span>)模型：
如果<span class="math inline">\(\{ \Delta^d X_t \}\)</span>满足零均值可逆ARMA(<span class="math inline">\(p,q\)</span>)模型，
就称<span class="math inline">\(\{ X_t \}\)</span>满足ARIMA(<span class="math inline">\(p,d,q\)</span>)模型。</p>
</div>
<div id="stat-tsa-arima-sim" class="section level3">
<h3><span class="header-section-number">33.4.2</span> 模拟</h3>
<p>用<code>arima.sim()</code>函数可以模拟生成ARIMA模型的数据，
也可以用来模拟AR、MA、ARMA。
<code>arima.sim()</code>输出ts类型的时间序列，
并且在模型有一阶单位根时会比要求的个数多输出一个值，
第一个值为初值0。</p>
<div id="stat-tsa-arima-sim-ar4" class="section level4">
<h4><span class="header-section-number">33.4.2.1</span> AR(4)模拟例子</h4>
<p>考虑如下的AR(4)模型：</p>
<p><span class="math display" id="eq:stat-tsa-arima-ar4">\[\begin{align}
 X_t =&amp; -0.9 X_{t-1} - 1.4 X_{t-2} - 0.7 X_{t-3} - 0.6 X_{t-4} \\
  &amp; + \varepsilon_t + 0.5\varepsilon_{t-1} - 0.4\varepsilon_{t-2},  
  \quad t\in \mathbb Z, 
  \tag{33.1}
\end{align}\]</span>
其中<span class="math inline">\(\{\varepsilon_t \}\)</span>为WN(0, 4)。</p>
<p>用如下程序模拟生成长度为<span class="math inline">\(N=100\)</span>的样本：</p>
<div class="sourceCode" id="cb2351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2351-1"><a href="stat-tsa.html#cb2351-1"></a><span class="kw">set.seed</span>(<span class="dv">101</span>)</span>
<span id="cb2351-2"><a href="stat-tsa.html#cb2351-2"></a>xar4 &lt;-<span class="st"> </span><span class="kw">arima.sim</span>(</span>
<span id="cb2351-3"><a href="stat-tsa.html#cb2351-3"></a>  <span class="dt">model=</span><span class="kw">list</span>(<span class="dt">ar=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.9</span>, <span class="fl">-1.4</span>, <span class="fl">-0.7</span>, <span class="fl">-0.6</span>)),</span>
<span id="cb2351-4"><a href="stat-tsa.html#cb2351-4"></a>  <span class="dt">n =</span> <span class="dv">100</span>,</span>
<span id="cb2351-5"><a href="stat-tsa.html#cb2351-5"></a>  <span class="dt">sd =</span> <span class="kw">sqrt</span>(<span class="dv">4</span>) )</span></code></pre></div>
<p>作时间序列图：</p>
<div class="sourceCode" id="cb2352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2352-1"><a href="stat-tsa.html#cb2352-1"></a><span class="kw">plot</span>(xar4)</span></code></pre></div>
<p><img src="static/picture/tsa-arima-sim-ar4b-1.png" width="672" /></p>
<p>作ACF图：</p>
<div class="sourceCode" id="cb2353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2353-1"><a href="stat-tsa.html#cb2353-1"></a><span class="kw">acf</span>(xar4)</span></code></pre></div>
<p><img src="static/picture/tsa-arima-sim-ar4c-1.png" width="672" /></p>
<p>作PACF图（偏自相关函数图）：</p>
<div class="sourceCode" id="cb2354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2354-1"><a href="stat-tsa.html#cb2354-1"></a><span class="kw">pacf</span>(xar4)</span></code></pre></div>
<p><img src="static/picture/tsa-arima-sim-ar4d-1.png" width="672" /></p>
<p><code>acf(x)</code>加<code>type</code>选项和<code>plot=FALSE</code>选项可以返回估计的自协方差函数、自相关函数、偏自相关函数。
如：</p>
<div class="sourceCode" id="cb2355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2355-1"><a href="stat-tsa.html#cb2355-1"></a><span class="co">## 前10个自相关函数值：</span></span>
<span id="cb2355-2"><a href="stat-tsa.html#cb2355-2"></a><span class="kw">round</span>(<span class="kw">c</span>( <span class="kw">acf</span>(xar4, <span class="dt">lag.max=</span><span class="dv">10</span>, <span class="dt">type=</span><span class="st">&quot;correlation&quot;</span>, <span class="dt">plot=</span><span class="ot">FALSE</span>)<span class="op">$</span>acf ), <span class="dv">4</span>)</span></code></pre></div>
<pre><code>##  [1]  1.0000 -0.2984 -0.5258  0.3435  0.0213  0.0134  0.0241 -0.2397  0.1273
## [10]  0.1889 -0.1493</code></pre>
<div class="sourceCode" id="cb2357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2357-1"><a href="stat-tsa.html#cb2357-1"></a><span class="co">## 前10个自协方差函数值：</span></span>
<span id="cb2357-2"><a href="stat-tsa.html#cb2357-2"></a><span class="kw">round</span>(<span class="kw">c</span>( <span class="kw">acf</span>(xar4, <span class="dt">lag.max=</span><span class="dv">10</span>, <span class="dt">type=</span><span class="st">&quot;covariance&quot;</span>, <span class="dt">plot=</span><span class="ot">FALSE</span>)<span class="op">$</span>acf ), <span class="dv">4</span>)</span></code></pre></div>
<pre><code>##  [1] 11.6502 -3.4762 -6.1260  4.0017  0.2478  0.1566  0.2809 -2.7920  1.4831
## [10]  2.2008 -1.7390</code></pre>
<div class="sourceCode" id="cb2359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2359-1"><a href="stat-tsa.html#cb2359-1"></a><span class="co">## 前9个偏自相关函数值：</span></span>
<span id="cb2359-2"><a href="stat-tsa.html#cb2359-2"></a><span class="kw">round</span>(<span class="kw">c</span>( <span class="kw">acf</span>(xar4, <span class="dt">lag.max=</span><span class="dv">9</span>, <span class="dt">type=</span><span class="st">&quot;partial&quot;</span>, <span class="dt">plot=</span><span class="ot">FALSE</span>)<span class="op">$</span>acf ), <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] -0.2984 -0.6750 -0.2434 -0.5189 -0.0533 -0.0744 -0.1345 -0.1602 -0.1043</code></pre>
<p>注意自相关函数、自协方差函数都是从滞后0开始（即<span class="math inline">\(\rho_0\)</span>, <span class="math inline">\(\gamma_0\)</span>），
而偏自相关函数从滞后1开始。</p>
<p>可以用<code>polyroot()</code>计算多项式的所有复根，
输入是从零次项到最高次项的系数。
可以用<code>Mod()</code>或<code>abs()</code>求复数模，如：</p>
<div class="sourceCode" id="cb2361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2361-1"><a href="stat-tsa.html#cb2361-1"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.9</span>, <span class="fl">-1.4</span>, <span class="fl">-0.7</span>, <span class="fl">-0.6</span>)</span>
<span id="cb2361-2"><a href="stat-tsa.html#cb2361-2"></a><span class="kw">Mod</span>(<span class="kw">polyroot</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="op">-</span>a)))</span></code></pre></div>
<pre><code>## [1] 1.134452 1.137989 1.137989 1.134452</code></pre>
<p>四个根都在单位圆外，
满足AR模型的最小相位条件。</p>
</div>
<div id="stat-tsa-arima-sim-ma2" class="section level4">
<h4><span class="header-section-number">33.4.2.2</span> MA(2)模拟例子</h4>
<p>考虑如下的MA(2)模型：</p>
<p><span class="math display" id="eq:stat-tsa-arima-ma2">\[\begin{align}
  X_t =&amp; \varepsilon_t + 0.5\varepsilon_{t-1} - 0.4\varepsilon_{t-2},  
  \quad t\in \mathbb Z, 
  \tag{33.2}
\end{align}\]</span>
其中<span class="math inline">\(\{\varepsilon_t \}\)</span>为WN(0, 4)。</p>
<p>模拟生成长度为100的样本，作时间序列图，
ACF，PACF图：</p>
<div class="sourceCode" id="cb2363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2363-1"><a href="stat-tsa.html#cb2363-1"></a><span class="kw">set.seed</span>(<span class="dv">101</span>)</span>
<span id="cb2363-2"><a href="stat-tsa.html#cb2363-2"></a>xma2 &lt;-<span class="st"> </span><span class="kw">arima.sim</span>(</span>
<span id="cb2363-3"><a href="stat-tsa.html#cb2363-3"></a>  <span class="dt">model=</span><span class="kw">list</span>(<span class="dt">ma=</span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">-0.4</span>)),</span>
<span id="cb2363-4"><a href="stat-tsa.html#cb2363-4"></a>  <span class="dt">n =</span> <span class="dv">100</span>,</span>
<span id="cb2363-5"><a href="stat-tsa.html#cb2363-5"></a>  <span class="dt">sd =</span> <span class="kw">sqrt</span>(<span class="dv">4</span>) )</span>
<span id="cb2363-6"><a href="stat-tsa.html#cb2363-6"></a><span class="kw">plot</span>(xma2)</span></code></pre></div>
<p><img src="static/picture/tsa-arima-sim-ma2-1.png" width="672" /></p>
<div class="sourceCode" id="cb2364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2364-1"><a href="stat-tsa.html#cb2364-1"></a><span class="kw">acf</span>(xma2)</span></code></pre></div>
<p><img src="static/picture/tsa-arima-sim-ma2-2.png" width="672" /></p>
<div class="sourceCode" id="cb2365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2365-1"><a href="stat-tsa.html#cb2365-1"></a><span class="kw">pacf</span>(xma2)</span></code></pre></div>
<p><img src="static/picture/tsa-arima-sim-ma2-3.png" width="672" /></p>
</div>
<div id="stat-tsa-arima-sim-arma42" class="section level4">
<h4><span class="header-section-number">33.4.2.3</span> ARMA(4,2)模拟例子</h4>
<p>考虑如下的ARMA(4,2)模型：</p>
<p><span class="math display" id="eq:stat-tsa-arima-arma42">\[\begin{align}
  X_t =&amp; -0.9 X_{t-1} - 1.4 X_{t-2} - 0.7 X_{t-3} - 0.6 X_{t-4} \\
  =&amp; \varepsilon_t + 0.5\varepsilon_{t-1} - 0.4\varepsilon_{t-2},  
  \quad t\in \mathbb Z, 
  \tag{33.3}
\end{align}\]</span>
其中<span class="math inline">\(\{\varepsilon_t \}\)</span>为WN(0, 4)。</p>
<p>用如下程序模拟生成长度为<span class="math inline">\(N=100\)</span>的样本，
并作时间序列图、ACF图、PACF图：</p>
<div class="sourceCode" id="cb2366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2366-1"><a href="stat-tsa.html#cb2366-1"></a><span class="kw">set.seed</span>(<span class="dv">101</span>)</span>
<span id="cb2366-2"><a href="stat-tsa.html#cb2366-2"></a>xarma42 &lt;-<span class="st"> </span><span class="kw">arima.sim</span>(</span>
<span id="cb2366-3"><a href="stat-tsa.html#cb2366-3"></a>  <span class="dt">model=</span><span class="kw">list</span>(</span>
<span id="cb2366-4"><a href="stat-tsa.html#cb2366-4"></a>    <span class="dt">ar=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.9</span>, <span class="fl">-1.4</span>, <span class="fl">-0.7</span>, <span class="fl">-0.6</span>),</span>
<span id="cb2366-5"><a href="stat-tsa.html#cb2366-5"></a>    <span class="dt">ma=</span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">-0.4</span>)),</span>
<span id="cb2366-6"><a href="stat-tsa.html#cb2366-6"></a>  <span class="dt">n =</span> <span class="dv">100</span>,</span>
<span id="cb2366-7"><a href="stat-tsa.html#cb2366-7"></a>  <span class="dt">sd =</span> <span class="kw">sqrt</span>(<span class="dv">4</span>) )</span>
<span id="cb2366-8"><a href="stat-tsa.html#cb2366-8"></a><span class="kw">plot</span>(xarma42)</span></code></pre></div>
<p><img src="static/picture/tsa-arima-sim-arma42-1.png" width="672" /></p>
<div class="sourceCode" id="cb2367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2367-1"><a href="stat-tsa.html#cb2367-1"></a><span class="kw">acf</span>(xarma42)</span></code></pre></div>
<p><img src="static/picture/tsa-arima-sim-arma42-2.png" width="672" /></p>
<div class="sourceCode" id="cb2368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2368-1"><a href="stat-tsa.html#cb2368-1"></a><span class="kw">pacf</span>(xarma42)</span></code></pre></div>
<p><img src="static/picture/tsa-arima-sim-arma42-3.png" width="672" /></p>
</div>
<div id="stat-tsa-arima-sim-arima412" class="section level4">
<h4><span class="header-section-number">33.4.2.4</span> ARIMA(4,1,2)模拟例子</h4>
<p>用如下程序模拟生成长度为<span class="math inline">\(N=100\)</span>的ARIMA(4,1,2)样本，
并作时间序列图、ACF图、PACF图。
要注意的是，
<code>arima.sim()</code>在有一阶差分时会输出<span class="math inline">\(n+1\)</span>个值。</p>
<div class="sourceCode" id="cb2369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2369-1"><a href="stat-tsa.html#cb2369-1"></a><span class="kw">set.seed</span>(<span class="dv">101</span>)</span>
<span id="cb2369-2"><a href="stat-tsa.html#cb2369-2"></a>xarima412 &lt;-<span class="st"> </span><span class="kw">arima.sim</span>(</span>
<span id="cb2369-3"><a href="stat-tsa.html#cb2369-3"></a>  <span class="dt">model=</span><span class="kw">list</span>(</span>
<span id="cb2369-4"><a href="stat-tsa.html#cb2369-4"></a>    <span class="dt">order =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb2369-5"><a href="stat-tsa.html#cb2369-5"></a>    <span class="dt">ar=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.9</span>, <span class="fl">-1.4</span>, <span class="fl">-0.7</span>, <span class="fl">-0.6</span>),</span>
<span id="cb2369-6"><a href="stat-tsa.html#cb2369-6"></a>    <span class="dt">ma=</span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">-0.4</span>)),</span>
<span id="cb2369-7"><a href="stat-tsa.html#cb2369-7"></a>  <span class="dt">n =</span> <span class="dv">100</span>,</span>
<span id="cb2369-8"><a href="stat-tsa.html#cb2369-8"></a>  <span class="dt">sd =</span> <span class="kw">sqrt</span>(<span class="dv">4</span>) )[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb2369-9"><a href="stat-tsa.html#cb2369-9"></a><span class="kw">ts.plot</span>(xarima412)</span></code></pre></div>
<p><img src="static/picture/tsa-arima-sim-arima412-1.png" width="672" /></p>
<div class="sourceCode" id="cb2370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2370-1"><a href="stat-tsa.html#cb2370-1"></a><span class="kw">acf</span>(xarima412)</span></code></pre></div>
<p><img src="static/picture/tsa-arima-sim-arima412-2.png" width="672" /></p>
<div class="sourceCode" id="cb2371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2371-1"><a href="stat-tsa.html#cb2371-1"></a><span class="kw">pacf</span>(xarima412)</span></code></pre></div>
<p><img src="static/picture/tsa-arima-sim-arima412-3.png" width="672" /></p>
</div>
</div>
<div id="stat-tsa-arima-armod" class="section level3">
<h3><span class="header-section-number">33.4.3</span> AR建模</h3>
<p><code>stats::ar(x, method="mle")</code>可以用最大似然估计方法估计模型参数并用AIC定阶。
如：</p>
<div class="sourceCode" id="cb2372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2372-1"><a href="stat-tsa.html#cb2372-1"></a>resar &lt;-<span class="st"> </span><span class="kw">ar</span>(xar4, <span class="dt">method=</span><span class="st">&quot;mle&quot;</span>); resar</span></code></pre></div>
<pre><code>## 
## Call:
## ar(x = xar4, method = &quot;mle&quot;)
## 
## Coefficients:
##       1        2        3        4  
## -0.7573  -1.2317  -0.5534  -0.5525  
## 
## Order selected 4  sigma^2 estimated as  3.712</code></pre>
<p>结果定阶为4阶，
模型可以写成：
<span class="math display">\[\begin{aligned}
  X_t =&amp; -0.7573 X_{t-1} - 1.2317 X_{t-2} - 0.5534 X_{t-3} - 0.5525 X_{t-4}
+ \varepsilon_t, \\
  &amp; \{\varepsilon_t \} \sim \text{WN}(0, 3.712) .
\end{aligned}\]</span></p>
<p><code>ar()</code>的结果是一个列表，
元素<code>order</code>是阶<span class="math inline">\(p\)</span>估计，
元素<code>ar</code>是<span class="math inline">\((a_1, \dots, a_p)\)</span>估计向量，
元素<code>var.pred</code>是<span class="math inline">\(\sigma^2\)</span>估计。</p>
</div>
<div id="stat-tsa-arima-armamod" class="section level3">
<h3><span class="header-section-number">33.4.4</span> ARMA建模</h3>
<p><code>stats::arima()</code>可以用最大似然方法估计AR、MA、ARMA和ARIMA模型，
需要人为指定<span class="math inline">\((p,d,q)\)</span>值。
如：</p>
<div class="sourceCode" id="cb2374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2374-1"><a href="stat-tsa.html#cb2374-1"></a>armares &lt;-<span class="st"> </span><span class="kw">arima</span>(</span>
<span id="cb2374-2"><a href="stat-tsa.html#cb2374-2"></a>  <span class="dv">100</span> <span class="op">+</span><span class="st"> </span>xarma42, <span class="dt">order =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">2</span>) )</span>
<span id="cb2374-3"><a href="stat-tsa.html#cb2374-3"></a>armares</span></code></pre></div>
<pre><code>## 
## Call:
## arima(x = 100 + xarma42, order = c(4, 0, 2))
## 
## Coefficients:
##           ar1      ar2      ar3      ar4     ma1      ma2  intercept
##       -0.6324  -1.0668  -0.4163  -0.4469  0.3191  -0.6423    99.9989
## s.e.   0.1195   0.1384   0.1350   0.1080  0.1237   0.1267     0.0371
## 
## sigma^2 estimated as 3.582:  log likelihood = -209.2,  aic = 434.4</code></pre>
<p>模型可以表示为：
<span class="math display">\[\begin{aligned}
EX_t =&amp; 99.9989 \\
Y_t =&amp; X_t - E X_t \\
Y_t =&amp; -0.6324 X_{t-1} - 1.0668 X_{t-2} - 0.4163 X_{t-3} - 0.4469 X_{t-4}
+ \varepsilon_t + 0.3191 \varepsilon_{t-1} - 0.6423 \varepsilon_{t-2}, \\
\{\varepsilon_t \} \sim&amp; \text{WN}(0, 3.582)
\end{aligned}\]</span>
另外，AIC值为434.4。
可以试验不同的阶，
找到AIC最低的模型。</p>
<p><code>arima()</code>的结果是一个列表，
其中<code>coef</code>是
<span class="math inline">\((a_1, \dots, a_p, b_1, \dots, b_q, \mu)\)</span>的估计。
<code>sigma2</code>是<span class="math inline">\(\sigma^2\)</span>的估计。
<code>var.coef</code>是<span class="math inline">\((a_1, \dots, a_p, b_1, \dots, b_q, \mu)\)</span>的估计的方差阵估计，
其对角线的平方根是相应的标准误差。
<code>residuals</code>是估计残差，
长度与输入时间序列相同。</p>
</div>
<div id="stat-tsa-arima-diag" class="section level3">
<h3><span class="header-section-number">33.4.5</span> 模型诊断</h3>
<p>将<code>arima()</code>的输出结果输入到<code>tsdiag()</code>函数，
可以进行模型诊断，
结果包括标准化残差、残差的ACF、残差的Ljung-Box白噪声检验p值，
检验对多个滞后值计算，
p值高于横虚线(0.05线)表示模型适合。</p>
<div class="sourceCode" id="cb2376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2376-1"><a href="stat-tsa.html#cb2376-1"></a><span class="kw">tsdiag</span>(armares)</span></code></pre></div>
<p><img src="static/picture/tsa-arima-diag01-1.png" width="672" /></p>
</div>
<div id="stat-tsa-arima-lbtest" class="section level3">
<h3><span class="header-section-number">33.4.6</span> 白噪声检验</h3>
<p>Ljung-Box检验是常用的白噪声检验，
零假设为数据来自白噪声列。
<code>Box.test(x, type="Ljung-Box", lag=m)</code>执行Ljung-Box白噪声检验,
<code>m</code>是用到的自相关函数个数。
如：</p>
<div class="sourceCode" id="cb2377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2377-1"><a href="stat-tsa.html#cb2377-1"></a><span class="kw">Box.test</span>(xarma42, <span class="dt">type=</span><span class="st">&quot;Ljung-Box&quot;</span>, <span class="dt">lag =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## 
##  Box-Ljung test
## 
## data:  xarma42
## X-squared = 80.473, df = 10, p-value = 4.056e-13</code></pre>
<p>如果要对ARMA或者ARIMA建模的残差进行白噪声检验，
需要加<code>fitdf</code>选项，取值为<span class="math inline">\(p+q\)</span>，如：</p>
<div class="sourceCode" id="cb2379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2379-1"><a href="stat-tsa.html#cb2379-1"></a><span class="kw">Box.test</span>(armares<span class="op">$</span>residuals, <span class="dt">type=</span><span class="st">&quot;Ljung-Box&quot;</span>, <span class="dt">lag =</span> <span class="dv">10</span>, <span class="dt">fitdf=</span><span class="dv">4</span><span class="op">+</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## 
##  Box-Ljung test
## 
## data:  armares$residuals
## X-squared = 6.2553, df = 4, p-value = 0.1809</code></pre>
<p>在0.05水平下结果不显著，
提示模型是合适的。</p>
</div>
<div id="stat-tsa-arima-sparse" class="section level3">
<h3><span class="header-section-number">33.4.7</span> 稀疏系数估计</h3>
<p><code>arima</code>函数允许指定某些系数固定为预先确定的值，
不从数据中估计。</p>
<p>例如，考虑如下的稀疏系数的ARMA(4,2)模型</p>
<p><span class="math display">\[\begin{aligned}
X_t =&amp; 100 + Y_t, \\
Y_t =&amp; 0.7 X_{t-4} + \varepsilon_t - 0.4 \varepsilon_{t-2},\\
\varepsilon_t \sim&amp; \text{WN}(0, 4)
\end{aligned}\]</span></p>
<p>产生模拟数据：</p>
<div class="sourceCode" id="cb2381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2381-1"><a href="stat-tsa.html#cb2381-1"></a><span class="kw">set.seed</span>(<span class="dv">101</span>)</span>
<span id="cb2381-2"><a href="stat-tsa.html#cb2381-2"></a>xsparma42 &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">+</span><span class="st"> </span><span class="kw">arima.sim</span>(</span>
<span id="cb2381-3"><a href="stat-tsa.html#cb2381-3"></a>  <span class="dt">model=</span><span class="kw">list</span>(</span>
<span id="cb2381-4"><a href="stat-tsa.html#cb2381-4"></a>    <span class="dt">ar=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.7</span>),</span>
<span id="cb2381-5"><a href="stat-tsa.html#cb2381-5"></a>    <span class="dt">ma=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">-0.4</span>)),</span>
<span id="cb2381-6"><a href="stat-tsa.html#cb2381-6"></a>  <span class="dt">n =</span> <span class="dv">100</span>,</span>
<span id="cb2381-7"><a href="stat-tsa.html#cb2381-7"></a>  <span class="dt">sd =</span> <span class="kw">sqrt</span>(<span class="dv">4</span>) )</span>
<span id="cb2381-8"><a href="stat-tsa.html#cb2381-8"></a><span class="kw">plot</span>(xsparma42)</span></code></pre></div>
<p><img src="static/picture/tsa-arima-sim-sparma42-1.png" width="672" /></p>
<div class="sourceCode" id="cb2382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2382-1"><a href="stat-tsa.html#cb2382-1"></a><span class="kw">acf</span>(xsparma42)</span></code></pre></div>
<p><img src="static/picture/tsa-arima-sim-sparma42-2.png" width="672" /></p>
<div class="sourceCode" id="cb2383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2383-1"><a href="stat-tsa.html#cb2383-1"></a><span class="kw">pacf</span>(xsparma42)</span></code></pre></div>
<p><img src="static/picture/tsa-arima-sim-sparma42-3.png" width="672" /></p>
<p>拟合ARMA(4,2)模型：</p>
<div class="sourceCode" id="cb2384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2384-1"><a href="stat-tsa.html#cb2384-1"></a>spres1 &lt;-<span class="st"> </span><span class="kw">arima</span>(</span>
<span id="cb2384-2"><a href="stat-tsa.html#cb2384-2"></a>  xsparma42, <span class="dt">order =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">2</span>) )</span>
<span id="cb2384-3"><a href="stat-tsa.html#cb2384-3"></a>spres1</span></code></pre></div>
<pre><code>## 
## Call:
## arima(x = xsparma42, order = c(4, 0, 2))
## 
## Coefficients:
##          ar1      ar2     ar3     ar4      ma1      ma2  intercept
##       0.0761  -0.0908  0.0078  0.6437  -0.0276  -0.4091    99.7500
## s.e.  0.1955   0.1963  0.1296  0.1314   0.2733   0.2860     0.3048
## 
## sigma^2 estimated as 4.066:  log likelihood = -213.21,  aic = 442.41</code></pre>
<p>计算各个系数估计除以标准误差的比值，
在系数为0的条件下近似服从标准正态分布：</p>
<div class="sourceCode" id="cb2386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2386-1"><a href="stat-tsa.html#cb2386-1"></a>zstat.arima &lt;-<span class="st"> </span><span class="cf">function</span>(arimares){</span>
<span id="cb2386-2"><a href="stat-tsa.html#cb2386-2"></a>  <span class="kw">with</span>(</span>
<span id="cb2386-3"><a href="stat-tsa.html#cb2386-3"></a>    arimares, {</span>
<span id="cb2386-4"><a href="stat-tsa.html#cb2386-4"></a>      y &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(coef))</span>
<span id="cb2386-5"><a href="stat-tsa.html#cb2386-5"></a>      <span class="kw">names</span>(y) &lt;-<span class="st"> </span><span class="kw">names</span>(coef)</span>
<span id="cb2386-6"><a href="stat-tsa.html#cb2386-6"></a>      y[mask] &lt;-<span class="st"> </span>coef[mask] <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">diag</span>(var.coef))</span>
<span id="cb2386-7"><a href="stat-tsa.html#cb2386-7"></a>      y</span>
<span id="cb2386-8"><a href="stat-tsa.html#cb2386-8"></a>    })</span>
<span id="cb2386-9"><a href="stat-tsa.html#cb2386-9"></a>}</span>
<span id="cb2386-10"><a href="stat-tsa.html#cb2386-10"></a><span class="kw">round</span>(<span class="kw">zstat.arima</span>(spres1), <span class="dv">2</span>)</span></code></pre></div>
<pre><code>##       ar1       ar2       ar3       ar4       ma1       ma2 intercept 
##      0.39     -0.46      0.06      4.90     -0.10     -1.43    327.21</code></pre>
<p>当近似Z统计量值在正负2之间时，
可认为相应的系数等于零，
用如下程序估计稀疏系数的ARMA模型：</p>
<div class="sourceCode" id="cb2388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2388-1"><a href="stat-tsa.html#cb2388-1"></a>spres2 &lt;-<span class="st"> </span><span class="kw">arima</span>(</span>
<span id="cb2388-2"><a href="stat-tsa.html#cb2388-2"></a>  xsparma42, <span class="dt">order =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">2</span>),</span>
<span id="cb2388-3"><a href="stat-tsa.html#cb2388-3"></a>  <span class="dt">fixed =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="ot">NA</span>, <span class="dv">0</span>, <span class="ot">NA</span>, <span class="ot">NA</span>),</span>
<span id="cb2388-4"><a href="stat-tsa.html#cb2388-4"></a>  <span class="dt">transform.pars =</span> <span class="ot">FALSE</span>)</span>
<span id="cb2388-5"><a href="stat-tsa.html#cb2388-5"></a>spres2</span></code></pre></div>
<pre><code>## 
## Call:
## arima(x = xsparma42, order = c(4, 0, 2), transform.pars = FALSE, fixed = c(0, 
##     0, 0, NA, 0, NA, NA))
## 
## Coefficients:
##       ar1  ar2  ar3     ar4  ma1      ma2  intercept
##         0    0    0  0.6837    0  -0.5035    99.7432
## s.e.    0    0    0  0.0757    0   0.0927     0.2996
## 
## sigma^2 estimated as 4.108:  log likelihood = -213.71,  aic = 435.42</code></pre>
<div class="sourceCode" id="cb2390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2390-1"><a href="stat-tsa.html#cb2390-1"></a><span class="kw">round</span>(<span class="kw">zstat.arima</span>(spres2), <span class="dv">2</span>)</span></code></pre></div>
<pre><code>##       ar1       ar2       ar3       ar4       ma1       ma2 intercept 
##      0.00      0.00      0.00      9.03      0.00     -5.43    332.96</code></pre>
<p>为了指定某些系数，
在<code>arima</code>中用<code>fixed=</code>选项，
需要指定的系数就输入指定的值，
需要从数据中估计的值就输入<code>NA</code>，
次序按<code>arima</code>显示结果时各个系数的次序。</p>
</div>
<div id="stat-tsa-arima-adftest" class="section level3">
<h3><span class="header-section-number">33.4.8</span> 单位根检验</h3>
<p>单位根检验是一种平稳性检验，
零假设是有单位根，
即不平稳；
对立假设是平稳。
经常使用增强的Dickey-Fuller检验(ADF检验)。</p>
<p>fUnitRoots包的<code>adfTest()</code>函数可以执行单位根ADF检验。
tseries包的<code>adf.test()</code>函数也可以执行单位根ADF检验。</p>
<p>注意，ADF检验都是在拒绝<span class="math inline">\(H_0\)</span>（显著）时否认有单位根，
不显著时承认有单位根。</p>
<p>例如，对模拟的ARMA(4,2)序列数据做单位根检验：</p>
<div class="sourceCode" id="cb2392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2392-1"><a href="stat-tsa.html#cb2392-1"></a>fUnitRoots<span class="op">::</span><span class="kw">adfTest</span>(<span class="dv">100</span> <span class="op">+</span><span class="st"> </span>xarma42, <span class="dt">lags=</span><span class="dv">8</span>, <span class="dt">type=</span><span class="st">&quot;c&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in fUnitRoots::adfTest(100 + xarma42, lags = 8, type = &quot;c&quot;): p-value
## smaller than printed p-value</code></pre>
<pre><code>## 
## Title:
##  Augmented Dickey-Fuller Test
## 
## Test Results:
##   PARAMETER:
##     Lag Order: 8
##   STATISTIC:
##     Dickey-Fuller: -5.2017
##   P VALUE:
##     0.01 
## 
## Description:
##  Fri Mar 27 17:22:20 2020 by user: user</code></pre>
<p>在0.05水平下显著，
说明没有单位根。
函数中的<code>lags</code>参数是用来作为对立假设的AR模型的阶。
可以先尝试拟合AR模型，
并用适当方法定阶，
然后再进行ADF检验。</p>
<p>对模拟的ARIMA(4,1,2)序列数据检验：</p>
<div class="sourceCode" id="cb2395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2395-1"><a href="stat-tsa.html#cb2395-1"></a>fUnitRoots<span class="op">::</span><span class="kw">adfTest</span>(xarima412, <span class="dt">lags=</span><span class="dv">8</span>, <span class="dt">type=</span><span class="st">&quot;c&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Title:
##  Augmented Dickey-Fuller Test
## 
## Test Results:
##   PARAMETER:
##     Lag Order: 8
##   STATISTIC:
##     Dickey-Fuller: -1.539
##   P VALUE:
##     0.4856 
## 
## Description:
##  Thu Apr 02 17:17:18 2020 by user: user</code></pre>
<p>在0.05水平下结果不显著，
说明有单位根。</p>
<p>选项<code>type</code>选择基础模型，
可以取：</p>
<ul>
<li><code>"nc"</code>，表示没有漂移项或截距项；</li>
<li><code>"c"</code>，表示带有一个漂移项或截距项；</li>
<li><code>"ct"</code>，表示基础模型中带有<span class="math inline">\(a + bt\)</span>这样的线性项。</li>
</ul>
</div>
<div id="stat-tsa-arima-cfuncs" class="section level3">
<h3><span class="header-section-number">33.4.9</span> ARMA模型的一些自定义函数</h3>
<p>这里列出一些与ARMA模型等时间序列理论有关的函数，
比如，
从模型参数计算Wold系数，
解Yule-Walker方程，
从模型参数计算协方差函数，
逆相关函数计算，
ARMA谱密度绘图，
MA矩估计，
Levinson递推，
递推预测，
等等。
欠缺逆相关法等少数的程序。</p>
<p>AR模型理论谱密度图：</p>
<div class="sourceCode" id="cb2397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2397-1"><a href="stat-tsa.html#cb2397-1"></a>ar.true.spectrum &lt;-<span class="st"> </span><span class="cf">function</span>(</span>
<span id="cb2397-2"><a href="stat-tsa.html#cb2397-2"></a>  a, <span class="dt">ngrid=</span><span class="dv">256</span>, <span class="dt">sigma=</span><span class="dv">1</span>, <span class="dt">plot.it=</span><span class="ot">TRUE</span>, </span>
<span id="cb2397-3"><a href="stat-tsa.html#cb2397-3"></a>  <span class="dt">title=</span><span class="st">&quot;AR True Spectral Density&quot;</span>){</span>
<span id="cb2397-4"><a href="stat-tsa.html#cb2397-4"></a>  p &lt;-<span class="st"> </span><span class="kw">length</span>(a)</span>
<span id="cb2397-5"><a href="stat-tsa.html#cb2397-5"></a>  freqs &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>, <span class="dt">to=</span>pi, <span class="dt">length=</span>ngrid)</span>
<span id="cb2397-6"><a href="stat-tsa.html#cb2397-6"></a>  spec &lt;-<span class="st"> </span><span class="kw">numeric</span>(ngrid)</span>
<span id="cb2397-7"><a href="stat-tsa.html#cb2397-7"></a>  <span class="cf">for</span>(ii <span class="cf">in</span> <span class="kw">seq</span>(ngrid)){</span>
<span id="cb2397-8"><a href="stat-tsa.html#cb2397-8"></a>    spec[ii] &lt;-<span class="st"> </span>sigma<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>pi) <span class="op">/</span><span class="st"> </span></span>
<span id="cb2397-9"><a href="stat-tsa.html#cb2397-9"></a><span class="st">      </span><span class="kw">abs</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">sum</span>(<span class="kw">complex</span>(<span class="dt">mod=</span>a, <span class="dt">arg=</span>freqs[ii]<span class="op">*</span><span class="kw">seq</span>(p))))<span class="op">^</span><span class="dv">2</span></span>
<span id="cb2397-10"><a href="stat-tsa.html#cb2397-10"></a>  }</span>
<span id="cb2397-11"><a href="stat-tsa.html#cb2397-11"></a>  <span class="cf">if</span>(plot.it){</span>
<span id="cb2397-12"><a href="stat-tsa.html#cb2397-12"></a>    <span class="kw">plot</span>(freqs, spec, <span class="dt">type=</span><span class="st">&#39;l&#39;</span>,</span>
<span id="cb2397-13"><a href="stat-tsa.html#cb2397-13"></a>         <span class="dt">main=</span>title,</span>
<span id="cb2397-14"><a href="stat-tsa.html#cb2397-14"></a>         <span class="dt">xlab=</span><span class="st">&quot;frequency&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;spectral density&quot;</span>,</span>
<span id="cb2397-15"><a href="stat-tsa.html#cb2397-15"></a>         <span class="dt">axes=</span><span class="ot">FALSE</span>)</span>
<span id="cb2397-16"><a href="stat-tsa.html#cb2397-16"></a>    <span class="kw">axis</span>(<span class="dv">2</span>)</span>
<span id="cb2397-17"><a href="stat-tsa.html#cb2397-17"></a>    <span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at=</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">6</span>)<span class="op">/</span><span class="dv">6</span><span class="op">*</span>pi,</span>
<span id="cb2397-18"><a href="stat-tsa.html#cb2397-18"></a>         <span class="dt">labels=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">expression</span>(pi<span class="op">/</span><span class="dv">6</span>),</span>
<span id="cb2397-19"><a href="stat-tsa.html#cb2397-19"></a>           <span class="kw">expression</span>(pi<span class="op">/</span><span class="dv">3</span>), <span class="kw">expression</span>(pi<span class="op">/</span><span class="dv">2</span>),</span>
<span id="cb2397-20"><a href="stat-tsa.html#cb2397-20"></a>           <span class="kw">expression</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span>), <span class="kw">expression</span>(<span class="dv">5</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">6</span>), <span class="kw">expression</span>(pi)))</span>
<span id="cb2397-21"><a href="stat-tsa.html#cb2397-21"></a>  }</span>
<span id="cb2397-22"><a href="stat-tsa.html#cb2397-22"></a>  <span class="kw">list</span>(<span class="dt">frequencies=</span>freqs, <span class="dt">spectrum=</span>spec,</span>
<span id="cb2397-23"><a href="stat-tsa.html#cb2397-23"></a>       <span class="dt">ar.coefficients=</span>a, <span class="dt">sigma=</span>sigma)</span>
<span id="cb2397-24"><a href="stat-tsa.html#cb2397-24"></a>}</span></code></pre></div>
<p>MA理论谱密度图：</p>
<div class="sourceCode" id="cb2398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2398-1"><a href="stat-tsa.html#cb2398-1"></a>ma.true.spectrum &lt;-<span class="st"> </span><span class="cf">function</span>(</span>
<span id="cb2398-2"><a href="stat-tsa.html#cb2398-2"></a>  a, <span class="dt">ngrid=</span><span class="dv">256</span>, <span class="dt">sigma=</span><span class="dv">1</span>,</span>
<span id="cb2398-3"><a href="stat-tsa.html#cb2398-3"></a>  <span class="dt">tit=</span><span class="st">&quot;True MA Spectral Density&quot;</span>,</span>
<span id="cb2398-4"><a href="stat-tsa.html#cb2398-4"></a>  <span class="dt">plot.it=</span><span class="ot">TRUE</span>){</span>
<span id="cb2398-5"><a href="stat-tsa.html#cb2398-5"></a>  p &lt;-<span class="st"> </span><span class="kw">length</span>(a)</span>
<span id="cb2398-6"><a href="stat-tsa.html#cb2398-6"></a>  freqs &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>, <span class="dt">to=</span>pi, <span class="dt">length=</span>ngrid)</span>
<span id="cb2398-7"><a href="stat-tsa.html#cb2398-7"></a>  spec &lt;-<span class="st"> </span><span class="kw">numeric</span>(ngrid)</span>
<span id="cb2398-8"><a href="stat-tsa.html#cb2398-8"></a>  <span class="cf">for</span>(ii <span class="cf">in</span> <span class="kw">seq</span>(ngrid)){</span>
<span id="cb2398-9"><a href="stat-tsa.html#cb2398-9"></a>    spec[ii] &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(<span class="kw">complex</span>(<span class="dt">mod=</span>a, <span class="dt">arg=</span>freqs[ii]<span class="op">*</span><span class="kw">seq</span>(p)))</span>
<span id="cb2398-10"><a href="stat-tsa.html#cb2398-10"></a>  }</span>
<span id="cb2398-11"><a href="stat-tsa.html#cb2398-11"></a>  spec =<span class="st"> </span>sigma<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>pi) <span class="op">*</span><span class="st"> </span><span class="kw">abs</span>(spec)<span class="op">^</span><span class="dv">2</span></span>
<span id="cb2398-12"><a href="stat-tsa.html#cb2398-12"></a>  <span class="cf">if</span>(plot.it){</span>
<span id="cb2398-13"><a href="stat-tsa.html#cb2398-13"></a>    <span class="kw">plot</span>(freqs, spec, <span class="dt">type=</span><span class="st">&#39;l&#39;</span>,</span>
<span id="cb2398-14"><a href="stat-tsa.html#cb2398-14"></a>         <span class="dt">main=</span>tit,</span>
<span id="cb2398-15"><a href="stat-tsa.html#cb2398-15"></a>         <span class="dt">xlab=</span><span class="st">&quot;frequency&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;spectrum&quot;</span>,</span>
<span id="cb2398-16"><a href="stat-tsa.html#cb2398-16"></a>         <span class="dt">axes=</span><span class="ot">FALSE</span>)</span>
<span id="cb2398-17"><a href="stat-tsa.html#cb2398-17"></a>    <span class="kw">axis</span>(<span class="dv">2</span>)</span>
<span id="cb2398-18"><a href="stat-tsa.html#cb2398-18"></a>    <span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at=</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">6</span>)<span class="op">/</span><span class="dv">6</span><span class="op">*</span>pi,</span>
<span id="cb2398-19"><a href="stat-tsa.html#cb2398-19"></a>         <span class="dt">labels=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">expression</span>(pi<span class="op">/</span><span class="dv">6</span>),</span>
<span id="cb2398-20"><a href="stat-tsa.html#cb2398-20"></a>           <span class="kw">expression</span>(pi<span class="op">/</span><span class="dv">3</span>), <span class="kw">expression</span>(pi<span class="op">/</span><span class="dv">2</span>),</span>
<span id="cb2398-21"><a href="stat-tsa.html#cb2398-21"></a>           <span class="kw">expression</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span>), <span class="kw">expression</span>(<span class="dv">5</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">6</span>), <span class="kw">expression</span>(pi)))</span>
<span id="cb2398-22"><a href="stat-tsa.html#cb2398-22"></a>    <span class="kw">box</span>()</span>
<span id="cb2398-23"><a href="stat-tsa.html#cb2398-23"></a>  }</span>
<span id="cb2398-24"><a href="stat-tsa.html#cb2398-24"></a>  <span class="kw">invisible</span>(<span class="kw">list</span>(<span class="dt">frequencies=</span>freqs, <span class="dt">spectrum=</span>spec,</span>
<span id="cb2398-25"><a href="stat-tsa.html#cb2398-25"></a>            <span class="dt">ma.coefficients=</span>a, <span class="dt">sigma=</span>sigma))</span>
<span id="cb2398-26"><a href="stat-tsa.html#cb2398-26"></a>}</span></code></pre></div>
<p>利用李雷的矩阵极限方法对MA模型参数作矩估计。
输入<span class="math inline">\(\gamma_0, \gamma_1, \dots, \gamma_q\)</span>，
输出MA参数<span class="math inline">\(b_1, \dots, b_q, \sigma^2\)</span>的估计。</p>
<div class="sourceCode" id="cb2399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2399-1"><a href="stat-tsa.html#cb2399-1"></a>ma.solve &lt;-<span class="st"> </span><span class="cf">function</span>(gms, <span class="dt">k=</span><span class="dv">100</span>){</span>
<span id="cb2399-2"><a href="stat-tsa.html#cb2399-2"></a>  q &lt;-<span class="st"> </span><span class="kw">length</span>(gms)<span class="op">-</span><span class="dv">1</span></span>
<span id="cb2399-3"><a href="stat-tsa.html#cb2399-3"></a>  <span class="cf">if</span>(q<span class="op">==</span><span class="dv">1</span>){</span>
<span id="cb2399-4"><a href="stat-tsa.html#cb2399-4"></a>    rho1 &lt;-<span class="st"> </span>gms[<span class="dv">2</span>] <span class="op">/</span><span class="st"> </span>gms[<span class="dv">1</span>]</span>
<span id="cb2399-5"><a href="stat-tsa.html#cb2399-5"></a>    b &lt;-<span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="dv">4</span><span class="op">*</span>rho1<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>rho1)</span>
<span id="cb2399-6"><a href="stat-tsa.html#cb2399-6"></a>    s2 &lt;-<span class="st"> </span>gms[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>b<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb2399-7"><a href="stat-tsa.html#cb2399-7"></a>    <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">b=</span>b, <span class="dt">s2=</span>s2))</span>
<span id="cb2399-8"><a href="stat-tsa.html#cb2399-8"></a>  }</span>
<span id="cb2399-9"><a href="stat-tsa.html#cb2399-9"></a>  </span>
<span id="cb2399-10"><a href="stat-tsa.html#cb2399-10"></a>  A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>q, <span class="dt">ncol=</span>q)</span>
<span id="cb2399-11"><a href="stat-tsa.html#cb2399-11"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="kw">seq</span>(<span class="dv">2</span>,q)){</span>
<span id="cb2399-12"><a href="stat-tsa.html#cb2399-12"></a>    A[j<span class="dv">-1</span>,j] &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb2399-13"><a href="stat-tsa.html#cb2399-13"></a>  }</span>
<span id="cb2399-14"><a href="stat-tsa.html#cb2399-14"></a>  cc &lt;-<span class="st"> </span><span class="kw">numeric</span>(q); cc[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb2399-15"><a href="stat-tsa.html#cb2399-15"></a>  gamma0 &lt;-<span class="st"> </span>gms[<span class="dv">1</span>]</span>
<span id="cb2399-16"><a href="stat-tsa.html#cb2399-16"></a>  gammas &lt;-<span class="st"> </span><span class="kw">numeric</span>(q<span class="op">+</span>k)</span>
<span id="cb2399-17"><a href="stat-tsa.html#cb2399-17"></a>  gammas[<span class="dv">1</span><span class="op">:</span>(q<span class="op">+</span><span class="dv">1</span>)] &lt;-<span class="st"> </span>gms</span>
<span id="cb2399-18"><a href="stat-tsa.html#cb2399-18"></a>  gamq &lt;-<span class="st"> </span>gms[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb2399-19"><a href="stat-tsa.html#cb2399-19"></a>  Gammak &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>k)</span>
<span id="cb2399-20"><a href="stat-tsa.html#cb2399-20"></a>  <span class="cf">for</span>(ii <span class="cf">in</span> <span class="kw">seq</span>(k)){</span>
<span id="cb2399-21"><a href="stat-tsa.html#cb2399-21"></a>    <span class="cf">for</span>(jj <span class="cf">in</span> <span class="kw">seq</span>(k)){</span>
<span id="cb2399-22"><a href="stat-tsa.html#cb2399-22"></a>      Gammak[ii,jj] &lt;-<span class="st"> </span>gammas[<span class="kw">abs</span>(ii<span class="op">-</span>jj)<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb2399-23"><a href="stat-tsa.html#cb2399-23"></a>    }</span>
<span id="cb2399-24"><a href="stat-tsa.html#cb2399-24"></a>  }</span>
<span id="cb2399-25"><a href="stat-tsa.html#cb2399-25"></a>  </span>
<span id="cb2399-26"><a href="stat-tsa.html#cb2399-26"></a>  Omk &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>q, <span class="dt">ncol=</span>k)</span>
<span id="cb2399-27"><a href="stat-tsa.html#cb2399-27"></a>  <span class="cf">for</span>(ii <span class="cf">in</span> <span class="kw">seq</span>(q)){</span>
<span id="cb2399-28"><a href="stat-tsa.html#cb2399-28"></a>    <span class="cf">for</span>(jj <span class="cf">in</span> <span class="kw">seq</span>(k)){</span>
<span id="cb2399-29"><a href="stat-tsa.html#cb2399-29"></a>      Omk[ii,jj] &lt;-<span class="st"> </span>gammas[ii<span class="op">+</span>jj<span class="dv">-1</span><span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb2399-30"><a href="stat-tsa.html#cb2399-30"></a>    }</span>
<span id="cb2399-31"><a href="stat-tsa.html#cb2399-31"></a>  }</span>
<span id="cb2399-32"><a href="stat-tsa.html#cb2399-32"></a>  PI &lt;-<span class="st"> </span>Omk <span class="op">%*%</span><span class="st"> </span><span class="kw">solve</span>(Gammak, <span class="kw">t</span>(Omk))</span>
<span id="cb2399-33"><a href="stat-tsa.html#cb2399-33"></a></span>
<span id="cb2399-34"><a href="stat-tsa.html#cb2399-34"></a>  s2 &lt;-<span class="st"> </span>gamma0 <span class="op">-</span><span class="st"> </span><span class="kw">c</span>(<span class="kw">t</span>(cc) <span class="op">%*%</span><span class="st"> </span>PI <span class="op">%*%</span><span class="st"> </span>cc)</span>
<span id="cb2399-35"><a href="stat-tsa.html#cb2399-35"></a>  b &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>s2 <span class="op">*</span><span class="st"> </span><span class="kw">c</span>(gamq <span class="op">-</span><span class="st"> </span>A <span class="op">%*%</span><span class="st"> </span>PI <span class="op">%*%</span><span class="st"> </span>cc)</span>
<span id="cb2399-36"><a href="stat-tsa.html#cb2399-36"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">b=</span>b, <span class="dt">s2=</span>s2))</span>
<span id="cb2399-37"><a href="stat-tsa.html#cb2399-37"></a>}</span></code></pre></div>
<p>ARMA理论谱密度图：</p>
<div class="sourceCode" id="cb2400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2400-1"><a href="stat-tsa.html#cb2400-1"></a>arma.true.spectrum &lt;-<span class="st"> </span><span class="cf">function</span>(</span>
<span id="cb2400-2"><a href="stat-tsa.html#cb2400-2"></a>  a, b, <span class="dt">ngrid=</span><span class="dv">256</span>, <span class="dt">sigma=</span><span class="dv">1</span>,</span>
<span id="cb2400-3"><a href="stat-tsa.html#cb2400-3"></a>  <span class="dt">tit=</span><span class="st">&quot;True ARMA Spectral Density&quot;</span>,</span>
<span id="cb2400-4"><a href="stat-tsa.html#cb2400-4"></a>  <span class="dt">plot.it=</span><span class="ot">TRUE</span>){</span>
<span id="cb2400-5"><a href="stat-tsa.html#cb2400-5"></a>  p &lt;-<span class="st"> </span><span class="kw">length</span>(a)</span>
<span id="cb2400-6"><a href="stat-tsa.html#cb2400-6"></a>  q &lt;-<span class="st"> </span><span class="kw">length</span>(b)</span>
<span id="cb2400-7"><a href="stat-tsa.html#cb2400-7"></a>  freqs &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>, <span class="dt">to=</span>pi, <span class="dt">length=</span>ngrid)</span>
<span id="cb2400-8"><a href="stat-tsa.html#cb2400-8"></a>  spec1 &lt;-<span class="st"> </span><span class="kw">numeric</span>(ngrid)</span>
<span id="cb2400-9"><a href="stat-tsa.html#cb2400-9"></a>  spec2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(ngrid)</span>
<span id="cb2400-10"><a href="stat-tsa.html#cb2400-10"></a>  <span class="cf">for</span>(ii <span class="cf">in</span> <span class="kw">seq</span>(ngrid)){</span>
<span id="cb2400-11"><a href="stat-tsa.html#cb2400-11"></a>    spec1[ii] &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(<span class="kw">complex</span>(<span class="dt">mod=</span>b, <span class="dt">arg=</span>freqs[ii]<span class="op">*</span><span class="kw">seq</span>(q)))</span>
<span id="cb2400-12"><a href="stat-tsa.html#cb2400-12"></a>    spec2[ii] &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">sum</span>(<span class="kw">complex</span>(<span class="dt">mod=</span>a, <span class="dt">arg=</span>freqs[ii]<span class="op">*</span><span class="kw">seq</span>(p)))</span>
<span id="cb2400-13"><a href="stat-tsa.html#cb2400-13"></a>  }</span>
<span id="cb2400-14"><a href="stat-tsa.html#cb2400-14"></a>  spec =<span class="st"> </span>sigma<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>pi) <span class="op">*</span><span class="st"> </span><span class="kw">abs</span>(spec1)<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="kw">abs</span>(spec2)<span class="op">^</span><span class="dv">2</span></span>
<span id="cb2400-15"><a href="stat-tsa.html#cb2400-15"></a>  <span class="cf">if</span>(plot.it){</span>
<span id="cb2400-16"><a href="stat-tsa.html#cb2400-16"></a>    <span class="kw">plot</span>(freqs, spec, <span class="dt">type=</span><span class="st">&#39;l&#39;</span>,</span>
<span id="cb2400-17"><a href="stat-tsa.html#cb2400-17"></a>         <span class="dt">main=</span>tit,</span>
<span id="cb2400-18"><a href="stat-tsa.html#cb2400-18"></a>         <span class="dt">xlab=</span><span class="st">&quot;frequency&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;spectrum&quot;</span>,</span>
<span id="cb2400-19"><a href="stat-tsa.html#cb2400-19"></a>         <span class="dt">axes=</span><span class="ot">FALSE</span>)</span>
<span id="cb2400-20"><a href="stat-tsa.html#cb2400-20"></a>    <span class="kw">axis</span>(<span class="dv">2</span>)</span>
<span id="cb2400-21"><a href="stat-tsa.html#cb2400-21"></a>    <span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at=</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">6</span>)<span class="op">/</span><span class="dv">6</span><span class="op">*</span>pi,</span>
<span id="cb2400-22"><a href="stat-tsa.html#cb2400-22"></a>         <span class="dt">labels=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">expression</span>(pi<span class="op">/</span><span class="dv">6</span>),</span>
<span id="cb2400-23"><a href="stat-tsa.html#cb2400-23"></a>           <span class="kw">expression</span>(pi<span class="op">/</span><span class="dv">3</span>), <span class="kw">expression</span>(pi<span class="op">/</span><span class="dv">2</span>),</span>
<span id="cb2400-24"><a href="stat-tsa.html#cb2400-24"></a>           <span class="kw">expression</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span>), <span class="kw">expression</span>(<span class="dv">5</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">6</span>), <span class="kw">expression</span>(pi)))</span>
<span id="cb2400-25"><a href="stat-tsa.html#cb2400-25"></a>  }</span>
<span id="cb2400-26"><a href="stat-tsa.html#cb2400-26"></a>  <span class="kw">box</span>()</span>
<span id="cb2400-27"><a href="stat-tsa.html#cb2400-27"></a>  <span class="kw">invisible</span>(<span class="kw">list</span>(<span class="dt">frequencies=</span>freqs, <span class="dt">spectrum=</span>spec,</span>
<span id="cb2400-28"><a href="stat-tsa.html#cb2400-28"></a>       <span class="dt">ar.coefficients=</span>a, <span class="dt">ma.coefficients=</span>b,</span>
<span id="cb2400-29"><a href="stat-tsa.html#cb2400-29"></a>       <span class="dt">sigma=</span>sigma))</span>
<span id="cb2400-30"><a href="stat-tsa.html#cb2400-30"></a>}</span></code></pre></div>
<p>从ARMA模型参数计算Wold系数，
<code>n</code>是需要计算的个数：</p>
<div class="sourceCode" id="cb2401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2401-1"><a href="stat-tsa.html#cb2401-1"></a>arma.Wold &lt;-<span class="st"> </span><span class="cf">function</span>(n, a, <span class="dt">b=</span><span class="kw">numeric</span>(<span class="dv">0</span>)){</span>
<span id="cb2401-2"><a href="stat-tsa.html#cb2401-2"></a>  p &lt;-<span class="st"> </span><span class="kw">length</span>(a)</span>
<span id="cb2401-3"><a href="stat-tsa.html#cb2401-3"></a>  q &lt;-<span class="st"> </span><span class="kw">length</span>(b)</span>
<span id="cb2401-4"><a href="stat-tsa.html#cb2401-4"></a>  arev &lt;-<span class="st"> </span><span class="kw">rev</span>(a)</span>
<span id="cb2401-5"><a href="stat-tsa.html#cb2401-5"></a>  psi &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb2401-6"><a href="stat-tsa.html#cb2401-6"></a>  psi[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb2401-7"><a href="stat-tsa.html#cb2401-7"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="kw">seq</span>(n<span class="dv">-1</span>)){</span>
<span id="cb2401-8"><a href="stat-tsa.html#cb2401-8"></a>    <span class="cf">if</span>(j <span class="op">&lt;=</span><span class="st"> </span>q) bj=b[j]</span>
<span id="cb2401-9"><a href="stat-tsa.html#cb2401-9"></a>    <span class="cf">else</span> bj=<span class="dv">0</span></span>
<span id="cb2401-10"><a href="stat-tsa.html#cb2401-10"></a>    psis &lt;-<span class="st"> </span>psi[<span class="kw">max</span>(<span class="dv">1</span>, j<span class="op">+</span><span class="dv">1</span><span class="op">-</span>p)<span class="op">:</span>j]</span>
<span id="cb2401-11"><a href="stat-tsa.html#cb2401-11"></a>    np &lt;-<span class="st"> </span><span class="kw">length</span>(psis)</span>
<span id="cb2401-12"><a href="stat-tsa.html#cb2401-12"></a>    <span class="cf">if</span>(np <span class="op">&lt;</span><span class="st"> </span>p) psis &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>,p<span class="op">-</span>np), psis)</span>
<span id="cb2401-13"><a href="stat-tsa.html#cb2401-13"></a>    psi[j<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span>bj <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(arev <span class="op">*</span><span class="st"> </span>psis)</span>
<span id="cb2401-14"><a href="stat-tsa.html#cb2401-14"></a>  }</span>
<span id="cb2401-15"><a href="stat-tsa.html#cb2401-15"></a>  </span>
<span id="cb2401-16"><a href="stat-tsa.html#cb2401-16"></a>  psi</span>
<span id="cb2401-17"><a href="stat-tsa.html#cb2401-17"></a>}</span></code></pre></div>
<p>给定ARMA模型参数，
利用Wold系数计算自协方差函数。
这里对Wold系数进行了截断，
<code>nw</code>值越大，
使用的Wold系数越多，
结果越精确，
但计算量也越大。
事实上，
对<span class="math inline">\(k \geq q+1\)</span>，
可以用Yule-Walker方程递推计算<span class="math inline">\(\gamma_k\)</span>。</p>
<div class="sourceCode" id="cb2402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2402-1"><a href="stat-tsa.html#cb2402-1"></a>arma.gamma.by.Wold &lt;-<span class="st"> </span><span class="cf">function</span>(n, a, <span class="dt">b=</span><span class="kw">numeric</span>(<span class="dv">0</span>), <span class="dt">sigma=</span><span class="dv">1</span>, <span class="dt">nw=</span><span class="dv">100</span>){</span>
<span id="cb2402-2"><a href="stat-tsa.html#cb2402-2"></a>  nn &lt;-<span class="st"> </span>n <span class="op">+</span><span class="st"> </span>nw</span>
<span id="cb2402-3"><a href="stat-tsa.html#cb2402-3"></a>  psi &lt;-<span class="st"> </span><span class="kw">arma.Wold</span>(nn, a, b, <span class="dt">nw=</span>nw)</span>
<span id="cb2402-4"><a href="stat-tsa.html#cb2402-4"></a>  gam &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb2402-5"><a href="stat-tsa.html#cb2402-5"></a>  <span class="cf">for</span>(ii <span class="cf">in</span> <span class="kw">seq</span>(<span class="dv">0</span>, n<span class="dv">-1</span>)){</span>
<span id="cb2402-6"><a href="stat-tsa.html#cb2402-6"></a>    gam[ii<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">sum</span>(psi[<span class="dv">1</span><span class="op">:</span>(nn<span class="op">-</span>ii)] <span class="op">*</span><span class="st"> </span>psi[(ii<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>nn])</span>
<span id="cb2402-7"><a href="stat-tsa.html#cb2402-7"></a>  }</span>
<span id="cb2402-8"><a href="stat-tsa.html#cb2402-8"></a>  gam &lt;-<span class="st"> </span>(sigma<span class="op">^</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>gam</span>
<span id="cb2402-9"><a href="stat-tsa.html#cb2402-9"></a>  gam</span>
<span id="cb2402-10"><a href="stat-tsa.html#cb2402-10"></a>}</span></code></pre></div>
<p>用矩估计法求ARMA参数估计，
MA部分用李雷的矩阵极限算法。</p>
<div class="sourceCode" id="cb2403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2403-1"><a href="stat-tsa.html#cb2403-1"></a>arma.solve &lt;-<span class="st"> </span><span class="cf">function</span>(gms, p, q){</span>
<span id="cb2403-2"><a href="stat-tsa.html#cb2403-2"></a>  Gpq &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>p, <span class="dt">ncol=</span>p)</span>
<span id="cb2403-3"><a href="stat-tsa.html#cb2403-3"></a>  <span class="cf">for</span>(ii <span class="cf">in</span> <span class="kw">seq</span>(p)) <span class="cf">for</span>(jj <span class="cf">in</span> <span class="kw">seq</span>(p)){</span>
<span id="cb2403-4"><a href="stat-tsa.html#cb2403-4"></a>    Gpq[ii,jj] &lt;-<span class="st"> </span>gms[<span class="kw">abs</span>(q <span class="op">+</span><span class="st"> </span>ii <span class="op">-</span><span class="st"> </span>jj)<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb2403-5"><a href="stat-tsa.html#cb2403-5"></a>  }</span>
<span id="cb2403-6"><a href="stat-tsa.html#cb2403-6"></a>  gs &lt;-<span class="st"> </span>gms[(q<span class="op">+</span><span class="dv">1</span><span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>(q<span class="op">+</span>p<span class="op">+</span><span class="dv">1</span>)]</span>
<span id="cb2403-7"><a href="stat-tsa.html#cb2403-7"></a>  a &lt;-<span class="st"> </span><span class="kw">solve</span>(Gpq, gs)</span>
<span id="cb2403-8"><a href="stat-tsa.html#cb2403-8"></a>  aa &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, a)</span>
<span id="cb2403-9"><a href="stat-tsa.html#cb2403-9"></a></span>
<span id="cb2403-10"><a href="stat-tsa.html#cb2403-10"></a>  gys &lt;-<span class="st"> </span><span class="kw">numeric</span>(q<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb2403-11"><a href="stat-tsa.html#cb2403-11"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="kw">seq</span>(<span class="dv">0</span>, q)){</span>
<span id="cb2403-12"><a href="stat-tsa.html#cb2403-12"></a>    gys[k<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">c</span>(<span class="kw">outer</span>(<span class="dv">0</span><span class="op">:</span>p,<span class="dv">0</span><span class="op">:</span>p,</span>
<span id="cb2403-13"><a href="stat-tsa.html#cb2403-13"></a>                            <span class="cf">function</span>(ii,jj) aa[ii<span class="op">+</span><span class="dv">1</span>] <span class="op">*</span><span class="st"> </span>aa[jj<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb2403-14"><a href="stat-tsa.html#cb2403-14"></a>                            <span class="op">*</span><span class="st"> </span>gms[<span class="kw">abs</span>(k<span class="op">+</span>jj<span class="op">-</span>ii)<span class="op">+</span><span class="dv">1</span>])))</span>
<span id="cb2403-15"><a href="stat-tsa.html#cb2403-15"></a>  }</span>
<span id="cb2403-16"><a href="stat-tsa.html#cb2403-16"></a></span>
<span id="cb2403-17"><a href="stat-tsa.html#cb2403-17"></a>  res &lt;-<span class="st"> </span><span class="kw">ma.solve</span>(gys)</span>
<span id="cb2403-18"><a href="stat-tsa.html#cb2403-18"></a>  b &lt;-<span class="st"> </span>res<span class="op">$</span>b</span>
<span id="cb2403-19"><a href="stat-tsa.html#cb2403-19"></a>  sigma &lt;-<span class="st"> </span><span class="kw">sqrt</span>(res<span class="op">$</span>s2)</span>
<span id="cb2403-20"><a href="stat-tsa.html#cb2403-20"></a></span>
<span id="cb2403-21"><a href="stat-tsa.html#cb2403-21"></a>  <span class="kw">list</span>(<span class="dt">a=</span>a, <span class="dt">b=</span>b, <span class="dt">sigma=</span>sigma)</span>
<span id="cb2403-22"><a href="stat-tsa.html#cb2403-22"></a>}</span></code></pre></div>
<p>ARMA模型矩估计法，其中MA部分用逆相关函数法的R程序：</p>
<div class="sourceCode" id="cb2404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2404-1"><a href="stat-tsa.html#cb2404-1"></a><span class="co">## 用输入的$\gamma_0, \dots, \gamma_p$求解AR(p)模型参数</span></span>
<span id="cb2404-2"><a href="stat-tsa.html#cb2404-2"></a>ar.yw &lt;-<span class="st"> </span><span class="cf">function</span>(gam){</span>
<span id="cb2404-3"><a href="stat-tsa.html#cb2404-3"></a>  p &lt;-<span class="st"> </span><span class="kw">length</span>(gam) <span class="op">-</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb2404-4"><a href="stat-tsa.html#cb2404-4"></a>  G &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, p, p)</span>
<span id="cb2404-5"><a href="stat-tsa.html#cb2404-5"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>p){</span>
<span id="cb2404-6"><a href="stat-tsa.html#cb2404-6"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>p){</span>
<span id="cb2404-7"><a href="stat-tsa.html#cb2404-7"></a>      G[i,j] =<span class="st"> </span>gam[<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">abs</span>(i<span class="op">-</span>j)]</span>
<span id="cb2404-8"><a href="stat-tsa.html#cb2404-8"></a>    }</span>
<span id="cb2404-9"><a href="stat-tsa.html#cb2404-9"></a>  }</span>
<span id="cb2404-10"><a href="stat-tsa.html#cb2404-10"></a>  gri &lt;-<span class="st"> </span>gam[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb2404-11"><a href="stat-tsa.html#cb2404-11"></a>  a &lt;-<span class="st"> </span><span class="kw">solve</span>(G, gri)</span>
<span id="cb2404-12"><a href="stat-tsa.html#cb2404-12"></a>  sig2 &lt;-<span class="st"> </span><span class="kw">sum</span>(gam <span class="op">*</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="op">-</span>a))</span>
<span id="cb2404-13"><a href="stat-tsa.html#cb2404-13"></a>  <span class="kw">list</span>(<span class="dt">ar =</span> a, <span class="dt">var.pred =</span> sig2)</span>
<span id="cb2404-14"><a href="stat-tsa.html#cb2404-14"></a>}</span>
<span id="cb2404-15"><a href="stat-tsa.html#cb2404-15"></a></span>
<span id="cb2404-16"><a href="stat-tsa.html#cb2404-16"></a><span class="co">## 从AR模型参数计算逆相关函数</span></span>
<span id="cb2404-17"><a href="stat-tsa.html#cb2404-17"></a>ar_racv &lt;-<span class="st"> </span><span class="cf">function</span>(a, sig2){</span>
<span id="cb2404-18"><a href="stat-tsa.html#cb2404-18"></a>  p &lt;-<span class="st"> </span><span class="kw">length</span>(a)</span>
<span id="cb2404-19"><a href="stat-tsa.html#cb2404-19"></a>  a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, a)</span>
<span id="cb2404-20"><a href="stat-tsa.html#cb2404-20"></a>  a2 &lt;-<span class="st"> </span><span class="kw">c</span>(a, <span class="kw">numeric</span>(p<span class="op">+</span><span class="dv">1</span>))</span>
<span id="cb2404-21"><a href="stat-tsa.html#cb2404-21"></a>  res &lt;-<span class="st"> </span><span class="kw">numeric</span>(p<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb2404-22"><a href="stat-tsa.html#cb2404-22"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="kw">seq</span>(<span class="dv">0</span>, p, <span class="dt">by=</span><span class="dv">1</span>)){</span>
<span id="cb2404-23"><a href="stat-tsa.html#cb2404-23"></a>    res[k<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">sum</span>(a <span class="op">*</span><span class="st"> </span>a2[(k<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>(k<span class="op">+</span>p<span class="op">+</span><span class="dv">1</span>)])</span>
<span id="cb2404-24"><a href="stat-tsa.html#cb2404-24"></a>  }</span>
<span id="cb2404-25"><a href="stat-tsa.html#cb2404-25"></a>  res<span class="op">/</span>sig2</span>
<span id="cb2404-26"><a href="stat-tsa.html#cb2404-26"></a>}</span>
<span id="cb2404-27"><a href="stat-tsa.html#cb2404-27"></a></span>
<span id="cb2404-28"><a href="stat-tsa.html#cb2404-28"></a></span>
<span id="cb2404-29"><a href="stat-tsa.html#cb2404-29"></a><span class="co">## 用长阶自回归方法和逆相关函数方法估计MA模型</span></span>
<span id="cb2404-30"><a href="stat-tsa.html#cb2404-30"></a>ma.solve.racv &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">q=</span><span class="dv">1</span>){</span>
<span id="cb2404-31"><a href="stat-tsa.html#cb2404-31"></a></span>
<span id="cb2404-32"><a href="stat-tsa.html#cb2404-32"></a>  <span class="co">## 拟合长阶自回归，用来估计逆自协方差函数</span></span>
<span id="cb2404-33"><a href="stat-tsa.html#cb2404-33"></a>  n &lt;-<span class="st"> </span><span class="kw">length</span>(x)</span>
<span id="cb2404-34"><a href="stat-tsa.html#cb2404-34"></a>  plar &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">sqrt</span>(n))</span>
<span id="cb2404-35"><a href="stat-tsa.html#cb2404-35"></a>  <span class="cf">if</span>(plar <span class="op">&lt;</span><span class="st"> </span>q) plar &lt;-<span class="st"> </span>q</span>
<span id="cb2404-36"><a href="stat-tsa.html#cb2404-36"></a>  </span>
<span id="cb2404-37"><a href="stat-tsa.html#cb2404-37"></a>  mod1 &lt;-<span class="st"> </span><span class="kw">ar</span>(x, <span class="dt">aic =</span> <span class="ot">FALSE</span>, <span class="dt">order.max =</span> plar, <span class="dt">method=</span><span class="st">&quot;yule-walker&quot;</span>)</span>
<span id="cb2404-38"><a href="stat-tsa.html#cb2404-38"></a>  a &lt;-<span class="st"> </span>mod1<span class="op">$</span>ar</span>
<span id="cb2404-39"><a href="stat-tsa.html#cb2404-39"></a>  sigsq &lt;-<span class="st"> </span>mod1<span class="op">$</span>var.pred</span>
<span id="cb2404-40"><a href="stat-tsa.html#cb2404-40"></a>  gamr &lt;-<span class="st"> </span><span class="kw">ar_racv</span>(a, sigsq)[<span class="dv">1</span><span class="op">:</span>(q<span class="op">+</span><span class="dv">1</span>)]</span>
<span id="cb2404-41"><a href="stat-tsa.html#cb2404-41"></a>  res2 &lt;-<span class="st"> </span><span class="kw">ar.yw</span>(gamr)</span>
<span id="cb2404-42"><a href="stat-tsa.html#cb2404-42"></a>  b &lt;-<span class="st"> </span><span class="op">-</span>res2<span class="op">$</span>ar</span>
<span id="cb2404-43"><a href="stat-tsa.html#cb2404-43"></a>  sig2 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>res2<span class="op">$</span>var.pred</span>
<span id="cb2404-44"><a href="stat-tsa.html#cb2404-44"></a>  </span>
<span id="cb2404-45"><a href="stat-tsa.html#cb2404-45"></a>  <span class="kw">list</span>(<span class="dt">ma =</span> b, <span class="dt">var.pred =</span> sig2)</span>
<span id="cb2404-46"><a href="stat-tsa.html#cb2404-46"></a>}</span>
<span id="cb2404-47"><a href="stat-tsa.html#cb2404-47"></a></span>
<span id="cb2404-48"><a href="stat-tsa.html#cb2404-48"></a></span>
<span id="cb2404-49"><a href="stat-tsa.html#cb2404-49"></a><span class="co">## 用矩估计法估计ARMA，其中MA部分用逆相关函数法</span></span>
<span id="cb2404-50"><a href="stat-tsa.html#cb2404-50"></a><span class="co">## gms输入$\gamma_k$, $k=0,1,\dots,p+q$。</span></span>
<span id="cb2404-51"><a href="stat-tsa.html#cb2404-51"></a>arma.moment.racv &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">p=</span><span class="dv">1</span>, <span class="dt">q=</span><span class="dv">1</span>){</span>
<span id="cb2404-52"><a href="stat-tsa.html#cb2404-52"></a>  n &lt;-<span class="st"> </span><span class="kw">length</span>(x)</span>
<span id="cb2404-53"><a href="stat-tsa.html#cb2404-53"></a>  pmax &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">sqrt</span>(n))</span>
<span id="cb2404-54"><a href="stat-tsa.html#cb2404-54"></a>  <span class="cf">if</span>(pmax <span class="op">&lt;</span><span class="st"> </span>p<span class="op">+</span>q) pmax &lt;-<span class="st"> </span>p<span class="op">+</span>q</span>
<span id="cb2404-55"><a href="stat-tsa.html#cb2404-55"></a>  <span class="co">## 计算样本自协方差函数</span></span>
<span id="cb2404-56"><a href="stat-tsa.html#cb2404-56"></a>  gms &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">acf</span>(x, <span class="dt">lag.max=</span>pmax<span class="op">+</span>p, <span class="dt">type=</span><span class="st">&quot;covariance&quot;</span>, <span class="dt">plot=</span><span class="ot">FALSE</span>)<span class="op">$</span>acf)</span>
<span id="cb2404-57"><a href="stat-tsa.html#cb2404-57"></a></span>
<span id="cb2404-58"><a href="stat-tsa.html#cb2404-58"></a>  <span class="co">## 求解AR部分</span></span>
<span id="cb2404-59"><a href="stat-tsa.html#cb2404-59"></a>  Gpq &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>p, <span class="dt">ncol=</span>p)</span>
<span id="cb2404-60"><a href="stat-tsa.html#cb2404-60"></a>  <span class="cf">for</span>(ii <span class="cf">in</span> <span class="kw">seq</span>(p)) <span class="cf">for</span>(jj <span class="cf">in</span> <span class="kw">seq</span>(p)){</span>
<span id="cb2404-61"><a href="stat-tsa.html#cb2404-61"></a>    Gpq[ii,jj] &lt;-<span class="st"> </span>gms[<span class="kw">abs</span>(q <span class="op">+</span><span class="st"> </span>ii <span class="op">-</span><span class="st"> </span>jj)<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb2404-62"><a href="stat-tsa.html#cb2404-62"></a>  }</span>
<span id="cb2404-63"><a href="stat-tsa.html#cb2404-63"></a>  gs &lt;-<span class="st"> </span>gms[(q<span class="op">+</span><span class="dv">1</span><span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>(q<span class="op">+</span>p<span class="op">+</span><span class="dv">1</span>)]</span>
<span id="cb2404-64"><a href="stat-tsa.html#cb2404-64"></a>  a &lt;-<span class="st"> </span><span class="kw">solve</span>(Gpq, gs)</span>
<span id="cb2404-65"><a href="stat-tsa.html#cb2404-65"></a>  aa &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, a)</span>
<span id="cb2404-66"><a href="stat-tsa.html#cb2404-66"></a></span>
<span id="cb2404-67"><a href="stat-tsa.html#cb2404-67"></a>  <span class="co">## 从已有的自协方差估计与AR参数估计，计算MA部分的$\gamma_j, j=0,1,\dots,pmax$。</span></span>
<span id="cb2404-68"><a href="stat-tsa.html#cb2404-68"></a>  gys &lt;-<span class="st"> </span><span class="kw">numeric</span>(pmax<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb2404-69"><a href="stat-tsa.html#cb2404-69"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="kw">seq</span>(<span class="dv">0</span>, pmax)){</span>
<span id="cb2404-70"><a href="stat-tsa.html#cb2404-70"></a>    gys[k<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">c</span>(<span class="kw">outer</span>(<span class="dv">0</span><span class="op">:</span>p,<span class="dv">0</span><span class="op">:</span>p,</span>
<span id="cb2404-71"><a href="stat-tsa.html#cb2404-71"></a>                            <span class="cf">function</span>(ii,jj) aa[ii<span class="op">+</span><span class="dv">1</span>] <span class="op">*</span><span class="st"> </span>aa[jj<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb2404-72"><a href="stat-tsa.html#cb2404-72"></a>                            <span class="op">*</span><span class="st"> </span>gms[<span class="kw">abs</span>(k<span class="op">+</span>jj<span class="op">-</span>ii)<span class="op">+</span><span class="dv">1</span>])))</span>
<span id="cb2404-73"><a href="stat-tsa.html#cb2404-73"></a>  }</span>
<span id="cb2404-74"><a href="stat-tsa.html#cb2404-74"></a></span>
<span id="cb2404-75"><a href="stat-tsa.html#cb2404-75"></a>  <span class="co">## 从MA部分的自协方差估计，拟合长阶自回归模型</span></span>
<span id="cb2404-76"><a href="stat-tsa.html#cb2404-76"></a>  res1 &lt;-<span class="st"> </span><span class="kw">ar.yw</span>(gys)</span>
<span id="cb2404-77"><a href="stat-tsa.html#cb2404-77"></a></span>
<span id="cb2404-78"><a href="stat-tsa.html#cb2404-78"></a>  <span class="co">## 求MA部分的逆相关函数</span></span>
<span id="cb2404-79"><a href="stat-tsa.html#cb2404-79"></a>  gamr &lt;-<span class="st"> </span><span class="kw">ar_racv</span>(res1<span class="op">$</span>ar, res1<span class="op">$</span>var.pred)[<span class="dv">1</span><span class="op">:</span>(q<span class="op">+</span><span class="dv">1</span>)]</span>
<span id="cb2404-80"><a href="stat-tsa.html#cb2404-80"></a>  </span>
<span id="cb2404-81"><a href="stat-tsa.html#cb2404-81"></a>  <span class="co">## 利用逆相关函数为输入求解YW方程，得到MA参数估计</span></span>
<span id="cb2404-82"><a href="stat-tsa.html#cb2404-82"></a>  res2 &lt;-<span class="st"> </span><span class="kw">ar.yw</span>(gamr)</span>
<span id="cb2404-83"><a href="stat-tsa.html#cb2404-83"></a>  b &lt;-<span class="st"> </span><span class="op">-</span>res2<span class="op">$</span>ar</span>
<span id="cb2404-84"><a href="stat-tsa.html#cb2404-84"></a>  sig2 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>res2<span class="op">$</span>var.pred</span>
<span id="cb2404-85"><a href="stat-tsa.html#cb2404-85"></a>  <span class="co">##sig2 &lt;- gys[1] / sum(c(1, b)^2)</span></span>
<span id="cb2404-86"><a href="stat-tsa.html#cb2404-86"></a>  </span>
<span id="cb2404-87"><a href="stat-tsa.html#cb2404-87"></a>  <span class="kw">list</span>(<span class="dt">ar=</span>a, <span class="dt">ma=</span>b, <span class="dt">var.pred=</span>sig2)</span>
<span id="cb2404-88"><a href="stat-tsa.html#cb2404-88"></a>}</span></code></pre></div>
<p>时间序列递推预测系数计算。
输入一个<span class="math inline">\(n\times n\)</span>矩阵表示序列非平稳，
输入为观测向量的协方差阵；
输入一个向量表示序列平稳，
输入为平稳列的自协方差函数值<span class="math inline">\(\gamma_0, \gamma_1, \dots, \gamma_{n-1}\)</span>。
输出是用新息预报方法对<span class="math inline">\(Y_1, Y_2, \dots, Y_n\)</span>进行一步最佳线性预报的系数和均方误差。
结果为列表，
元素<code>theta</code>是<span class="math inline">\((n-1) \times (n-1)\)</span>矩阵，
第<span class="math inline">\(k\)</span>行为预报<span class="math inline">\(Y_{k+1}\)</span>的样本新息系数：
<span class="math display">\[
  \hat Y_{k+1} = \theta[k,1] \cdot W_k + \theta[k,2] \cdot W_{k-1} + \dots + \theta[k,k] \cdot W_1
\]</span>
<span class="math display">\[
  W_1=Y_1, W_k = Y_k - \hat Y_k, k=2,3,\dots,n .
\]</span>
元素<code>nu</code>是<span class="math inline">\(n\)</span>个预报均方误差，
<code>nu[k]</code>是预报<span class="math inline">\(Y_k\)</span>的均方误差。</p>
<div class="sourceCode" id="cb2405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2405-1"><a href="stat-tsa.html#cb2405-1"></a><span class="co">### 非平稳时间序列新息递推预测的系数和一步预测误差方差计算。</span></span>
<span id="cb2405-2"><a href="stat-tsa.html#cb2405-2"></a><span class="co">### 输入：</span></span>
<span id="cb2405-3"><a href="stat-tsa.html#cb2405-3"></a><span class="co">###    Gam --- 如果序列非平稳，为自协方差矩阵n*n</span></span>
<span id="cb2405-4"><a href="stat-tsa.html#cb2405-4"></a><span class="co">###            如果序列平稳，为自协方差列\gamma_0, \gamma_1, \dots, \gamma_{n-1}</span></span>
<span id="cb2405-5"><a href="stat-tsa.html#cb2405-5"></a><span class="co">### 输出：</span></span>
<span id="cb2405-6"><a href="stat-tsa.html#cb2405-6"></a><span class="co">###   用新息预报方法对Y_1, Y_2, \dots, Y_n进行一步最佳线性预报的系数和均方误差。</span></span>
<span id="cb2405-7"><a href="stat-tsa.html#cb2405-7"></a><span class="co">###   theta -- (n-1)*(n-1)矩阵。第k行为预报Y_{k+1}的样本新息系数：</span></span>
<span id="cb2405-8"><a href="stat-tsa.html#cb2405-8"></a><span class="co">###      \hat Y_{k+1} = theta[k,1]*W_k + theta[k,2]*W_{k-1} + \dots + theta[k,k]*W_1</span></span>
<span id="cb2405-9"><a href="stat-tsa.html#cb2405-9"></a><span class="co">###      W_1=Y_1, W_k = Y_k - \hat Y_k, k=2,3,\dots,n</span></span>
<span id="cb2405-10"><a href="stat-tsa.html#cb2405-10"></a><span class="co">###   nu --- n个元素，nu[k]为预报Y_k的均方误差。</span></span>
<span id="cb2405-11"><a href="stat-tsa.html#cb2405-11"></a>ts.ipred.coef &lt;-<span class="st"> </span><span class="cf">function</span>(Gam){</span>
<span id="cb2405-12"><a href="stat-tsa.html#cb2405-12"></a>  <span class="cf">if</span>(<span class="op">!</span><span class="kw">is.matrix</span>(Gam)){</span>
<span id="cb2405-13"><a href="stat-tsa.html#cb2405-13"></a>    n &lt;-<span class="st"> </span><span class="kw">length</span>(Gam)</span>
<span id="cb2405-14"><a href="stat-tsa.html#cb2405-14"></a>    Gam &lt;-<span class="st"> </span><span class="kw">outer</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="dv">1</span><span class="op">:</span>n,</span>
<span id="cb2405-15"><a href="stat-tsa.html#cb2405-15"></a>                 <span class="cf">function</span>(i,j) Gam[<span class="kw">abs</span>(i<span class="op">-</span>j)<span class="op">+</span><span class="dv">1</span>])</span>
<span id="cb2405-16"><a href="stat-tsa.html#cb2405-16"></a>  } <span class="cf">else</span> {</span>
<span id="cb2405-17"><a href="stat-tsa.html#cb2405-17"></a>    n &lt;-<span class="st"> </span><span class="kw">nrow</span>(Gam)</span>
<span id="cb2405-18"><a href="stat-tsa.html#cb2405-18"></a>  }</span>
<span id="cb2405-19"><a href="stat-tsa.html#cb2405-19"></a>  <span class="co">## X_1, X_2, \dots, X_{n-1}的自协方差矩阵为Gam</span></span>
<span id="cb2405-20"><a href="stat-tsa.html#cb2405-20"></a></span>
<span id="cb2405-21"><a href="stat-tsa.html#cb2405-21"></a>  <span class="co">## 新息预报递推</span></span>
<span id="cb2405-22"><a href="stat-tsa.html#cb2405-22"></a>  theta &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, n<span class="dv">-1</span>, n<span class="dv">-1</span>)</span>
<span id="cb2405-23"><a href="stat-tsa.html#cb2405-23"></a>  nu &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb2405-24"><a href="stat-tsa.html#cb2405-24"></a>  nu[<span class="dv">1</span>] &lt;-<span class="st"> </span>Gam[<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb2405-25"><a href="stat-tsa.html#cb2405-25"></a>  theta[<span class="dv">1</span>,<span class="dv">1</span>] &lt;-<span class="st"> </span>Gam[<span class="dv">2</span>,<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>Gam[<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb2405-26"><a href="stat-tsa.html#cb2405-26"></a>  nu[<span class="dv">2</span>] &lt;-<span class="st"> </span>Gam[<span class="dv">2</span>,<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span>theta[<span class="dv">1</span>,<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>nu[<span class="dv">1</span>]</span>
<span id="cb2405-27"><a href="stat-tsa.html#cb2405-27"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>(n<span class="dv">-1</span>)){</span>
<span id="cb2405-28"><a href="stat-tsa.html#cb2405-28"></a>    theta[k, k] &lt;-<span class="st"> </span>Gam[k<span class="op">+</span><span class="dv">1</span>,<span class="dv">0</span><span class="op">+</span><span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>nu[<span class="dv">1</span>]</span>
<span id="cb2405-29"><a href="stat-tsa.html#cb2405-29"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(k<span class="dv">-1</span>)){</span>
<span id="cb2405-30"><a href="stat-tsa.html#cb2405-30"></a>      theta[k,k<span class="op">-</span>j] &lt;-<span class="st"> </span>(Gam[k<span class="op">+</span><span class="dv">1</span>,j<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb2405-31"><a href="stat-tsa.html#cb2405-31"></a>                       <span class="op">-</span><span class="st"> </span><span class="kw">sum</span>(theta[j, j<span class="op">:</span><span class="dv">1</span>]<span class="op">*</span>theta[k,k<span class="op">:</span>(k<span class="op">-</span>j<span class="op">+</span><span class="dv">1</span>)]<span class="op">*</span>nu[<span class="dv">1</span><span class="op">:</span>j])) <span class="op">/</span></span>
<span id="cb2405-32"><a href="stat-tsa.html#cb2405-32"></a><span class="st">                         </span>nu[j<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb2405-33"><a href="stat-tsa.html#cb2405-33"></a>    }</span>
<span id="cb2405-34"><a href="stat-tsa.html#cb2405-34"></a>    nu[k<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span>Gam[k<span class="op">+</span><span class="dv">1</span>,k<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span><span class="st"> </span><span class="kw">sum</span>(theta[k,k<span class="op">:</span><span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>nu[<span class="dv">1</span><span class="op">:</span>k])</span>
<span id="cb2405-35"><a href="stat-tsa.html#cb2405-35"></a>  }</span>
<span id="cb2405-36"><a href="stat-tsa.html#cb2405-36"></a>  <span class="kw">list</span>(<span class="dt">theta=</span>theta, <span class="dt">nu=</span>nu)</span>
<span id="cb2405-37"><a href="stat-tsa.html#cb2405-37"></a>}</span></code></pre></div>
<p>随时间序列进行递推预报(新息预报)，
假定已知自协方差列（平稳时）或自协方差阵（非平稳时）。
输入<code>x</code>是时间序列观测数据，
可以包含要预报的部分作为对比。
输入<code>gams</code>向量或矩阵。向量时为平稳序列的自协方差列，
矩阵时为非平稳时间序列的自协方差阵。
输入<code>demean</code>表示是否减去均值再预报。
输入<code>end</code>表示预报到哪个时间点，
这受到gams大小的限制，只能预报到与自协方差阵阶数相同的时间点。
<code>conf</code>是计算预测区间的置信度。</p>
<div class="sourceCode" id="cb2406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2406-1"><a href="stat-tsa.html#cb2406-1"></a>ts.ipred &lt;-<span class="st"> </span><span class="cf">function</span>(x, gams, <span class="dt">demean=</span><span class="ot">FALSE</span>, <span class="dt">end=</span><span class="kw">length</span>(x), <span class="dt">conf=</span><span class="fl">0.95</span>){</span>
<span id="cb2406-2"><a href="stat-tsa.html#cb2406-2"></a>  stationary &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">is.matrix</span>(gams)</span>
<span id="cb2406-3"><a href="stat-tsa.html#cb2406-3"></a>  res1 &lt;-<span class="st"> </span><span class="kw">ts.ipred.coef</span>(gams)</span>
<span id="cb2406-4"><a href="stat-tsa.html#cb2406-4"></a>  theta &lt;-<span class="st"> </span>res1<span class="op">$</span>theta</span>
<span id="cb2406-5"><a href="stat-tsa.html#cb2406-5"></a>  nu &lt;-<span class="st"> </span>res1<span class="op">$</span>nu</span>
<span id="cb2406-6"><a href="stat-tsa.html#cb2406-6"></a></span>
<span id="cb2406-7"><a href="stat-tsa.html#cb2406-7"></a>  <span class="cf">if</span>(demean) {xmean &lt;-<span class="st"> </span><span class="kw">mean</span>(x); x &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span>xmean}</span>
<span id="cb2406-8"><a href="stat-tsa.html#cb2406-8"></a></span>
<span id="cb2406-9"><a href="stat-tsa.html#cb2406-9"></a>  <span class="cf">if</span>(<span class="op">!</span>stationary) end &lt;-<span class="st"> </span><span class="kw">length</span>(nu)</span>
<span id="cb2406-10"><a href="stat-tsa.html#cb2406-10"></a>  W &lt;-<span class="st"> </span><span class="kw">numeric</span>(end)</span>
<span id="cb2406-11"><a href="stat-tsa.html#cb2406-11"></a>  pred &lt;-<span class="st"> </span><span class="kw">numeric</span>(end)</span>
<span id="cb2406-12"><a href="stat-tsa.html#cb2406-12"></a>  lb &lt;-<span class="st"> </span><span class="kw">numeric</span>(end)</span>
<span id="cb2406-13"><a href="stat-tsa.html#cb2406-13"></a>  ub &lt;-<span class="st"> </span><span class="kw">numeric</span>(end)</span>
<span id="cb2406-14"><a href="stat-tsa.html#cb2406-14"></a>  lam &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>conf)<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb2406-15"><a href="stat-tsa.html#cb2406-15"></a></span>
<span id="cb2406-16"><a href="stat-tsa.html#cb2406-16"></a>  pred[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb2406-17"><a href="stat-tsa.html#cb2406-17"></a>  W[<span class="dv">1</span>] &lt;-<span class="st"> </span>x[<span class="dv">1</span>]</span>
<span id="cb2406-18"><a href="stat-tsa.html#cb2406-18"></a>  <span class="cf">for</span>(n <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(end<span class="dv">-1</span>)){</span>
<span id="cb2406-19"><a href="stat-tsa.html#cb2406-19"></a>    pred[n<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">sum</span>(theta[n, n<span class="op">:</span><span class="dv">1</span>]<span class="op">*</span>W[<span class="dv">1</span><span class="op">:</span>n])</span>
<span id="cb2406-20"><a href="stat-tsa.html#cb2406-20"></a>    W[n<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span>x[n<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>pred[n<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb2406-21"><a href="stat-tsa.html#cb2406-21"></a>  }</span>
<span id="cb2406-22"><a href="stat-tsa.html#cb2406-22"></a>  lb &lt;-<span class="st"> </span>pred <span class="op">-</span><span class="st"> </span>lam<span class="op">*</span><span class="kw">sqrt</span>(nu[<span class="dv">1</span><span class="op">:</span>end])</span>
<span id="cb2406-23"><a href="stat-tsa.html#cb2406-23"></a>  ub &lt;-<span class="st"> </span>pred <span class="op">+</span><span class="st"> </span>lam<span class="op">*</span><span class="kw">sqrt</span>(nu[<span class="dv">1</span><span class="op">:</span>end])</span>
<span id="cb2406-24"><a href="stat-tsa.html#cb2406-24"></a></span>
<span id="cb2406-25"><a href="stat-tsa.html#cb2406-25"></a>  <span class="cf">if</span>(demean){</span>
<span id="cb2406-26"><a href="stat-tsa.html#cb2406-26"></a>    pred &lt;-<span class="st"> </span>xmean <span class="op">+</span><span class="st"> </span>pred</span>
<span id="cb2406-27"><a href="stat-tsa.html#cb2406-27"></a>    lb &lt;-<span class="st"> </span>xmean <span class="op">+</span><span class="st"> </span>lb</span>
<span id="cb2406-28"><a href="stat-tsa.html#cb2406-28"></a>    ub &lt;-<span class="st"> </span>xmean <span class="op">+</span><span class="st"> </span>ub</span>
<span id="cb2406-29"><a href="stat-tsa.html#cb2406-29"></a>  }</span>
<span id="cb2406-30"><a href="stat-tsa.html#cb2406-30"></a>  <span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">pred=</span>pred, <span class="dt">lb=</span>lb, <span class="dt">ub=</span>ub, <span class="dt">conf=</span>conf)</span>
<span id="cb2406-31"><a href="stat-tsa.html#cb2406-31"></a>}</span></code></pre></div>
<p>对平稳列，
已知自协方差列时用Levinson递推计算逐个一步预报系数(Y-W系数)和一步预测误差方差。
输入<code>gams[1:n]</code> 为<span class="math inline">\(\gamma_k, k=0,1,\dots,n-1\)</span>。
输出是对<span class="math inline">\(Y_1, Y_2, \dots, Y_{n}\)</span>做滚动向前一步预报所需的系数和均方误差。
结果中元素<code>coef.YW</code>是<span class="math inline">\((n-1)\times (n-1)\)</span>矩阵，
第<span class="math inline">\(k\)</span>行的<span class="math inline">\(1:k\)</span>元素为
<span class="math inline">\(a_{k,1}, a_{k,2}, \dots, a_{k,k}\)</span>，
用来预报<span class="math inline">\(Y_{k+1}\)</span>:
<span class="math display">\[
L(Y_{k+1} | Y_1, Y_2, \dots, Y_k)
= a_{k,1} Y_{k} + a_{k,2} Y_{k-1} + \dots + a_{k,k} Y_1,
\ k=1,2,\dots,n-1
\]</span>
<span class="math display">\[
L(Y_1| ) = 0
\]</span>
结果中<code>sigmasq</code>是长度为<span class="math inline">\(n\)</span>的向量，
保存预报<span class="math inline">\(Y_1, Y_2, \dots, Y_n\)</span>的一步预报均方误差。</p>
<div class="sourceCode" id="cb2407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2407-1"><a href="stat-tsa.html#cb2407-1"></a>Levinson.coef &lt;-<span class="st"> </span><span class="cf">function</span>(gams){</span>
<span id="cb2407-2"><a href="stat-tsa.html#cb2407-2"></a>  n &lt;-<span class="st"> </span><span class="kw">length</span>(gams)</span>
<span id="cb2407-3"><a href="stat-tsa.html#cb2407-3"></a></span>
<span id="cb2407-4"><a href="stat-tsa.html#cb2407-4"></a>  <span class="co">## ayw保存Y-W系数a[i,j], i=1,2,\dots,n-1, j=1,2,\dots,i</span></span>
<span id="cb2407-5"><a href="stat-tsa.html#cb2407-5"></a>  ayw &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, n<span class="dv">-1</span>, n<span class="dv">-1</span>)</span>
<span id="cb2407-6"><a href="stat-tsa.html#cb2407-6"></a>  <span class="co">## ss保存一步预报误差方差</span></span>
<span id="cb2407-7"><a href="stat-tsa.html#cb2407-7"></a>  ss &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb2407-8"><a href="stat-tsa.html#cb2407-8"></a></span>
<span id="cb2407-9"><a href="stat-tsa.html#cb2407-9"></a>  ss[<span class="dv">1</span>] &lt;-<span class="st"> </span>gams[<span class="dv">0</span><span class="op">+</span><span class="dv">1</span>] <span class="co">## 预报Y_1的均方误差, 等于\gamma_0</span></span>
<span id="cb2407-10"><a href="stat-tsa.html#cb2407-10"></a>  ayw[<span class="dv">1</span>,<span class="dv">1</span>] &lt;-<span class="st"> </span>gams[<span class="dv">1</span><span class="op">+</span><span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>gams[<span class="dv">0</span><span class="op">+</span><span class="dv">1</span>] <span class="co">## 用Y_1预报Y_2的系数</span></span>
<span id="cb2407-11"><a href="stat-tsa.html#cb2407-11"></a>  ss[<span class="dv">2</span>] &lt;-<span class="st"> </span>ss[<span class="dv">1</span>] <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>ayw[<span class="dv">1</span>,<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span>) <span class="co">## 用Y_1预报Y_2的均方误差</span></span>
<span id="cb2407-12"><a href="stat-tsa.html#cb2407-12"></a>  <span class="cf">if</span>(n<span class="op">&gt;</span><span class="dv">2</span>) <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(n<span class="dv">-2</span>)){</span>
<span id="cb2407-13"><a href="stat-tsa.html#cb2407-13"></a>    <span class="co">## 用Y_1, \dots, Y_{k+1}预报Y_{k+2}的系数</span></span>
<span id="cb2407-14"><a href="stat-tsa.html#cb2407-14"></a>    ayw[k<span class="op">+</span><span class="dv">1</span>,k<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span>(gams[(k<span class="op">+</span><span class="dv">1</span>)<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span><span class="st"> </span><span class="kw">sum</span>(ayw[k,<span class="dv">1</span><span class="op">:</span>k] <span class="op">*</span><span class="st"> </span>gams[(k<span class="op">:</span><span class="dv">1</span>)<span class="op">+</span><span class="dv">1</span>])) <span class="op">/</span><span class="st"> </span>ss[k<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb2407-15"><a href="stat-tsa.html#cb2407-15"></a>    ayw[k<span class="op">+</span><span class="dv">1</span>,<span class="dv">1</span><span class="op">:</span>k] &lt;-<span class="st"> </span>ayw[k, <span class="dv">1</span><span class="op">:</span>k] <span class="op">-</span><span class="st"> </span>ayw[k<span class="op">+</span><span class="dv">1</span>,k<span class="op">+</span><span class="dv">1</span>]<span class="op">*</span>ayw[k, k<span class="op">:</span><span class="dv">1</span>]</span>
<span id="cb2407-16"><a href="stat-tsa.html#cb2407-16"></a>    <span class="co">## 用Y_1, \dots, Y_{k+1}预报Y_{k+2}的均方误差</span></span>
<span id="cb2407-17"><a href="stat-tsa.html#cb2407-17"></a>    ss[k<span class="op">+</span><span class="dv">2</span>] &lt;-<span class="st"> </span>ss[k<span class="op">+</span><span class="dv">1</span>] <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>ayw[k<span class="op">+</span><span class="dv">1</span>,k<span class="op">+</span><span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb2407-18"><a href="stat-tsa.html#cb2407-18"></a>  }</span>
<span id="cb2407-19"><a href="stat-tsa.html#cb2407-19"></a></span>
<span id="cb2407-20"><a href="stat-tsa.html#cb2407-20"></a>  <span class="kw">list</span>(<span class="dt">coef.YW=</span>ayw, <span class="dt">sigmasq=</span>ss)</span>
<span id="cb2407-21"><a href="stat-tsa.html#cb2407-21"></a>}</span></code></pre></div>
<p>对平稳列用Levinson计算一步预测系数(Yule-Walker系数)进行一步预测的程序。
设已知自协方差列。
输入<code>x</code>是平稳时间序列观测数据<span class="math inline">\(X_1, \dots, X_n\)</span>。
输入<code>gams</code>是理论自协方差列<span class="math inline">\(\gamma_0, \gamma_1, \dots, \gamma_{m-1}\)</span>,
<span class="math inline">\(m \leq n\)</span>。
输入<code>max.lag</code>表示最多使用多少个历史值预报。
缺省使用所有历史值，或理论自协方差列个数减一。
输入<code>end</code>表示计算一步预测到第<code>end</code>时刻为止，
默认对每个时间点计算一步预测。
输入<code>demean</code>选择预报时是否中心化。
输入<code>conf</code>是计算一步预测区间时的置信度。</p>
<p>输出为一个列表，
元素<code>x</code>是输入的原始时间序列，
<code>pred</code>是时间序列每个点的一步预报，
长度与<code>x</code>相同。
<code>lb</code>和<code>ub</code>是每个点的预测下限和上限。</p>
<div class="sourceCode" id="cb2408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2408-1"><a href="stat-tsa.html#cb2408-1"></a>sts.pred.levinson &lt;-<span class="st"> </span><span class="cf">function</span>(x, gams, <span class="dt">max.lag=</span><span class="kw">length</span>(gams)<span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb2408-2"><a href="stat-tsa.html#cb2408-2"></a>                              <span class="dt">end=</span><span class="kw">length</span>(x),</span>
<span id="cb2408-3"><a href="stat-tsa.html#cb2408-3"></a>                              <span class="dt">demean=</span><span class="ot">FALSE</span>, <span class="dt">conf=</span><span class="fl">0.95</span>){</span>
<span id="cb2408-4"><a href="stat-tsa.html#cb2408-4"></a>  n &lt;-<span class="st"> </span><span class="kw">length</span>(x)</span>
<span id="cb2408-5"><a href="stat-tsa.html#cb2408-5"></a>  m &lt;-<span class="st"> </span><span class="kw">length</span>(gams)</span>
<span id="cb2408-6"><a href="stat-tsa.html#cb2408-6"></a>  <span class="cf">if</span>(max.lag <span class="op">&gt;</span><span class="st"> </span>m<span class="dv">-1</span>){</span>
<span id="cb2408-7"><a href="stat-tsa.html#cb2408-7"></a>    msg &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&#39;可用最大历史长度&#39;</span>, max.lag,</span>
<span id="cb2408-8"><a href="stat-tsa.html#cb2408-8"></a>                 <span class="st">&#39;大于可用理论自协方差个数减一&#39;</span>, m<span class="dv">-1</span>)</span>
<span id="cb2408-9"><a href="stat-tsa.html#cb2408-9"></a>    <span class="kw">stop</span>(msg)</span>
<span id="cb2408-10"><a href="stat-tsa.html#cb2408-10"></a>  }</span>
<span id="cb2408-11"><a href="stat-tsa.html#cb2408-11"></a>  <span class="cf">if</span>(demean) {</span>
<span id="cb2408-12"><a href="stat-tsa.html#cb2408-12"></a>    xmean &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb2408-13"><a href="stat-tsa.html#cb2408-13"></a>    x[] &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span>xmean</span>
<span id="cb2408-14"><a href="stat-tsa.html#cb2408-14"></a>  }</span>
<span id="cb2408-15"><a href="stat-tsa.html#cb2408-15"></a>  </span>
<span id="cb2408-16"><a href="stat-tsa.html#cb2408-16"></a>  pred &lt;-<span class="st"> </span><span class="kw">numeric</span>(end)</span>
<span id="cb2408-17"><a href="stat-tsa.html#cb2408-17"></a>  lb &lt;-<span class="st"> </span><span class="kw">numeric</span>(end)</span>
<span id="cb2408-18"><a href="stat-tsa.html#cb2408-18"></a>  ub &lt;-<span class="st"> </span><span class="kw">numeric</span>(end)</span>
<span id="cb2408-19"><a href="stat-tsa.html#cb2408-19"></a>  lam &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>conf)<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb2408-20"><a href="stat-tsa.html#cb2408-20"></a></span>
<span id="cb2408-21"><a href="stat-tsa.html#cb2408-21"></a>  res1 &lt;-<span class="st"> </span><span class="kw">Levinson.coef</span>(gams)</span>
<span id="cb2408-22"><a href="stat-tsa.html#cb2408-22"></a>  ayw &lt;-<span class="st"> </span>res1<span class="op">$</span>coef.YW <span class="co">## (m-1)*(m-1)矩阵，第k行用于k个历史进行一步预报。</span></span>
<span id="cb2408-23"><a href="stat-tsa.html#cb2408-23"></a>  ss &lt;-<span class="st"> </span>res1<span class="op">$</span>sigmasq  <span class="co">## 长度为m的向量，第k个为用k-1个历史预报下一步的均方误差。</span></span>
<span id="cb2408-24"><a href="stat-tsa.html#cb2408-24"></a>  </span>
<span id="cb2408-25"><a href="stat-tsa.html#cb2408-25"></a>  pred[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb2408-26"><a href="stat-tsa.html#cb2408-26"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="kw">seq</span>(end<span class="dv">-1</span>)){</span>
<span id="cb2408-27"><a href="stat-tsa.html#cb2408-27"></a>    <span class="cf">if</span>(k <span class="op">&lt;=</span><span class="st"> </span>max.lag) {</span>
<span id="cb2408-28"><a href="stat-tsa.html#cb2408-28"></a>      pred[k<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">sum</span>(ayw[k, <span class="dv">1</span><span class="op">:</span>k] <span class="op">*</span><span class="st"> </span>x[k<span class="op">:</span><span class="dv">1</span>])</span>
<span id="cb2408-29"><a href="stat-tsa.html#cb2408-29"></a>    } <span class="cf">else</span> {</span>
<span id="cb2408-30"><a href="stat-tsa.html#cb2408-30"></a>      pred[k<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">sum</span>(ayw[max.lag, <span class="dv">1</span><span class="op">:</span>max.lag] <span class="op">*</span><span class="st"> </span>x[k<span class="op">:</span>(k<span class="op">-</span>max.lag<span class="op">+</span><span class="dv">1</span>)])</span>
<span id="cb2408-31"><a href="stat-tsa.html#cb2408-31"></a>    }</span>
<span id="cb2408-32"><a href="stat-tsa.html#cb2408-32"></a>  }</span>
<span id="cb2408-33"><a href="stat-tsa.html#cb2408-33"></a>  <span class="cf">if</span>(demean) pred[] &lt;-<span class="st"> </span>pred <span class="op">+</span><span class="st"> </span>xmean</span>
<span id="cb2408-34"><a href="stat-tsa.html#cb2408-34"></a></span>
<span id="cb2408-35"><a href="stat-tsa.html#cb2408-35"></a>  ss2 &lt;-<span class="st"> </span><span class="kw">c</span>(ss[<span class="dv">1</span><span class="op">:</span><span class="kw">min</span>(end,max.lag<span class="op">+</span><span class="dv">1</span>)],</span>
<span id="cb2408-36"><a href="stat-tsa.html#cb2408-36"></a>           <span class="kw">rep</span>(ss[max.lag<span class="op">+</span><span class="dv">1</span>], end<span class="op">-</span><span class="kw">min</span>(end,max.lag<span class="op">+</span><span class="dv">1</span>)))</span>
<span id="cb2408-37"><a href="stat-tsa.html#cb2408-37"></a></span>
<span id="cb2408-38"><a href="stat-tsa.html#cb2408-38"></a>  lb[] &lt;-<span class="st"> </span>pred <span class="op">-</span><span class="st"> </span>lam<span class="op">*</span><span class="kw">sqrt</span>(ss2)</span>
<span id="cb2408-39"><a href="stat-tsa.html#cb2408-39"></a>  ub[] &lt;-<span class="st"> </span>pred <span class="op">+</span><span class="st"> </span>lam<span class="op">*</span><span class="kw">sqrt</span>(ss2)</span>
<span id="cb2408-40"><a href="stat-tsa.html#cb2408-40"></a></span>
<span id="cb2408-41"><a href="stat-tsa.html#cb2408-41"></a>  <span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">pred=</span>pred, <span class="dt">lb=</span>lb, <span class="dt">ub=</span>ub, <span class="dt">conf=</span>conf)</span>
<span id="cb2408-42"><a href="stat-tsa.html#cb2408-42"></a>}</span></code></pre></div>
<p>周期图计算：</p>
<div class="sourceCode" id="cb2409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2409-1"><a href="stat-tsa.html#cb2409-1"></a>direct.periodogram &lt;-<span class="st"> </span><span class="cf">function</span>(</span>
<span id="cb2409-2"><a href="stat-tsa.html#cb2409-2"></a>  y, <span class="dt">freqs=</span><span class="kw">seq</span>(<span class="dv">0</span>,pi,<span class="dt">length=</span><span class="dv">101</span>), <span class="dt">demean=</span><span class="ot">FALSE</span>){</span>
<span id="cb2409-3"><a href="stat-tsa.html#cb2409-3"></a>  N &lt;-<span class="st"> </span><span class="kw">length</span>(y)</span>
<span id="cb2409-4"><a href="stat-tsa.html#cb2409-4"></a>  <span class="cf">if</span>(demean) y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb2409-5"><a href="stat-tsa.html#cb2409-5"></a>  II &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(freqs))</span>
<span id="cb2409-6"><a href="stat-tsa.html#cb2409-6"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="kw">seq</span>(<span class="dt">along=</span>freqs)){</span>
<span id="cb2409-7"><a href="stat-tsa.html#cb2409-7"></a>    II[j] &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span>N)<span class="op">*</span><span class="kw">Mod</span>(<span class="kw">sum</span>(y <span class="op">*</span><span class="st"> </span><span class="kw">complex</span>(<span class="dt">mod=</span><span class="dv">1</span>, <span class="dt">arg=</span>freqs[j]<span class="op">*</span><span class="kw">seq</span>(<span class="dv">1</span>,N))))<span class="op">^</span><span class="dv">2</span></span>
<span id="cb2409-8"><a href="stat-tsa.html#cb2409-8"></a>  }</span>
<span id="cb2409-9"><a href="stat-tsa.html#cb2409-9"></a></span>
<span id="cb2409-10"><a href="stat-tsa.html#cb2409-10"></a>  <span class="kw">list</span>(<span class="dt">frequencies=</span>freqs, <span class="dt">spectrum=</span>II)</span>
<span id="cb2409-11"><a href="stat-tsa.html#cb2409-11"></a>}</span></code></pre></div>
<p>Daniell加窗谱估计：</p>
<div class="sourceCode" id="cb2410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2410-1"><a href="stat-tsa.html#cb2410-1"></a>spec.Daniell &lt;-<span class="st"> </span><span class="cf">function</span>(</span>
<span id="cb2410-2"><a href="stat-tsa.html#cb2410-2"></a>  y, <span class="dt">freqs=</span><span class="kw">seq</span>(<span class="dv">0</span>,pi,<span class="dt">length=</span><span class="dv">101</span>),</span>
<span id="cb2410-3"><a href="stat-tsa.html#cb2410-3"></a>  <span class="dt">M =</span> <span class="kw">round</span>(<span class="dv">2</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="kw">length</span>(y))),</span>
<span id="cb2410-4"><a href="stat-tsa.html#cb2410-4"></a>  <span class="dt">demean=</span><span class="ot">FALSE</span>){</span>
<span id="cb2410-5"><a href="stat-tsa.html#cb2410-5"></a>  N &lt;-<span class="st"> </span><span class="kw">length</span>(y)</span>
<span id="cb2410-6"><a href="stat-tsa.html#cb2410-6"></a>  <span class="cf">if</span>(demean) y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb2410-7"><a href="stat-tsa.html#cb2410-7"></a>  spec &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(freqs))</span>
<span id="cb2410-8"><a href="stat-tsa.html#cb2410-8"></a>  gams &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">acf</span>(y, <span class="dt">lag.max=</span>N<span class="dv">-1</span>,</span>
<span id="cb2410-9"><a href="stat-tsa.html#cb2410-9"></a>                <span class="dt">type=</span><span class="st">&quot;covariance&quot;</span>, <span class="dt">plot=</span><span class="ot">FALSE</span>)<span class="op">$</span>acf)</span>
<span id="cb2410-10"><a href="stat-tsa.html#cb2410-10"></a>  jjs &lt;-<span class="st"> </span><span class="kw">seq</span>(N<span class="dv">-1</span>)</span>
<span id="cb2410-11"><a href="stat-tsa.html#cb2410-11"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="kw">seq</span>(<span class="dt">along=</span>freqs))</span>
<span id="cb2410-12"><a href="stat-tsa.html#cb2410-12"></a>    spec[j] &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span>(gams[<span class="dv">1</span>] <span class="op">+</span></span>
<span id="cb2410-13"><a href="stat-tsa.html#cb2410-13"></a><span class="st">                         </span><span class="dv">2</span><span class="op">*</span><span class="kw">sum</span>(gams[jjs<span class="op">+</span><span class="dv">1</span>] <span class="op">*</span></span>
<span id="cb2410-14"><a href="stat-tsa.html#cb2410-14"></a><span class="st">                               </span>( <span class="kw">sin</span>(jjs<span class="op">*</span>pi<span class="op">/</span>M) <span class="op">/</span><span class="st"> </span>(jjs<span class="op">*</span>pi<span class="op">/</span>M) ) <span class="op">*</span></span>
<span id="cb2410-15"><a href="stat-tsa.html#cb2410-15"></a><span class="st">                               </span><span class="kw">cos</span>(jjs<span class="op">*</span>freqs[j])))</span>
<span id="cb2410-16"><a href="stat-tsa.html#cb2410-16"></a>  </span>
<span id="cb2410-17"><a href="stat-tsa.html#cb2410-17"></a>  <span class="kw">list</span>(<span class="dt">frequencies=</span>freqs, <span class="dt">spectrum=</span>spec)</span>
<span id="cb2410-18"><a href="stat-tsa.html#cb2410-18"></a>}</span></code></pre></div>
</div>
</div>
<div id="stat-tsa-spectra" class="section level2">
<h2><span class="header-section-number">33.5</span> 谱密度估计</h2>
<p><code>spec.pgram(x)</code>计算周期图。
如：</p>
<div class="sourceCode" id="cb2411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2411-1"><a href="stat-tsa.html#cb2411-1"></a><span class="kw">spec.pgram</span>(xar4)</span></code></pre></div>
<p><img src="static/picture/tsa-spectra-pgram01-1.png" width="672" /></p>
<p><code>spec.pgram()</code>可以使用Daniel谱窗作加窗谱估计，
用<code>spans</code>给出两个奇数组成的向量作为参数，
表示窗宽。
如：</p>
<div class="sourceCode" id="cb2412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2412-1"><a href="stat-tsa.html#cb2412-1"></a><span class="kw">spec.pgram</span>(xar4, <span class="dt">spans=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">5</span>))</span></code></pre></div>
<p><img src="static/picture/tsa-spectra-pgram02-1.png" width="672" /></p>
<p>注意结果的横轴是频率而不是角频率，
为了转换到角频率需要乘以<span class="math inline">\(2\pi\)</span>。
输入的模拟AR(4)模型的两个谱峰频率为：</p>
<div class="sourceCode" id="cb2413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2413-1"><a href="stat-tsa.html#cb2413-1"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.9</span>, <span class="fl">-1.4</span>, <span class="fl">-0.7</span>, <span class="fl">-0.6</span>)</span>
<span id="cb2413-2"><a href="stat-tsa.html#cb2413-2"></a><span class="kw">Arg</span>(<span class="kw">polyroot</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="op">-</span>a)))<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>pi)</span></code></pre></div>
<pre><code>## [1]  0.2370723  0.3511244 -0.3511244 -0.2370723</code></pre>
<p>用<code>spec.ar(x)</code>可以做极大熵谱估计（用AR模型做谱估计）。
如：</p>
<div class="sourceCode" id="cb2415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2415-1"><a href="stat-tsa.html#cb2415-1"></a><span class="kw">spec.ar</span>(xar4)</span></code></pre></div>
<p><img src="static/picture/tsa-spectra-pgram04-1.png" width="672" /></p>
<p>因为数据是模拟的AR(4)，
估计的模型也是AR(4)，
所以效果很好。</p>
</div>
<div id="stat-tsa-garch" class="section level2">
<h2><span class="header-section-number">33.6</span> GARCH类模型</h2>
<p>待完成。</p>
</div>
<div id="stat-tsa-mtsa" class="section level2">
<h2><span class="header-section-number">33.7</span> 多元时间序列基础统计</h2>
<p>待完成。</p>
</div>
<div id="stat-tsa-var" class="section level2">
<h2><span class="header-section-number">33.8</span> VAR模型</h2>
<p>待完成。</p>
</div>
<div id="stat-tsa-coint" class="section level2">
<h2><span class="header-section-number">33.9</span> 协整分析</h2>
<p>待完成。</p>
</div>
<div id="stat-tsa-causal" class="section level2">
<h2><span class="header-section-number">33.10</span> 因果性检验</h2>
<p>待完成。</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="stat-reg.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="stat-learning.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="static/js/app.min.js"></script>
<script src="static/js/lunr.js"></script>
<script src="static/js/clipboard.min.js"></script>
<script src="static/js/plugin-search.js"></script>
<script src="static/js/plugin-sharing.js"></script>
<script src="static/js/plugin-fontsettings.js"></script>
<script src="static/js/plugin-bookdown.js"></script>
<script src="static/js/jquery.highlight.js"></script>
<script src="static/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Rbook.pdf"],
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
